cscope 15 $HOME/mysql/Lab/Project3_buffer/Project_Buffer -q 0000000248 0000038882
	@include/bpt.h

1 #iâdeà
__BPT_H__


2 
	#__BPT_H__


	)

4 
İ’_bË
(cÚ¡ * 
f’ame
);

5 * 
fšd
(
bË_id
, 
ušt64_t
 
key
);

6 
š£¹
(
bË_id
, 
ušt64_t
 
key
, cÚ¡ * 
v®ue
);

7 
d–‘e
(
bË_id
, 
ušt64_t
 
key
);

9 
´št_Œ“
(
bË_id
);

13 
š™_db
(
num_buf
);

15 
şo£_bË
(
bË_id
);

17 
shutdown_db
();

	@include/file.h

1 
	~<¡ddef.h
>

2 
	~<š‰y³s.h
>

4 
	#BPTREE_INTERNAL_ORDER
 249

5 
	#BPTREE_LEAF_ORDER
 32

6 

	)

7 
	#PAGE_SIZE
 4096

	)

9 
	#SIZE_KEY
 8

	)

10 
	#SIZE_VALUE
 120

	)

11 
	#SIZE_RECORD
 (
SIZE_KEY
 + 
SIZE_VALUE
)

	)

13 
	#BPTREE_MAX_NODE
 (1024 * 1024)

14 

	)

25 
	s_RecÜd
 {

26 
ušt64_t
 
	mkey
;

27 
	mv®ue
[
SIZE_VALUE
];

28 } 
	tRecÜd
;

30 
	s_IÁ”ÇlRecÜd
 {

31 
ušt64_t
 
	mkey
;

32 
off_t
 
	moff£t
;

33 } 
	tIÁ”ÇlRecÜd
;

35 
	s_Page
 {

36 
	mby‹s
[
PAGE_SIZE
];

39 
off_t
 
	mfe_off£t
;

40 } 
	tPage
;

42 
	s_F»ePage
 {

43 
off_t
 
	mÃxt
;

44 
	m»£rved
[
PAGE_SIZE
 - 8];

47 
off_t
 
	mfe_off£t
;

48 } 
	tF»ePage
;

50 
	s_H—d”Page
 {

51 
off_t
 
	mä“li¡
;

52 
off_t
 
	mroÙ_off£t
;

53 
ušt64_t
 
	mnum_·ges
;

54 
	m»£rved
[
PAGE_SIZE
 - 24];

57 
off_t
 
	mfe_off£t
;

58 } 
	tH—d”Page
;

60 
	#INTERNAL_KEY
(
n
, 
i
è(Ò)->
œecÜds
[(i)+1].
key
)

	)

61 
	#INTERNAL_OFFSET
(
n
, 
i
è(Ò)->
œecÜds
[(i)].
off£t
)

	)

62 
	s_IÁ”ÇlPage
 {

65 
off_t
 
	m·»Á
;

66 
	mis_Ëaf
;

67 
	mnum_keys
;

68 
	m»£rved
[112 - 16];

69 
IÁ”ÇlRecÜd
 
	mœecÜds
[
BPTREE_INTERNAL_ORDER
];

71 
	m¥aû
[
PAGE_SIZE
];

74 
off_t
 
	mfe_off£t
;

75 } 
	tIÁ”ÇlPage
;

77 
	#LEAF_KEY
(
n
, 
i
è(Ò)->
»cÜds
[(i)].
key
)

	)

78 
	#LEAF_VALUE
(
n
, 
i
è(Ò)->
»cÜds
[(i)].
v®ue
)

	)

79 
	s_L—fPage
 {

82 
off_t
 
	m·»Á
;

83 
	mis_Ëaf
;

84 
	mnum_keys
;

85 
	m»£rved
[120 - 16];

86 
off_t
 
	msiblšg
;

87 
RecÜd
 
	m»cÜds
[
BPTREE_LEAF_ORDER
-1];

89 
	m¥aû
[
PAGE_SIZE
];

93 
off_t
 
	mfe_off£t
;

94 } 
	tL—fPage
;

96 
	s_NodePage
 {

99 
off_t
 
	m·»Á
;

100 
	mis_Ëaf
;

101 
	mnum_keys
;

103 
	m¥aû
[
PAGE_SIZE
];

107 
off_t
 
	mfe_off£t
;

108 } 
	tNodePage
;

111 
İ’_bË
(cÚ¡ * 
f’ame
);

115 
şo£_db
(
bË_id
);

118 
off_t
 
g‘_ä“_·ge
(
bË_id
);

121 
put_ä“_·ge
(
bË_id
, 
off_t
 
·ge_off£t
);

124 
ex·nd_fe
(
bË_id
, 
size_t
 
út_·ge_to_ex·nd
);

127 
lßd_·ge
(
bË_id
, 
off_t
 
off£t
, 
Page
* 
·ge
);

130 
æush_·ge
(
bË_id
, 
Page
* 
·ge
);

132 
H—d”Page
 
dbh—d”
[10];

136 
	s_Bufãr
{

137 
Page
 *
	mäame
;

138 
	mbË_id
;

139 
off_t
 
	m·ge_off£t
;

140 
	mis_dœty
;

141 
	mpš_couÁ
;

143 
	m»fb™
;

144 } 
	tBufãr
;

147 
lßd_·ge_äom_bufãr
(
bË_id
, 
off_t
 
off£t
, 
Page
* 
·ge
);

149 
Page
* 
is_š_bufãr
(
bË_id
, 
off_t
 
off£t
, Pag*
·ge
, 
ty³
);

151 
»¶aû_·ge
(
bË_id
);

154 
dœty_Ú
(
bË_id
, 
Page
* 
·ge
);

	@src/bpt.c

4 
	#V”siÚ
 "1.14"

	)

57 
	~<¡dio.h
>

58 
	~<¡dlib.h
>

59 
	~<¡dboŞ.h
>

60 
	~<¡dšt.h
>

61 
	~<¡ršg.h
>

62 
	~<š‰y³s.h
>

63 
	~<as£¹.h
>

64 
	~<fú.h
>

65 
	~<uni¡d.h
>

66 
	~"b±.h
"

67 
	~"fe.h
"

68 #ifdeà
WINDOWS


69 
	#boŞ
 

	)

70 
	#çl£
 0

	)

71 
	#Œue
 1

	)

78 
	#MIN_ORDER
 3

	)

79 
	#MAX_ORDER
 256

	)

82 
	#LICENSE_FILE
 "LICENSE.txt"

	)

83 
	#LICENSE_WARRANTEE
 0

	)

84 
	#LICENSE_WARRANTEE_START
 592

	)

85 
	#LICENSE_WARRANTEE_END
 624

	)

86 
	#LICENSE_CONDITIONS
 1

	)

87 
	#LICENSE_CONDITIONS_START
 70

	)

88 
	#LICENSE_CONDITIONS_END
 625

	)

91 
H—d”Page
 
dbh—d”
[10];

92 
dbfe
[10];

93 
	gbË_ids
[10] = {0,};

105 
	gÜd”_š‹º®
 = 
BPTREE_INTERNAL_ORDER
;

106 
	gÜd”_Ëaf
 = 
BPTREE_LEAF_ORDER
;

113 
boŞ
 
	gv”bo£_ouut
 = 
çl£
;

116 
Bufãr
 *
	gbuf_mgr
;

117 
	gbuf_size
 = -1;

118 
	gşock_hªd
 = 0;

119 
	grg‘_buf
 = 0;

125 
liûn£_nÙiû
( );

126 
´št_liûn£
Ğ
liûnû_·¹
 );

127 
u§ge_1
( );

128 
u§ge_2
( );

129 
fšd_ªd_´št
(
bË_id
, 
ušt64_t
 
key
);

130 
boŞ
 
fšd_Ëaf
(
bË_id
, 
ušt64_t
 
key
, 
L—fPage
* 
out_Ëaf_node
);

133 
¡¬t_Ãw_Œ“
(
bË_id
, 
ušt64_t
 
key
, cÚ¡ * 
v®ue
);

134 
š£¹_što_Ëaf
(
lbe_id
, 
L—fPage
* 
Ëaf_node
, 
ušt64_t
 
key
, cÚ¡ * 
v®ue
);

135 
š£¹_što_Ëaf_aá”_¥l™tšg
(
bË_id
, 
L—fPage
* 
Ëaf_node
, 
ušt64_t
 
key
, cÚ¡ * 
v®ue
);

136 
š£¹_što_·»Á
(
bË_id
, 
NodePage
* 
Ëá
, 
ušt64_t
 
key
, NodePage* 
right
);

137 
š£¹_što_Ãw_roÙ
(
bË_id
, 
NodePage
* 
Ëá
, 
ušt64_t
 
key
, NodePage* 
right
);

138 
g‘_Ëá_šdex
(
IÁ”ÇlPage
* 
·»Á
, 
off_t
 
Ëá_off£t
);

139 
š£¹_što_node
(
IÁ”ÇlPage
 * 
·»Á
, 
Ëá_šdex
, 
ušt64_t
 
key
, 
off_t
 
right_off£t
);

140 
š£¹_što_node_aá”_¥l™tšg
(
bË_id
, 
IÁ”ÇlPage
* 
·»Á
, 
Ëá_šdex
, 
ušt64_t
 
key
, 
off_t
 
right_off£t
);

143 
g‘_ÃighbÜ_šdex
(
bË_id
, 
NodePage
* 
node_·ge
);

144 
adju¡_roÙ
(
bË_id
);

145 
cßËsû_nodes
(
bË_id
, 
NodePage
* 
node_·ge
, NodePage* 
ÃighbÜ_·ge
,

146 
ÃighbÜ_šdex
, 
k_´ime
);

147 
»di¡ribu‹_nodes
(
bË_id
, 
NodePage
* 
node_·ge
, NodePage* 
ÃighbÜ_·ge
,

148 
ÃighbÜ_šdex
,

149 
k_´ime_šdex
, 
k_´ime
);

150 
d–‘e_’Œy
(
bË_id
, 
NodePage
* 
node_·ge
, 
ušt64_t
 
key
);

159 
	$liûn£_nÙiû
( ) {

160 
	`´štf
("bpt version %s -- Copyright (C) 2010 Amittai Aviram "

161 "h‰p://www.am™i.com\n", 
V”siÚ
);

162 
	`´štf
("This…rogram comes with ABSOLUTELY NO WARRANTY; for details "

166 
	}
}

171 
	$´št_liûn£
Ğ
liûn£_·¹
 ) {

172 
¡¬t
, 
’d
, 
lše
;

173 
FILE
 * 
å
;

174 
bufãr
[0x100];

176 
liûn£_·¹
) {

177 
LICENSE_WARRANTEE
:

178 
¡¬t
 = 
LICENSE_WARRANTEE_START
;

179 
’d
 = 
LICENSE_WARRANTEE_END
;

181 
LICENSE_CONDITIONS
:

182 
¡¬t
 = 
LICENSE_CONDITIONS_START
;

183 
’d
 = 
LICENSE_CONDITIONS_END
;

189 
å
 = 
	`fİ’
(
LICENSE_FILE
, "r");

190 ià(
å
 =ğ
NULL
) {

191 
	`³¼Ü
("print_license: fopen");

192 
	`ex™
(
EXIT_FAILURE
);

194 
lše
 = 0;†š< 
¡¬t
;†ine++)

195 
	`fg‘s
(
bufãr
, (bufãr), 
å
);

196  ; 
lše
 < 
’d
;†ine++) {

197 
	`fg‘s
(
bufãr
, (bufãr), 
å
);

198 
	`´štf
("%s", 
bufãr
);

200 
	`fşo£
(
å
);

201 
	}
}

205 
	$u§ge_1
( ) {

206 
	`´štf
("B+ T»oàOrd” %d(IÁ”Çl).\n", 
Üd”_š‹º®
);

207 
	`´štf
("Following Silberschatz, Korth, Sidarshan, Database Concepts, "

212 
	`´štf
("(%d <ğÜd” <ğ%d).\n", 
MIN_ORDER
, 
MAX_ORDER
);

213 
	`´štf
("To start with input from‡ file of‚ewline-delimited integers, \n"

216 
	}
}

220 
	$u§ge_2
( ) {

221 
	`´štf
("Enter‡ny ofhe following commands‡fterhe…rompt > :\n"

237 
	}
}

240 
	$İ’_bË
(cÚ¡ * 
f’ame
) {

241 
i
;

244 
i
 = 0; i < 10; i++){

245 if(
bË_ids
[
i
] == 0){

246 
bË_ids
[
i
] = 1;

252 if(
i
 == 10){

256 
dbfe
[
i
] = 
	`İ’
(
f’ame
, 
O_RDWR
);

257 ià(
dbfe
[
i
] < 0) {

259 
dbfe
[
i
] = 
	`İ’
(
f’ame
, 
O_CREAT
|
O_RDWR
, 
S_IRUSR
|
S_IWUSR
);

260 ià(
dbfe
[
i
] < 0) {

261 
	`as£¹
("failedo create‚ew db file");

265 
	`mem£t
((
dbh—d”
+
i
), 0, 
PAGE_SIZE
);

266 
dbh—d”
[
i
].
ä“li¡
 = 0;

267 
dbh—d”
[
i
].
roÙ_off£t
 = 0;

268 
dbh—d”
[
i
].
num_·ges
 = 1;

269 
dbh—d”
[
i
].
fe_off£t
 = 0;

270 
	`dœty_Ú
(
i
+1, (
Page
*)(
dbh—d”
 + i));

273 
	`lßd_·ge_äom_bufãr
(
i
+1, 0, (
Page
*)(
dbh—d”
+i));

276 if(
dbh—d”
[
i
].
num_·ges
 == 0){

277 
dbh—d”
[
i
].
num_·ges
 = 1;

278 
	`dœty_Ú
(
i
+1, (
Page
*)(
dbh—d”
 + i));

280 
dbh—d”
[
i
].
fe_off£t
 = 0;

283  
i
+1;

284 
	}
}

287 
	$şo£_db
(
bË_id
) {

288 
	`şo£
(
dbfe
[
bË_id
 - 1]);

289 
	}
}

304 
off_t
 
	gqueue
[
BPTREE_MAX_NODE
];

305 
	$´št_Œ“
(
bË_id
) {

307 
i
;

308 
äÚt
 = 0;

309 
»¬
 = 0;

311 ià(
dbh—d”
[
bË_id
 - 1].
roÙ_off£t
 == 0) {

312 
	`´štf
("Emptyree.\n");

316 
queue
[
»¬
] = 
dbh—d”
[
bË_id
 - 1].
roÙ_off£t
;

317 
»¬
++;

318 
queue
[
»¬
] = 0;

319 
»¬
++;

320 
äÚt
 < 
»¬
) {

321 
off_t
 
·ge_off£t
 = 
queue
[
äÚt
];

322 
äÚt
++;

324 ià(
·ge_off£t
 == 0) {

325 
	`´štf
("\n");

327 ià(
äÚt
 =ğ
»¬
) ;

330 
queue
[
»¬
] = 0;

331 
»¬
++;

335 
NodePage
 
node_·ge
;

336 
	`lßd_·ge_äom_bufãr
(
bË_id
, 
·ge_off£t
, (
Page
*)&
node_·ge
);

337 ià(
node_·ge
.
is_Ëaf
 == 1) {

339 
L—fPage
* 
Ëaf_node
 = (L—fPage*)&
node_·ge
;

340 
i
 = 0; i < 
Ëaf_node
->
num_keys
; i++) {

341 
	`´štf
("%" 
PRIu64
 " ", 
	`LEAF_KEY
(
Ëaf_node
, 
i
));

343 
	`´štf
("| ");

346 
IÁ”ÇlPage
* 
š‹º®_node
 = (IÁ”ÇlPage*)&
node_·ge
;

347 
i
 = 0; i < 
š‹º®_node
->
num_keys
; i++) {

348 
	`´štf
("%" 
PRIu64
 " ", 
	`INTERNAL_KEY
(
š‹º®_node
, 
i
));

349 
queue
[
»¬
] = 
	`INTERNAL_OFFSET
(
š‹º®_node
, 
i
);

350 
»¬
++;

352 
queue
[
»¬
] = 
	`INTERNAL_OFFSET
(
š‹º®_node
, 
i
);

353 
»¬
++;

354 
	`´štf
("| ");

357 
	}
}

362 
	$fšd_ªd_´št
(
bË_id
, 
ušt64_t
 
key
) {

363 * 
v®ue_found
 = 
NULL
;

364 
v®ue_found
 = 
	`fšd
(
bË_id
, 
key
);

365 ià(
v®ue_found
 =ğ
NULL
) {

366 
	`´štf
("RecÜd‚Ù found und” key %" 
PRIu64
 ".\n", 
key
);

369 
	`´štf
("key %" 
PRIu64
 ", v®u[%s].\n", 
key
, 
v®ue_found
);

370 
	`ä“
(
v®ue_found
);

372 
	}
}

379 
boŞ
 
	$fšd_Ëaf
(
bË_id
, 
ušt64_t
 
key
, 
L—fPage
* 
out_Ëaf_node
) {

380 
i
 = 0;

381 
off_t
 
roÙ_off£t
 = 
dbh—d”
[
bË_id
 - 1].root_offset;

383 ià(
roÙ_off£t
 == 0) {

384  
çl£
;

387 
NodePage
 
·ge
;

388 
	`lßd_·ge_äom_bufãr
(
bË_id
, 
roÙ_off£t
, (
Page
*)&
·ge
);

390 !
·ge
.
is_Ëaf
) {

391 
IÁ”ÇlPage
* 
š‹º®_node
 = (IÁ”ÇlPage*)&
·ge
;

393 
i
 = 0;

394 
i
 < 
š‹º®_node
->
num_keys
) {

395 ià(
key
 >ğ
	`INTERNAL_KEY
(
š‹º®_node
, 
i
)) i++;

399 
	`lßd_·ge_äom_bufãr
(
bË_id
, 
	`INTERNAL_OFFSET
(
š‹º®_node
, 
i
), (
Page
*)&
·ge
);

402 
	`memıy
(
out_Ëaf_node
, &
·ge
, (
L—fPage
));

404  
Œue
;

405 
	}
}

411 * 
	$fšd
(
bË_id
, 
ušt64_t
 
key
) {

412 
i
 = 0;

413 * 
out_v®ue
;

415 
L—fPage
 
Ëaf_node
;

416 ià(!
	`fšd_Ëaf
(
bË_id
, 
key
, &
Ëaf_node
)) {

417  
NULL
;

420 
i
 = 0; i < 
Ëaf_node
.
num_keys
; i++) {

421 ià(
	`LEAF_KEY
(&
Ëaf_node
, 
i
è=ğ
key
) {

422 
out_v®ue
 = (*)
	`m®loc
(
SIZE_VALUE
 * ());

423 
	`memıy
(
out_v®ue
, 
	`LEAF_VALUE
(&
Ëaf_node
, 
i
), 
SIZE_VALUE
);

424  
out_v®ue
;

428  
NULL
;

429 
	}
}

434 
	$cut
Ğ
Ëngth
 ) {

435 ià(
Ëngth
 % 2 == 0)

436  
Ëngth
/2;

438  
Ëngth
/2 + 1;

439 
	}
}

446 
	$g‘_Ëá_šdex
(
IÁ”ÇlPage
* 
·»Á
, 
off_t
 
Ëá_off£t
) {

448 
Ëá_šdex
 = 0;

449 
Ëá_šdex
 <ğ
·»Á
->
num_keys
 &&

450 
	`INTERNAL_OFFSET
(
·»Á
, 
Ëá_šdex
è!ğ
Ëá_off£t
)

451 
Ëá_šdex
++;

452  
Ëá_šdex
;

453 
	}
}

459 
	$š£¹_što_Ëaf
(
bË_id
, 
L—fPage
* 
Ëaf_node
, 
ušt64_t
 
key
, cÚ¡ * 
v®ue
) {

460 
š£¹iÚ_pošt
;

461 
i
;

463 
š£¹iÚ_pošt
 = 0;

464 
š£¹iÚ_pošt
 < 
Ëaf_node
->
num_keys
 &&

465 
	`LEAF_KEY
(
Ëaf_node
, 
š£¹iÚ_pošt
è< 
key
)

466 
š£¹iÚ_pošt
++;

469 
i
 = 
Ëaf_node
->
num_keys
 - 1; i >ğ
š£¹iÚ_pošt
; i--) {

470 
	`LEAF_KEY
(
Ëaf_node
, 
i
+1) = LEAF_KEY(leaf_node, i);

471 
	`memıy
(
	`LEAF_VALUE
(
Ëaf_node
, 
i
+1), LEAF_VALUEÖ—f_node, i), 
SIZE_VALUE
);

474 
	`LEAF_KEY
(
Ëaf_node
, 
š£¹iÚ_pošt
èğ
key
;

475 
	`memıy
(
	`LEAF_VALUE
(
Ëaf_node
, 
š£¹iÚ_pošt
), 
v®ue
, 
SIZE_VALUE
);

476 
Ëaf_node
->
num_keys
++;

479 
	`dœty_Ú
(
bË_id
, (
Page
*)
Ëaf_node
);

480 
	}
}

487 
	$š£¹_što_Ëaf_aá”_¥l™tšg
(
bË_id
, 
L—fPage
* 
Ëaf
, 
ušt64_t
 
key
, cÚ¡ * 
v®ue
) {

489 
š£¹iÚ_šdex
, 
¥l™
, 
i
, 
j
;

490 
ušt64_t
 
Ãw_key
;

493 
L—fPage
 
Ãw_Ëaf
;

494 
Ãw_Ëaf
.
is_Ëaf
 = 
Œue
;

495 
Ãw_Ëaf
.
num_keys
 = 0;

497 
š£¹iÚ_šdex
 = 0;

498 
š£¹iÚ_šdex
 < 
Üd”_Ëaf
 - 1 && 
	`LEAF_KEY
(
Ëaf
, in£¹iÚ_šdexè< 
key
)

499 
š£¹iÚ_šdex
++;

501 
¥l™
 = 
	`cut
(
Üd”_Ëaf
 - 1);

503 ià(
š£¹iÚ_šdex
 < 
¥l™
) {

505 
i
 = 
¥l™
 - 1, 
j
 = 0; i < 
Üd”_Ëaf
 - 1; i++, j++) {

506 
	`LEAF_KEY
(&
Ãw_Ëaf
, 
j
èğLEAF_KEY(
Ëaf
, 
i
);

507 
	`memıy
(
	`LEAF_VALUE
(&
Ãw_Ëaf
, 
j
), LEAF_VALUE(
Ëaf
, 
i
), 
SIZE_VALUE
);

509 
Ãw_Ëaf
.
num_keys
++;

510 
Ëaf
->
num_keys
--;

513 
i
 = 
¥l™
 - 2; i >ğ
š£¹iÚ_šdex
; i--) {

514 
	`LEAF_KEY
(
Ëaf
, 
i
+1) = LEAF_KEY(leaf, i);

515 
	`memıy
(
	`LEAF_VALUE
(
Ëaf
, 
i
+1), LEAF_VALUEÖ—f, i), 
SIZE_VALUE
);

517 
	`LEAF_KEY
(
Ëaf
, 
š£¹iÚ_šdex
èğ
key
;

518 
	`memıy
(
	`LEAF_VALUE
(
Ëaf
, 
š£¹iÚ_šdex
), 
v®ue
, 
SIZE_VALUE
);

519 
Ëaf
->
num_keys
++;

522 
i
 = 
¥l™
, 
j
 = 0; i < 
Üd”_Ëaf
 - 1; i++, j++) {

523 ià(
i
 =ğ
š£¹iÚ_šdex
) {

525 
j
++;

527 
	`LEAF_KEY
(&
Ãw_Ëaf
, 
j
èğLEAF_KEY(
Ëaf
, 
i
);

528 
	`memıy
(
	`LEAF_VALUE
(&
Ãw_Ëaf
, 
j
), LEAF_VALUE(
Ëaf
, 
i
), 
SIZE_VALUE
);

530 
Ãw_Ëaf
.
num_keys
++;

531 
Ëaf
->
num_keys
--;

533 
	`LEAF_KEY
(&
Ãw_Ëaf
, 
š£¹iÚ_šdex
 - 
¥l™
èğ
key
;

534 
	`memıy
(
	`LEAF_VALUE
(&
Ãw_Ëaf
, 
š£¹iÚ_šdex
 - 
¥l™
), 
v®ue
, 
SIZE_VALUE
);

535 
Ãw_Ëaf
.
num_keys
++;

539 
Ãw_Ëaf
.
fe_off£t
 = 
	`g‘_ä“_·ge
(
bË_id
);

542 
Ãw_Ëaf
.
siblšg
 = 
Ëaf
->sibling;

543 
Ëaf
->
siblšg
 = 
Ãw_Ëaf
.
fe_off£t
;

546 
i
 = 
Ëaf
->
num_keys
; i < 
Üd”_Ëaf
 - 1; i++) {

547 
	`LEAF_KEY
(
Ëaf
, 
i
) = 0;

548 
	`mem£t
(
	`LEAF_VALUE
(
Ëaf
, 
i
), 0, 
SIZE_VALUE
);

550 
i
 = 
Ãw_Ëaf
.
num_keys
; i < 
Üd”_Ëaf
 - 1; i++) {

551 
	`LEAF_KEY
(&
Ãw_Ëaf
, 
i
) = 0;

552 
	`mem£t
(
	`LEAF_VALUE
(&
Ãw_Ëaf
, 
i
), 0, 
SIZE_VALUE
);

555 
Ãw_Ëaf
.
·»Á
 = 
Ëaf
->parent;

557 
	`dœty_Ú
(
bË_id
, (
Page
*)
Ëaf
);

558 
	`dœty_Ú
(
bË_id
, (
Page
*)&
Ãw_Ëaf
);

560 
Ãw_key
 = 
	`LEAF_KEY
(&
Ãw_Ëaf
, 0);

563 
	`š£¹_što_·»Á
(
bË_id
, (
NodePage
*)
Ëaf
, 
Ãw_key
, (NodePage*)&
Ãw_Ëaf
);

564 
	}
}

570 
	$š£¹_što_node
(
IÁ”ÇlPage
* 
n
, 
Ëá_šdex
, 
ušt64_t
 
key
, 
off_t
 
right_off£t
) {

571 
i
;

573 
i
 = 
n
->
num_keys
; i > 
Ëá_šdex
; i--) {

574 
	`INTERNAL_OFFSET
(
n
, 
i
 + 1) = INTERNAL_OFFSET(n, i);

575 
	`INTERNAL_KEY
(
n
, 
i
) = INTERNAL_KEY(n, i - 1);

577 
	`INTERNAL_OFFSET
(
n
, 
Ëá_šdex
 + 1èğ
right_off£t
;

578 
	`INTERNAL_KEY
(
n
, 
Ëá_šdex
èğ
key
;

579 
n
->
num_keys
++;

580 
	}
}

586 
	$š£¹_što_node_aá”_¥l™tšg
(
bË_id
, 
IÁ”ÇlPage
* 
Şd_node
, 
Ëá_šdex
, 
ušt64_t
 
key
, 
off_t
 
right_off£t
) {

587 
i
, 
j
, 
¥l™
, 
k_´ime
;

588 
ušt64_t
* 
‹mp_keys
;

589 
off_t
* 
‹mp_poš‹rs
;

600 
‹mp_poš‹rs
 = 
	`m®loc
Ğ(
Üd”_š‹º®
 + 1è* (
off_t
) );

601 ià(
‹mp_poš‹rs
 =ğ
NULL
) {

602 
	`³¼Ü
("Temporary…ointers‡rray for splitting‚odes.");

603 
	`ex™
(
EXIT_FAILURE
);

605 
‹mp_keys
 = 
	`m®loc
Ğ
Üd”_š‹º®
 * (
ušt64_t
) );

606 ià(
‹mp_keys
 =ğ
NULL
) {

607 
	`³¼Ü
("Temporary keys‡rray for splitting‚odes.");

608 
	`ex™
(
EXIT_FAILURE
);

611 
i
 = 0, 
j
 = 0; i < 
Şd_node
->
num_keys
 + 1; i++, j++) {

612 ià(
j
 =ğ
Ëá_šdex
 + 1) j++;

613 
‹mp_poš‹rs
[
j
] = 
	`INTERNAL_OFFSET
(
Şd_node
, 
i
);

616 
i
 = 0, 
j
 = 0; i < 
Şd_node
->
num_keys
; i++, j++) {

617 ià(
j
 =ğ
Ëá_šdex
) j++;

618 
‹mp_keys
[
j
] = 
	`INTERNAL_KEY
(
Şd_node
, 
i
);

621 
‹mp_poš‹rs
[
Ëá_šdex
 + 1] = 
right_off£t
;

622 
‹mp_keys
[
Ëá_šdex
] = 
key
;

628 
¥l™
 = 
	`cut
(
Üd”_š‹º®
);

630 
IÁ”ÇlPage
 
Ãw_node
;

631 
Ãw_node
.
num_keys
 = 0;

632 
Ãw_node
.
is_Ëaf
 = 0;

633 
Ãw_node
.
fe_off£t
 = 
	`g‘_ä“_·ge
(
bË_id
);

635 
Şd_node
->
num_keys
 = 0;

636 
i
 = 0; i < 
¥l™
 - 1; i++) {

637 
	`INTERNAL_OFFSET
(
Şd_node
, 
i
èğ
‹mp_poš‹rs
[i];

638 
	`INTERNAL_KEY
(
Şd_node
, 
i
èğ
‹mp_keys
[i];

639 
Şd_node
->
num_keys
++;

641 
	`INTERNAL_OFFSET
(
Şd_node
, 
i
èğ
‹mp_poš‹rs
[i];

642 
k_´ime
 = 
‹mp_keys
[
¥l™
 - 1];

643 ++
i
, 
j
 = 0; i < 
Üd”_š‹º®
; i++, j++) {

644 
	`INTERNAL_OFFSET
(&
Ãw_node
, 
j
èğ
‹mp_poš‹rs
[
i
];

645 
	`INTERNAL_KEY
(&
Ãw_node
, 
j
èğ
‹mp_keys
[
i
];

646 
Ãw_node
.
num_keys
++;

648 
	`INTERNAL_OFFSET
(&
Ãw_node
, 
j
èğ
‹mp_poš‹rs
[
i
];

649 
	`ä“
(
‹mp_poš‹rs
);

650 
	`ä“
(
‹mp_keys
);

651 
Ãw_node
.
·»Á
 = 
Şd_node
->parent;

652 
i
 = 0; i <ğ
Ãw_node
.
num_keys
; i++) {

653 
NodePage
 
chd_·ge
;

654 
	`lßd_·ge_äom_bufãr
(
bË_id
, 
	`INTERNAL_OFFSET
(&
Ãw_node
, 
i
), (
Page
*)&
chd_·ge
);

655 
chd_·ge
.
·»Á
 = 
Ãw_node
.
fe_off£t
;

656 
	`dœty_Ú
(
bË_id
, (
Page
*)&
chd_·ge
);

660 
i
 = 
Şd_node
->
num_keys
; i < 
Üd”_š‹º®
 - 1; i++) {

661 
	`INTERNAL_OFFSET
(
Şd_node
, 
i
+1) = 0;

662 
	`INTERNAL_KEY
(
Şd_node
, 
i
) = 0;

665 
i
 = 
Ãw_node
.
num_keys
; i < 
Üd”_š‹º®
 - 1; i++) {

666 
	`INTERNAL_OFFSET
(&
Ãw_node
, 
i
+1) = 0;

667 
	`INTERNAL_KEY
(&
Ãw_node
, 
i
) = 0;

671 
	`dœty_Ú
(
bË_id
, (
Page
*)&
Ãw_node
);

672 
	`dœty_Ú
(
bË_id
, (
Page
*)
Şd_node
);

678 
	`š£¹_što_·»Á
(
bË_id
, (
NodePage
*)
Şd_node
, 
k_´ime
, (NodePage*)&
Ãw_node
);

679 
	}
}

684 
	$š£¹_što_·»Á
(
bË_id
, 
NodePage
* 
Ëá
, 
ušt64_t
 
key
, NodePage* 
right
) {

686 
IÁ”ÇlPage
 
·»Á_node
;

689 ià(
Ëá
->
·»Á
 == 0) {

690 
	`š£¹_što_Ãw_roÙ
(
bË_id
, 
Ëá
, 
key
, 
right
);

694 
	`lßd_·ge_äom_bufãr
(
bË_id
, 
Ëá
->
·»Á
, (
Page
*)&
·»Á_node
);

704 
Ëá_šdex
 = 
	`g‘_Ëá_šdex
(&
·»Á_node
, 
Ëá
->
fe_off£t
);

709 ià(
·»Á_node
.
num_keys
 < 
Üd”_š‹º®
 - 1) {

710 
	`š£¹_što_node
(&
·»Á_node
, 
Ëá_šdex
, 
key
, 
right
->
fe_off£t
);

711 
	`dœty_Ú
(
bË_id
, (
Page
*)&
·»Á_node
);

719  
	`š£¹_što_node_aá”_¥l™tšg
(
bË_id
, &
·»Á_node
, 
Ëá_šdex
, 
key
, 
right
->
fe_off£t
);

720 
	}
}

726 
	$š£¹_što_Ãw_roÙ
(
bË_id
, 
NodePage
* 
Ëá
, 
ušt64_t
 
key
, NodePage* 
right
) {

728 
IÁ”ÇlPage
 
roÙ_node
;

729 
	`mem£t
(&
roÙ_node
, 0, (
IÁ”ÇlPage
));

730 
roÙ_node
.
fe_off£t
 = 
	`g‘_ä“_·ge
(
bË_id
);

731 
	`INTERNAL_KEY
(&
roÙ_node
, 0èğ
key
;

732 
	`INTERNAL_OFFSET
(&
roÙ_node
, 0èğ
Ëá
->
fe_off£t
;

733 
	`INTERNAL_OFFSET
(&
roÙ_node
, 1èğ
right
->
fe_off£t
;

734 
roÙ_node
.
num_keys
++;

735 
roÙ_node
.
·»Á
 = 0;

736 
roÙ_node
.
is_Ëaf
 = 0;

737 
Ëá
->
·»Á
 = 
roÙ_node
.
fe_off£t
;

738 
right
->
·»Á
 = 
roÙ_node
.
fe_off£t
;

740 
	`dœty_Ú
(
bË_id
, (
Page
*)&
roÙ_node
);

741 
	`dœty_Ú
(
bË_id
, (
Page
*)
Ëá
);

742 
	`dœty_Ú
(
bË_id
, (
Page
*)
right
);

744 
dbh—d”
[
bË_id
 - 1].
roÙ_off£t
 = 
roÙ_node
.
fe_off£t
;

745 
	`dœty_Ú
(
bË_id
, (
Page
*)(
dbh—d”
 +able_id - 1));

746 
	}
}

750 
	$¡¬t_Ãw_Œ“
(
bË_id
, 
ušt64_t
 
key
, cÚ¡ * 
v®ue
) {

751 
L—fPage
 
roÙ_node
;

753 
off_t
 
roÙ_off£t
 = 
	`g‘_ä“_·ge
(
bË_id
);

754 
roÙ_node
.
fe_off£t
 = 
roÙ_off£t
;

756 
roÙ_node
.
·»Á
 = 0;

757 
roÙ_node
.
is_Ëaf
 = 1;

758 
roÙ_node
.
num_keys
 = 1;

759 
	`LEAF_KEY
(&
roÙ_node
, 0èğ
key
;

760 
roÙ_node
.
siblšg
 = 0;

761 
	`memıy
(
	`LEAF_VALUE
(&
roÙ_node
, 0), 
v®ue
, 
SIZE_VALUE
);

763 
	`dœty_Ú
(
bË_id
, (
Page
*)&
roÙ_node
);

765 
dbh—d”
[
bË_id
 - 1].
roÙ_off£t
 =„oot_offset;

766 
	`dœty_Ú
(
bË_id
, (
Page
*)(
dbh—d”
 +able_id - 1));

767 
	}
}

775 
	$š£¹
(
bË_id
, 
ušt64_t
 
key
, cÚ¡ * 
v®ue
) {

779 * 
v®ue_found
 = 
NULL
;

781 ià((
v®ue_found
 = 
	`fšd
(
bË_id
, 
key
)) != 0) {

782 
	`ä“
(
v®ue_found
);

789 ià(
dbh—d”
[
bË_id
 - 1].
roÙ_off£t
 == 0) {

790 
	`¡¬t_Ãw_Œ“
(
bË_id
, 
key
, 
v®ue
);

798 
L—fPage
 
Ëaf_node
;

799 
	`fšd_Ëaf
(
bË_id
, 
key
, &
Ëaf_node
);

804 ià(
Ëaf_node
.
num_keys
 < 
Üd”_Ëaf
 - 1) {

805 
	`š£¹_što_Ëaf
(
bË_id
, &
Ëaf_node
, 
key
, 
v®ue
);

809 
	`š£¹_što_Ëaf_aá”_¥l™tšg
(
bË_id
, &
Ëaf_node
, 
key
, 
v®ue
);

812 
	}
}

822 
	$g‘_ÃighbÜ_šdex
(
bË_id
, 
NodePage
* 
node_·ge
) {

824 
i
;

832 
IÁ”ÇlPage
 
·»Á_node
;

833 
	`lßd_·ge_äom_bufãr
(
bË_id
, 
node_·ge
->
·»Á
, (
Page
*)&
·»Á_node
);

834 
i
 = 0; i <ğ
·»Á_node
.
num_keys
; i++)

835 ià(
	`INTERNAL_OFFSET
(&
·»Á_node
, 
i
è=ğ
node_·ge
->
fe_off£t
)

836  
i
 - 1;

839 
	`as£¹
("Search for‚onexistent…ointero‚ode in…arent.");

841 
	}
}

843 
	$»move_’Œy_äom_node
(
bË_id
, 
NodePage
* 
node_·ge
, 
ušt64_t
 
key
) {

845 
i
;

846 
key_idx
 = 0;

848 ià(
node_·ge
->
is_Ëaf
) {

849 
L—fPage
* 
Ëaf_node
 = (L—fPage*)
node_·ge
;

852 
i
 = 0; i < 
Ëaf_node
->
num_keys
; i++) {

853 ià(
	`LEAF_KEY
(
Ëaf_node
, 
i
è=ğ
key
) {

854 
key_idx
 = 
i
;

858 ià(
i
 =ğ
Ëaf_node
->
num_keys
) {

859 
	`as£¹
("remove_entry_from_node:‚o key inhis…age");

863 
i
 = 
key_idx
; i < 
Ëaf_node
->
num_keys
 - 1; i++) {

864 
	`LEAF_KEY
(
Ëaf_node
, 
i
) = LEAF_KEY(leaf_node, i+1);

865 
	`memıy
(
	`LEAF_VALUE
(
Ëaf_node
, 
i
), LEAF_VALUEÖ—f_node, i+1), 
SIZE_VALUE
);

868 
	`LEAF_KEY
(
Ëaf_node
,†—f_node->
num_keys
 - 1) = 0;

869 
	`mem£t
(
	`LEAF_VALUE
(
Ëaf_node
,†—f_node->
num_keys
 - 1), 0, 
SIZE_VALUE
);

871 
Ëaf_node
->
num_keys
--;

874 
IÁ”ÇlPage
* 
š‹º®_node
 = (IÁ”ÇlPage*)
node_·ge
;

877 
i
 = 0; i < 
š‹º®_node
->
num_keys
; i++) {

878 ià(
	`INTERNAL_KEY
(
š‹º®_node
, 
i
è=ğ
key
) {

879 
key_idx
 = 
i
;

883 ià(
i
 =ğ
š‹º®_node
->
num_keys
) {

884 
	`as£¹
("remove_entry_from_node:‚o key inhis…age");

888 
i
 = 
key_idx
; i < 
š‹º®_node
->
num_keys
 - 1; i++) {

889 
	`INTERNAL_KEY
(
š‹º®_node
, 
i
) = INTERNAL_KEY(internal_node, i+1);

890 
	`INTERNAL_OFFSET
(
š‹º®_node
, 
i
+1) = INTERNAL_OFFSET(internal_node, i+2);

893 
	`INTERNAL_KEY
(
š‹º®_node
, iÁ”Çl_node->
num_keys
 - 1) = 0;

894 
	`INTERNAL_OFFSET
(
š‹º®_node
, iÁ”Çl_node->
num_keys
) = 0;

896 
š‹º®_node
->
num_keys
--;

899 
	`dœty_Ú
(
bË_id
, (
Page
*)
node_·ge
);

900 
	}
}

902 
	$adju¡_roÙ
(
bË_id
) {

904 
NodePage
 
roÙ_·ge
;

905 
	`lßd_·ge_äom_bufãr
(
bË_id
, 
dbh—d”
[bË_id - 1].
roÙ_off£t
, (
Page
*)&
roÙ_·ge
);

912 ià(
roÙ_·ge
.
num_keys
 > 0)

922 ià(!
roÙ_·ge
.
is_Ëaf
) {

923 
IÁ”ÇlPage
* 
roÙ_node
 = (IÁ”ÇlPage*)&
roÙ_·ge
;

924 
dbh—d”
[
bË_id
 - 1].
roÙ_off£t
 = 
	`INTERNAL_OFFSET
(
roÙ_node
, 0);

926 
NodePage
 
node_·ge
;

927 
	`lßd_·ge_äom_bufãr
(
bË_id
, 
dbh—d”
[bË_id - 1].
roÙ_off£t
, (
Page
*)&
node_·ge
);

928 
node_·ge
.
·»Á
 = 0;

930 
	`dœty_Ú
(
bË_id
, (
Page
*)&
node_·ge
);

931 
	`dœty_Ú
(
bË_id
, (
Page
*)(
dbh—d”
 +able_id - 1));

938 
dbh—d”
[
bË_id
 - 1].
roÙ_off£t
 = 0;

939 
	`dœty_Ú
(
bË_id
, (
Page
*)(
dbh—d”
 +able_id - 1));

942 
	`put_ä“_·ge
(
bË_id
, 
roÙ_·ge
.
fe_off£t
);

943 
	}
}

951 
	$cßËsû_nodes
(
bË_id
, 
NodePage
* 
node_·ge
, NodePage* 
ÃighbÜ_·ge
, 
ÃighbÜ_šdex
, 
k_´ime
) {

953 
i
, 
j
, 
ÃighbÜ_š£¹iÚ_šdex
, 
n_’d
;

954 
NodePage
* 
tmp
;

960 ià(
ÃighbÜ_šdex
 == -1) {

961 
tmp
 = 
node_·ge
;

962 
node_·ge
 = 
ÃighbÜ_·ge
;

963 
ÃighbÜ_·ge
 = 
tmp
;

972 
ÃighbÜ_š£¹iÚ_šdex
 = 
ÃighbÜ_·ge
->
num_keys
;

979 ià(!
node_·ge
->
is_Ëaf
) {

980 
IÁ”ÇlPage
* 
node
 = (IÁ”ÇlPage*)
node_·ge
;

981 
IÁ”ÇlPage
* 
ÃighbÜ_node
 = (IÁ”ÇlPage*)
ÃighbÜ_·ge
;

986 
	`INTERNAL_KEY
(
ÃighbÜ_node
, 
ÃighbÜ_š£¹iÚ_šdex
èğ
k_´ime
;

987 
ÃighbÜ_node
->
num_keys
++;

989 
n_’d
 = 
node
->
num_keys
;

991 
i
 = 
ÃighbÜ_š£¹iÚ_šdex
 + 1, 
j
 = 0; j < 
n_’d
; i++, j++) {

992 
	`INTERNAL_KEY
(
ÃighbÜ_node
, 
i
èğINTERNAL_KEY(
node
, 
j
);

993 
	`INTERNAL_OFFSET
(
ÃighbÜ_node
, 
i
èğINTERNAL_OFFSET(
node
, 
j
);

994 
ÃighbÜ_node
->
num_keys
++;

995 
node
->
num_keys
--;

1002 
	`INTERNAL_OFFSET
(
ÃighbÜ_node
, 
i
èğINTERNAL_OFFSET(
node
, 
j
);

1007 
i
 = 0; i < 
ÃighbÜ_node
->
num_keys
 + 1; i++) {

1008 
NodePage
 
chd_·ge
;

1009 
	`lßd_·ge_äom_bufãr
(
bË_id
, 
	`INTERNAL_OFFSET
(
ÃighbÜ_node
, 
i
), (
Page
*)&
chd_·ge
);

1010 
chd_·ge
.
·»Á
 = 
ÃighbÜ_node
->
fe_off£t
;

1011 
	`dœty_Ú
(
bË_id
, (
Page
*)&
chd_·ge
);

1014 
	`dœty_Ú
(
bË_id
, (
Page
*)
ÃighbÜ_node
);

1016 
	`put_ä“_·ge
(
bË_id
, 
node
->
fe_off£t
);

1026 
L—fPage
* 
node
 = (L—fPage*)
node_·ge
;

1027 
L—fPage
* 
ÃighbÜ_node
 = (L—fPage*)
ÃighbÜ_·ge
;

1029 
i
 = 
ÃighbÜ_š£¹iÚ_šdex
, 
j
 = 0; j < 
node
->
num_keys
; i++, j++) {

1030 
	`LEAF_KEY
(
ÃighbÜ_node
, 
i
èğLEAF_KEY(
node
, 
j
);

1031 
	`memıy
(
	`LEAF_VALUE
(
ÃighbÜ_node
, 
i
), LEAF_VALUE(
node
, 
j
), 
SIZE_VALUE
);

1032 
ÃighbÜ_node
->
num_keys
++;

1034 
ÃighbÜ_node
->
siblšg
 = 
node
->sibling;

1036 
	`dœty_Ú
(
bË_id
, (
Page
*)
ÃighbÜ_node
);

1038 
	`put_ä“_·ge
(
bË_id
, 
node
->
fe_off£t
);

1041 
NodePage
 
·»Á_node
;

1042 
	`lßd_·ge_äom_bufãr
(
bË_id
, 
node_·ge
->
·»Á
, (
Page
*)&
·»Á_node
);

1043 
	`d–‘e_’Œy
(
bË_id
, &
·»Á_node
, 
k_´ime
);

1044 
	}
}

1052 
	$»di¡ribu‹_nodes
(
bË_id
, 
NodePage
* 
node_·ge
, NodePage* 
ÃighbÜ_·ge
,

1053 
ÃighbÜ_šdex
,

1054 
k_´ime_šdex
, 
k_´ime
) {

1056 
i
;

1063 ià(
ÃighbÜ_šdex
 != -1) {

1064 ià(!
node_·ge
->
is_Ëaf
) {

1065 
IÁ”ÇlPage
* 
node
 = (IÁ”ÇlPage*)
node_·ge
;

1066 
IÁ”ÇlPage
* 
ÃighbÜ_node
 = (IÁ”ÇlPage*)
ÃighbÜ_·ge
;

1067 
	`INTERNAL_OFFSET
(
node
,‚ode->
num_keys
 + 1) = INTERNAL_OFFSET(node,‚ode->num_keys);

1069 
i
 = 
node
->
num_keys
; i > 0; i--) {

1070 
	`INTERNAL_KEY
(
node
, 
i
) = INTERNAL_KEY(node, i - 1);

1071 
	`INTERNAL_OFFSET
(
node
, 
i
) = INTERNAL_OFFSET(node, i - 1);

1073 
	`INTERNAL_OFFSET
(
node
, 0èğINTERNAL_OFFSET(
ÃighbÜ_node
,‚eighbÜ_node->
num_keys
);

1074 
NodePage
 
chd_·ge
;

1075 
	`lßd_·ge_äom_bufãr
(
bË_id
, 
	`INTERNAL_OFFSET
(
node
, 0), (
Page
*)&
chd_·ge
);

1076 
chd_·ge
.
·»Á
 = 
node
->
fe_off£t
;

1077 
	`dœty_Ú
(
bË_id
, (
Page
*)&
chd_·ge
);

1079 
	`INTERNAL_OFFSET
(
ÃighbÜ_node
,‚eighbÜ_node->
num_keys
) = 0;

1080 
	`INTERNAL_KEY
(
node
, 0èğ
k_´ime
;

1082 
IÁ”ÇlPage
 
·»Á_node
;

1083 
	`lßd_·ge_äom_bufãr
(
bË_id
, 
node
->
·»Á
, (
Page
*)&
·»Á_node
);

1084 
	`INTERNAL_KEY
(&
·»Á_node
, 
k_´ime_šdex
èğINTERNAL_KEY(
ÃighbÜ_node
,‚eighbÜ_node->
num_keys
 - 1);

1085 
	`dœty_Ú
(
bË_id
, (
Page
*)&
·»Á_node
);

1090 
node
->
num_keys
++;

1091 
ÃighbÜ_node
->
num_keys
--;

1093 
	`dœty_Ú
(
bË_id
, (
Page
*)
node_·ge
);

1094 
	`dœty_Ú
(
bË_id
, (
Page
*)
ÃighbÜ_·ge
);

1097 
L—fPage
* 
node
 = (L—fPage*)
node_·ge
;

1098 
L—fPage
* 
ÃighbÜ_node
 = (L—fPage*)
ÃighbÜ_·ge
;

1100 
i
 = 
node
->
num_keys
; i > 0; i--) {

1101 
	`LEAF_KEY
(
node
, 
i
) = LEAF_KEY(node, i - 1);

1102 
	`memıy
(
	`LEAF_VALUE
(
node
, 
i
), LEAF_VALUEÒode, i - 1), 
SIZE_VALUE
);

1104 
	`memıy
(
	`LEAF_VALUE
(
node
, 0), LEAF_VALUE(
ÃighbÜ_node
,‚eighbÜ_node->
num_keys
 - 1), 
SIZE_VALUE
);

1105 
	`mem£t
(
	`LEAF_VALUE
(
ÃighbÜ_node
,‚eighbÜ_node->
num_keys
 - 1), 0, 
SIZE_VALUE
);

1106 
	`LEAF_KEY
(
node
, 0èğLEAF_KEY(
ÃighbÜ_node
,‚eighbÜ_node->
num_keys
 - 1);

1108 
IÁ”ÇlPage
 
·»Á_node
;

1109 
	`lßd_·ge_äom_bufãr
(
bË_id
, 
node
->
·»Á
, (
Page
*)&
·»Á_node
);

1110 
	`INTERNAL_KEY
(&
·»Á_node
, 
k_´ime_šdex
èğ
	`LEAF_KEY
(
node
, 0);

1111 
	`dœty_Ú
(
bË_id
, (
Page
*)&
·»Á_node
);

1116 
node
->
num_keys
++;

1117 
ÃighbÜ_node
->
num_keys
--;

1119 
	`dœty_Ú
(
bË_id
, (
Page
*)
node_·ge
);

1120 
	`dœty_Ú
(
bË_id
, (
Page
*)
ÃighbÜ_·ge
);

1131 ià(
node_·ge
->
is_Ëaf
) {

1132 
L—fPage
* 
node
 = (L—fPage*)
node_·ge
;

1133 
L—fPage
* 
ÃighbÜ_node
 = (L—fPage*)
ÃighbÜ_·ge
;;

1135 
	`LEAF_KEY
(
node
,‚ode->
num_keys
èğLEAF_KEY(
ÃighbÜ_node
, 0);

1136 
	`memıy
(
	`LEAF_VALUE
(
node
,‚ode->
num_keys
), LEAF_VALUE(
ÃighbÜ_node
, 0), 
SIZE_VALUE
);

1138 
IÁ”ÇlPage
 
·»Á_node
;

1139 
	`lßd_·ge_äom_bufãr
(
bË_id
, 
node
->
·»Á
, (
Page
*)&
·»Á_node
);

1140 
	`INTERNAL_KEY
(&
·»Á_node
, 
k_´ime_šdex
èğ
	`LEAF_KEY
(
ÃighbÜ_node
, 1);

1141 
	`dœty_Ú
(
bË_id
, (
Page
*)&
·»Á_node
);

1143 
i
 = 0; i < 
ÃighbÜ_node
->
num_keys
 - 1; i++) {

1144 
	`LEAF_KEY
(
ÃighbÜ_node
, 
i
) = LEAF_KEY(neighbor_node, i + 1);

1145 
	`memıy
(
	`LEAF_VALUE
(
ÃighbÜ_node
, 
i
), LEAF_VALUEÒeighbÜ_node, i + 1), 
SIZE_VALUE
);

1151 
node
->
num_keys
++;

1152 
ÃighbÜ_node
->
num_keys
--;

1154 
	`dœty_Ú
(
bË_id
, (
Page
*)
node_·ge
);

1155 
	`dœty_Ú
(
bË_id
, (
Page
*)
ÃighbÜ_·ge
);

1159 
IÁ”ÇlPage
* 
node
 = (IÁ”ÇlPage*)
node_·ge
;

1160 
IÁ”ÇlPage
* 
ÃighbÜ_node
 = (IÁ”ÇlPage*)
ÃighbÜ_·ge
;

1162 
	`INTERNAL_KEY
(
node
,‚ode->
num_keys
èğ
k_´ime
;

1163 
	`INTERNAL_OFFSET
(
node
,‚ode->
num_keys
 + 1èğINTERNAL_OFFSET(
ÃighbÜ_node
, 0);

1165 
NodePage
 
chd_·ge
;

1166 
	`lßd_·ge_äom_bufãr
(
bË_id
, 
	`INTERNAL_OFFSET
(
node
,‚ode->
num_keys
 + 1), (
Page
*)&
chd_·ge
);

1167 
chd_·ge
.
·»Á
 = 
node
->
fe_off£t
;

1168 
	`dœty_Ú
(
bË_id
, (
Page
*)&
chd_·ge
);

1170 
IÁ”ÇlPage
 
·»Á_node
;

1171 
	`lßd_·ge_äom_bufãr
(
bË_id
, 
node
->
·»Á
, (
Page
*)&
·»Á_node
);

1172 
	`INTERNAL_KEY
(&
·»Á_node
, 
k_´ime_šdex
èğINTERNAL_KEY(
ÃighbÜ_node
, 0);

1173 
	`dœty_Ú
(
bË_id
, (
Page
*)&
·»Á_node
);

1175 
i
 = 0; i < 
ÃighbÜ_node
->
num_keys
 - 1; i++) {

1176 
	`INTERNAL_KEY
(
ÃighbÜ_node
, 
i
) = INTERNAL_KEY(neighbor_node, i + 1);

1177 
	`INTERNAL_OFFSET
(
ÃighbÜ_node
, 
i
) = INTERNAL_OFFSET(neighbor_node, i + 1);

1180 
	`INTERNAL_OFFSET
(
ÃighbÜ_node
, 
i
) = INTERNAL_OFFSET(neighbor_node, i + 1);

1187 
node
->
num_keys
++;

1188 
ÃighbÜ_node
->
num_keys
--;

1190 
	`dœty_Ú
(
bË_id
, (
Page
*)
node_·ge
);

1191 
	`dœty_Ú
(
bË_id
, (
Page
*)
ÃighbÜ_·ge
);

1195 
	}
}

1203 
	$d–‘e_’Œy
(
bË_id
, 
NodePage
* 
node_·ge
, 
ušt64_t
 
key
) {

1205 
mš_keys
;

1206 
off_t
 
ÃighbÜ_off£t
;

1207 
ÃighbÜ_šdex
;

1208 
k_´ime_šdex
, 
k_´ime
;

1209 
ÿ·c™y
;

1213 
	`»move_’Œy_äom_node
(
bË_id
, 
node_·ge
, 
key
);

1217 ià(
dbh—d”
[
bË_id
 - 1].
roÙ_off£t
 =ğ
node_·ge
->
fe_off£t
) {

1218 
	`adju¡_roÙ
(
bË_id
);

1230 
mš_keys
 = 
node_·ge
->
is_Ëaf
 ? 
	`cut
(
Üd”_Ëaf
 - 1è: cut(
Üd”_š‹º®
) - 1;

1236 ià(
node_·ge
->
num_keys
 >ğ
mš_keys
)

1251 
ÃighbÜ_šdex
 = 
	`g‘_ÃighbÜ_šdex
(
bË_id
, 
node_·ge
);

1252 
k_´ime_šdex
 = 
ÃighbÜ_šdex
 == -1 ? 0 :‚eighbor_index;

1254 
IÁ”ÇlPage
 
·»Á_node
;

1255 
	`lßd_·ge_äom_bufãr
(
bË_id
, 
node_·ge
->
·»Á
, (
Page
*)&
·»Á_node
);

1257 
k_´ime
 = 
	`INTERNAL_KEY
(&
·»Á_node
, 
k_´ime_šdex
);

1258 
ÃighbÜ_off£t
 = 
ÃighbÜ_šdex
 =ğ-1 ? 
	`INTERNAL_OFFSET
(&
·»Á_node
, 1) :

1259 
	`INTERNAL_OFFSET
(&
·»Á_node
, 
ÃighbÜ_šdex
);

1261 
ÿ·c™y
 = 
node_·ge
->
is_Ëaf
 ? 
Üd”_Ëaf
 : 
Üd”_š‹º®
 - 1;

1263 
NodePage
 
ÃighbÜ_·ge
;

1264 
	`lßd_·ge_äom_bufãr
(
bË_id
, 
ÃighbÜ_off£t
, (
Page
*)&
ÃighbÜ_·ge
);

1267 ià(
ÃighbÜ_·ge
.
num_keys
 + 
node_·ge
->num_key < 
ÿ·c™y
)

1268 
	`cßËsû_nodes
(
bË_id
, 
node_·ge
, &
ÃighbÜ_·ge
, 
ÃighbÜ_šdex
, 
k_´ime
);

1273 
	`»di¡ribu‹_nodes
(
bË_id
, 
node_·ge
, &
ÃighbÜ_·ge
, 
ÃighbÜ_šdex
, 
k_´ime_šdex
, 
k_´ime
);

1276 
	}
}

1280 
	$d–‘e
(
bË_id
, 
ušt64_t
 
key
) {

1282 * 
v®ue_found
 = 
NULL
;

1283 ià((
v®ue_found
 = 
	`fšd
(
bË_id
, 
key
)) == 0) {

1285 
	`ä“
(
v®ue_found
);

1289 
L—fPage
 
Ëaf_node
;

1290 
	`fšd_Ëaf
(
bË_id
, 
key
, &
Ëaf_node
);

1292 
	`d–‘e_’Œy
(
bË_id
, (
NodePage
*)&
Ëaf_node
, 
key
);

1295 
	}
}

1298 
	$š™_db
(
num_buf
){

1299 
i
;

1302 
buf_mgr
 = (
Bufãr
 *)
	`ÿÎoc
(
num_buf
, (Buffer));

1304 if(
buf_mgr
 =ğ
NULL
){

1311 
buf_size
 = 
num_buf
;

1314 
	}
}

1316 
	$şo£_bË
(
bË_id
){

1317 
i
;

1320 if(
bË_id
 < 1 ||abË_id > 10 || 
buf_size
 =ğ-1 || 
buf_mgr
 =ğ
NULL
){

1324 
i
 = 0; i < 
buf_size
; i++){

1325 if(
buf_mgr
[
i
].
bË_id
 ==able_id){

1327 if(
buf_mgr
[
i
].
is_dœty
 == 1){

1328 
	`æush_·ge
(
bË_id
, 
buf_mgr
[
i
].
äame
);

1332 
	`ä“
(
buf_mgr
[
i
].
äame
);

1334 
	`mem£t
(
buf_mgr
+
i
, 0, (
Bufãr
));

1339 
bË_ids
[
bË_id
 -1] = 0;

1342 
	}
}

1344 
	$shutdown_db
(){

1345 
i
,
bË_id
 = -1;

1348 if(
buf_size
 =ğ-1 || 
buf_mgr
 =ğ
NULL
){

1352 
i
 = 0; i < 
buf_size
; i++){

1354 if(
buf_mgr
[
i
].
is_dœty
 == 1){

1355 
bË_id
 = 
buf_mgr
[
i
].table_id;

1356 
	`æush_·ge
(
bË_id
, 
buf_mgr
[
i
].
äame
);

1359 if(1 <ğ
buf_mgr
[
i
].
bË_id
 && buf_mgr[i].table_id <= 10){

1360 
	`ä“
(
buf_mgr
[
i
].
äame
);

1365 
	`ä“
(
buf_mgr
);

1368 
	}
}

1370 
	$lßd_·ge_äom_bufãr
(
bË_id
, 
off_t
 
off£t
, 
Page
* 
·ge
){

1371 
Page
 *
‹mp
;

1372 
buf_šdex
 = -1;

1374 
‹mp
 = 
	`is_š_bufãr
(
bË_id
, 
off£t
, 
·ge
, 1);

1377 if(
‹mp
 !ğ
NULL
){

1379 
	`memıy
(
·ge
, 
‹mp
, (
Page
));

1380 
·ge
->
fe_off£t
 = 
off£t
;

1387 
buf_šdex
 = 
	`»¶aû_·ge
(
bË_id
);

1390 
	`lßd_·ge
(
bË_id
, 
off£t
, 
·ge
);

1391 
·ge
->
fe_off£t
 = 
off£t
;

1395 if(
buf_šdex
 != -1){

1399 
buf_mgr
[
buf_šdex
].
äame
 = (
Page
*)
	`m®loc
((Page));

1400 
	`memıy
(
buf_mgr
[
buf_šdex
].
äame
, 
·ge
, (
Page
));

1402 
buf_mgr
[
buf_šdex
].
äame
 = 
·ge
;

1403 
buf_mgr
[
buf_šdex
].
bË_id
 =able_id;

1404 
buf_mgr
[
buf_šdex
].
·ge_off£t
 = 
off£t
;

1405 
buf_mgr
[
buf_šdex
].
is_dœty
 = 0;

1406 
buf_mgr
[
buf_šdex
].
pš_couÁ
 = 1;

1407 
buf_mgr
[
buf_šdex
].
»fb™
 = 1;

1410 
	}
}

1414 
Page
* 
	$is_š_bufãr
(
bË_id
, 
off_t
 
off£t
, 
Page
 *
·ge
, 
ty³
){

1415 
i
;

1417 if(
buf_size
 == -1){

1419  
NULL
;

1422 
i
 = 0; i < 
buf_size
; i++){

1423 if(
buf_mgr
[
rg‘_buf
].
bË_id
 =ğbË_id && buf_mgr[rg‘_buf].
·ge_off£t
 =ğ
off£t
){

1426 if(
ty³
 == 1){

1427 
buf_mgr
[
rg‘_buf
].
pš_couÁ
++;

1432 
	`memıy
(
buf_mgr
[
rg‘_buf
].
äame
, 
·ge
, (
Page
));

1433 
buf_mgr
[
rg‘_buf
].
is_dœty
 = 1;

1434 
buf_mgr
[
rg‘_buf
].
pš_couÁ
--;

1435 if(
buf_mgr
[
rg‘_buf
].
pš_couÁ
 < 0){

1436 
buf_mgr
[
rg‘_buf
].
pš_couÁ
 = 0;

1439  
buf_mgr
[
rg‘_buf
].
äame
;

1441 
rg‘_buf
 = (rg‘_buà+ 1è% 
buf_size
;

1445  
NULL
;

1446 
	}
}

1448 
	$»¶aû_·ge
(
bË_id
){

1450 
Page
 *
rg‘_·ge
 = 
NULL
;

1451 
rg‘_šdex
 = -1, 
šdex
 = 0;

1454 
rg‘_·ge
 =ğ
NULL
 && 
šdex
 =ğ
buf_size
){

1457 if(
buf_mgr
[
şock_hªd
].
pš_couÁ
 =ğ0 && buf_mgr[şock_hªd].
»fb™
 == 0){

1459 
rg‘_šdex
 = 
şock_hªd
;

1462 
rg‘_·ge
 = 
buf_mgr
[
şock_hªd
].
äame
;

1465 if(
buf_mgr
[
şock_hªd
].
is_dœty
 == 1){

1467 
	`æush_·ge
(
bË_id
, 
rg‘_·ge
);

1470 
	`mem£t
(
buf_mgr
+
şock_hªd
, 0, (
Bufãr
));

1476 if(
buf_mgr
[
şock_hªd
].
pš_couÁ
 =ğ0 && buf_mgr[şock_hªd].
»fb™
 == 1){

1477 
buf_mgr
[
şock_hªd
].
»fb™
 = 0;

1481 
şock_hªd
 = (şock_hªd + 1è% 
buf_size
;

1483 
šdex
++;

1486  
rg‘_šdex
;

1487 
	}
}

1490 
	$dœty_Ú
(
bË_id
, 
Page
 *
·ge
){

1491 
i
, 
buf_šdex
 = -1;

1492 
Page
 *
‹mp
 = 
NULL
;

1497 
‹mp
 = 
	`is_š_bufãr
(
bË_id
, 
·ge
->
fe_off£t
,…age, 0);

1500 if(
‹mp
 =ğ
NULL
){

1501 
buf_šdex
 = 
	`»¶aû_·ge
(
bË_id
);

1504 if(
buf_šdex
 == -1){

1505 
	`æush_·ge
(
bË_id
, 
·ge
);

1512 
buf_mgr
[
buf_šdex
].
äame
 = (
Page
*)
	`m®loc
((Page));

1513 
	`memıy
(
buf_mgr
[
buf_šdex
].
äame
, 
·ge
, (
Page
));

1514 
buf_mgr
[
buf_šdex
].
bË_id
 =able_id;

1515 
buf_mgr
[
buf_šdex
].
·ge_off£t
 = 
·ge
->
fe_off£t
;

1517 
buf_mgr
[
buf_šdex
].
is_dœty
 = 1;

1518 
buf_mgr
[
buf_šdex
].
pš_couÁ
 = 0;

1519 
buf_mgr
[
buf_šdex
].
»fb™
 = 0;

1522 
	}
}

	@src/file.c

1 
	~<sys/ty³s.h
>

2 
	~<fú.h
>

3 
	~<¡dlib.h
>

4 
	~<as£¹.h
>

5 
	~<¡dio.h
>

6 
	~<uni¡d.h
>

7 
	~<¡ršg.h
>

8 
	~"fe.h
"

10 
H—d”Page
 
	gdbh—d”
[10];

11 
	gdbfe
[10];

15 
off_t
 
	$g‘_ä“_·ge
(
bË_id
) {

16 
off_t
 
ä“·ge_off£t
;

18 
ä“·ge_off£t
 = 
dbh—d”
[
bË_id
 - 1].
ä“li¡
;

19 ià(
ä“·ge_off£t
 == 0) {

21 
	`ex·nd_fe
(
bË_id
, 
dbh—d”
[bË_id - 1].
num_·ges
);

22 
ä“·ge_off£t
 = 
dbh—d”
[
bË_id
 - 1].
ä“li¡
;

25 
F»ePage
 
ä“·ge
;

26 
	`lßd_·ge_äom_bufãr
(
bË_id
, 
ä“·ge_off£t
, (
Page
*)&
ä“·ge
);

27 
dbh—d”
[
bË_id
 - 1].
ä“li¡
 = 
ä“·ge
.
Ãxt
;

29 
	`dœty_Ú
(
bË_id
, (
Page
*)(
dbh—d”
 +able_id - 1));

31  
ä“·ge_off£t
;

32 
	}
}

35 
	$put_ä“_·ge
(
bË_id
, 
off_t
 
·ge_off£t
) {

36 
F»ePage
 
ä“·ge
;

37 
	`mem£t
(&
ä“·ge
, 0, 
PAGE_SIZE
);

39 
ä“·ge
.
Ãxt
 = 
dbh—d”
[
bË_id
 - 1].
ä“li¡
;

40 
ä“·ge
.
fe_off£t
 = 
·ge_off£t
;

42 
	`dœty_Ú
(
bË_id
, (
Page
*)&
ä“·ge
);

44 
dbh—d”
[
bË_id
 - 1].
ä“li¡
 = 
·ge_off£t
;

46 
	`dœty_Ú
(
bË_id
, (
Page
*)(
dbh—d”
 +able_id - 1));

47 
	}
}

50 
	$ex·nd_fe
(
bË_id
, 
size_t
 
út_·ge_to_ex·nd
) {

51 
off_t
 
off£t
 = 
dbh—d”
[
bË_id
 - 1].
num_·ges
 * 
PAGE_SIZE
;

53 ià(
dbh—d”
[
bË_id
 - 1].
num_·ges
 > 1024 * 1024) {

55 
	`as£¹
("Test: you‡re‡lready having‡ DB file overhan 4GB");

58 
i
;

59 
i
 = 0; i < 
út_·ge_to_ex·nd
; i++) {

60 
	`put_ä“_·ge
(
bË_id
, 
off£t
);

61 
dbh—d”
[
bË_id
 - 1].
num_·ges
++;

62 
off£t
 +ğ
PAGE_SIZE
;

65 
	`dœty_Ú
(
bË_id
, (
Page
*)(
dbh—d”
 +able_id - 1));

66 
	}
}

68 
	$lßd_·ge
(
bË_id
, 
off_t
 
off£t
, 
Page
* 
·ge
) {

69 
	`l£ek
(
dbfe
[
bË_id
 - 1], 
off£t
, 
SEEK_SET
);

70 
	`»ad
(
dbfe
[
bË_id
 - 1], 
·ge
, 
PAGE_SIZE
);

71 
·ge
->
fe_off£t
 = 
off£t
;

72 
	}
}

74 
	$æush_·ge
(
bË_id
, 
Page
* 
·ge
) {

75 
	`l£ek
(
dbfe
[
bË_id
 - 1], 
·ge
->
fe_off£t
, 
SEEK_SET
);

76 
	`wr™e
(
dbfe
[
bË_id
 - 1], 
·ge
, 
PAGE_SIZE
);

77 
	}
}

	@src/main.c

1 
	~<¡dio.h
>

2 
	~<¡dlib.h
>

3 
	~<fú.h
>

4 
	~<uni¡d.h
>

5 
	~<sys/ty³s.h
>

6 
	~<š‰y³s.h
>

7 
	~"b±.h
"

8 
	~"fe.h
"

9 
	~<¡ršg.h
>

10 
	~<time.h
>

12 
£qu’tŸl_sm®l_‹¡
(
bË
);

13 
£qu’tŸl_medium_‹¡
(
bË
);

14 
£qu’tŸl_Ïrge_‹¡
(
bË
);

15 
¿ndom_sm®l_‹¡
(
bË
);

16 
¿ndom_medium_‹¡
(
bË
);

17 
¿ndom_Ïrge_‹¡
(
bË
);

20 
	$maš
Ğ
¬gc
, ** 
¬gv
 ) {

21 
ušt64_t
 
šput_key
;

22 
šput_v®ue
[
SIZE_VALUE
];

23 
š¡ruùiÚ
;

24 
bË
 = 0;

30 
	`š™_db
(10000);

31 
bË
 = 
	`İ’_bË
("test.db");

33 
	`sÿnf
("%c", &
š¡ruùiÚ
è!ğ
EOF
) {

34 
š¡ruùiÚ
) {

36 
	`sÿnf
("%" 
PRIu64
 " %s", &
šput_key
, 
šput_v®ue
);

37 
	`š£¹
(
bË
, 
šput_key
, 
šput_v®ue
);

41 
	`sÿnf
("%" 
PRIu64
 "", &
šput_key
);

42 
	`d–‘e
(
bË
, 
šput_key
);

47 
	`sÿnf
("%" 
PRIu64
 "", &
šput_key
);

48 
	`fšd_ªd_´št
(
bË
, 
šput_key
);

49 
	`fæush
(
¡dout
);

52 
	`g‘ch¬
() != ()'\n');

53  
EXIT_SUCCESS
;

60 
	`£qu’tŸl_sm®l_‹¡
(
bË
);

61 
	`£qu’tŸl_medium_‹¡
(
bË
);

62 
	`£qu’tŸl_Ïrge_‹¡
(
bË
);

66 
	`¿ndom_sm®l_‹¡
(
bË
);

67 
	`¿ndom_medium_‹¡
(
bË
);

68 
	`¿ndom_Ïrge_‹¡
(
bË
);

74 
	`g‘ch¬
() != ()'\n');

79 
	`şo£_bË
(
bË
);

81  
EXIT_SUCCESS
;

82 
	}
}

85 
	$£qu’tŸl_sm®l_‹¡
(
bË
){

86 
šput_v®ue
[
SIZE_VALUE
] = " A";

87 * 
‹¡_v®ue
 = 
NULL
;

88 
i
;

89 
şock_t
 
¡¬t
, 
’d
;

91 
¡¬t
 = 
	`şock
();

93 
i
 = 1; i <= 5000; i++){

94 
šput_v®ue
[0] = (
i
%10) + '0';

95 
	`š£¹
(
bË
, 
i
, 
šput_v®ue
);

96 
‹¡_v®ue
 = 
	`fšd
(
bË
, 
i
);

97 if(
	`¡rcmp
(
šput_v®ue
, 
‹¡_v®ue
) != 0){

98 
	`´štf
("Test Fail\n");

101 
	`ä“
(
‹¡_v®ue
);

104 
’d
 = 
	`şock
();

106 
	`´štf
("Test Success\n");

107 
	`´štf
("Sequ’tŸÈsm®È‹¡ : %à£cÚds\n", ()(
’d
 - 
¡¬t
)/
CLOCKS_PER_SEC
);

108 
	}
}

110 
	$£qu’tŸl_medium_‹¡
(
bË
){

111 
šput_v®ue
[
SIZE_VALUE
] = " A";

112 * 
‹¡_v®ue
 = 
NULL
;

113 
i
;

114 
şock_t
 
¡¬t
, 
’d
;

116 
¡¬t
 = 
	`şock
();

118 
i
 = 1; i <= 10000; i++){

119 
šput_v®ue
[0] = (
i
%10) + '0';

120 
	`š£¹
(
bË
, 
i
, 
šput_v®ue
);

121 
‹¡_v®ue
 = 
	`fšd
(
bË
, 
i
);

122 if(
	`¡rcmp
(
šput_v®ue
, 
‹¡_v®ue
) != 0){

123 
	`´štf
("Test Fail\n");

126 
	`ä“
(
‹¡_v®ue
);

129 
’d
 = 
	`şock
();

131 
	`´štf
("Test Success\n");

132 
	`´štf
("Sequ’tŸÈmediume¡ : %à£cÚds\n", ()(
’d
 - 
¡¬t
)/
CLOCKS_PER_SEC
);

133 
	}
}

135 
	$£qu’tŸl_Ïrge_‹¡
(
bË
){

136 
šput_v®ue
[
SIZE_VALUE
] = " A";

137 * 
‹¡_v®ue
 = 
NULL
;

138 
i
;

139 
şock_t
 
¡¬t
, 
’d
;

141 
¡¬t
 = 
	`şock
();

143 
i
 = 1; i <= 50000; i++){

144 
šput_v®ue
[0] = (
i
%10) + '0';

145 
	`š£¹
(
bË
, 
i
, 
šput_v®ue
);

146 
‹¡_v®ue
 = 
	`fšd
(
bË
, 
i
);

147 if(
	`¡rcmp
(
šput_v®ue
, 
‹¡_v®ue
) != 0){

148 
	`´štf
("Test Fail\n");

151 
	`ä“
(
‹¡_v®ue
);

154 
’d
 = 
	`şock
();

156 
	`´štf
("Test Success\n");

157 
	`´štf
("Sequ’tŸÈÏrg‹¡ : %à£cÚds\n", ()(
’d
 - 
¡¬t
)/
CLOCKS_PER_SEC
);

159 
	}
}

162 
	$¿ndom_sm®l_‹¡
(
bË
){

164 
	}
}

166 
	$¿ndom_medium_‹¡
(
bË
){

168 
	}
}

170 
	$¿ndom_Ïrge_‹¡
(
bË
){

172 
	}
}

	@
1
.
0
5
61
include/bpt.h
include/file.h
src/bpt.c
src/file.c
src/main.c
