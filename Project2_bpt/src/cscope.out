cscope 15 $HOME/mysql/Lab/bpt/src -q 0000000234 0000059068
	@bpt.c

4 
	#Vîsi⁄
 "1.14"

	)

55 
	~"b±.h
"

69 
	g‹dî
 = 
DEFAULT_ORDER
;

70 
	gÀaf_‹dî
 = 32;

71 
	göã∫Æ_‹dî
 = 249;

78 
node
 * 
	gqueue
 = 
NULL
;

85 
boﬁ
 
	gvîbo£_ouçut
 = 
Ál£
;

90 
FILE
 *
	gÂ
;

96 
öt64_t
 
	gdeÁu…_off£t
;

102 
∑ge_li°
 *
	ghód
 = 
NULL
;

110 
	$li˚n£_nŸi˚
( ) {

111 
	`¥ötf
("bpt version %s -- Copyright (C) 2010 Amittai Aviram "

112 "hâp://www.amôèi.com\n", 
Vîsi⁄
);

113 
	`¥ötf
("ThisÖrogram comes with ABSOLUTELY NO WARRANTY; for details "

117 
	}
}

122 
	$¥öt_li˚n£
–
li˚n£_∑π
 ) {

123 
°¨t
, 
íd
, 
löe
;

124 
FILE
 * 
Â
;

125 
buf„r
[0x100];

127 
li˚n£_∑π
) {

128 
LICENSE_WARRANTEE
:

129 
°¨t
 = 
LICENSE_WARRANTEE_START
;

130 
íd
 = 
LICENSE_WARRANTEE_END
;

132 
LICENSE_CONDITIONS
:

133 
°¨t
 = 
LICENSE_CONDITIONS_START
;

134 
íd
 = 
LICENSE_CONDITIONS_END
;

140 
Â
 = 
	`f›í
(
LICENSE_FILE
, "r");

141 i‡(
Â
 =
NULL
) {

142 
	`≥º‹
("print_license: fopen");

143 
	`exô
(
EXIT_FAILURE
);

145 
löe
 = 0;Üöê< 
°¨t
;Üine++)

146 
	`fgës
(
buf„r
, (buf„r), 
Â
);

147  ; 
löe
 < 
íd
;Üine++) {

148 
	`fgës
(
buf„r
, (buf„r), 
Â
);

149 
	`¥ötf
("%s", 
buf„r
);

151 
	`f˛o£
(
Â
);

152 
	}
}

157 
	$ußge_1
( ) {

158 
	`¥ötf
("B+ Tªêo‡Ordî %d.\n", 
‹dî
);

159 
	`¥ötf
("Following Silberschatz, Korth, Sidarshan, Database Concepts, "

164 
	`¥ötf
("(%d <‹dî <%d).\n", 
MIN_ORDER
, 
MAX_ORDER
);

165 
	`¥ötf
("To start with input fromá file ofÇewline-delimited integers, \n"

168 
	}
}

173 
	$ußge_2
( ) {

174 
	`¥ötf
("Enterány ofÅhe following commandsáfterÅheÖrompt > :\n"

190 
	}
}

195 
	$ußge_3
( ) {

196 
	`¥ötf
("Usage: ./bpt [<order>]\n");

197 
	`¥ötf
("\twhîê%d <‹dî <%d .\n", 
MIN_ORDER
, 
MAX_ORDER
);

198 
	}
}

204 
	$íqueue
–
node
 * 
√w_node
 ) {

205 
node
 * 
c
;

206 i‡(
queue
 =
NULL
) {

207 
queue
 = 
√w_node
;

208 
queue
->
√xt
 = 
NULL
;

211 
c
 = 
queue
;

212 
c
->
√xt
 !
NULL
) {

213 
c
 = c->
√xt
;

215 
c
->
√xt
 = 
√w_node
;

216 
√w_node
->
√xt
 = 
NULL
;

218 
	}
}

224 
node
 * 
	$dequeue
( ) {

225 
node
 * 
n
 = 
queue
;

226 
queue
 = queue->
√xt
;

227 
n
->
√xt
 = 
NULL
;

228  
n
;

229 
	}
}

236 
	$¥öt_Àaves
–
node
 * 
roŸ
 ) {

237 
i
;

238 
node
 * 
c
 = 
roŸ
;

239 i‡(
roŸ
 =
NULL
) {

240 
	`¥ötf
("EmptyÅree.\n");

243 !
c
->
is_Àaf
)

244 
c
 = c->
poöãrs
[0];

245 
åue
) {

246 
i
 = 0; i < 
c
->
num_keys
; i++) {

247 i‡(
vîbo£_ouçut
)

248 
	`¥ötf
("%lx ", ()
c
->
poöãrs
[
i
]);

249 
	`¥ötf
("%d ", 
c
->
keys
[
i
]);

251 i‡(
vîbo£_ouçut
)

252 
	`¥ötf
("%lx ", ()
c
->
poöãrs
[
‹dî
 - 1]);

253 i‡(
c
->
poöãrs
[
‹dî
 - 1] !
NULL
) {

254 
	`¥ötf
(" | ");

255 
c
 = c->
poöãrs
[
‹dî
 - 1];

260 
	`¥ötf
("\n");

261 
	}
}

268 
	$height
–
node
 * 
roŸ
 ) {

269 
h
 = 0;

270 
node
 * 
c
 = 
roŸ
;

271 !
c
->
is_Àaf
) {

272 
c
 = c->
poöãrs
[0];

273 
h
++;

275  
h
;

276 
	}
}

282 
	$∑th_to_roŸ
–
node
 * 
roŸ
,Çodê* 
chûd
 ) {

283 
Àngth
 = 0;

284 
node
 * 
c
 = 
chûd
;

285 
c
 !
roŸ
) {

286 
c
 = c->
∑ª¡
;

287 
Àngth
++;

289  
Àngth
;

290 
	}
}

302 
	$¥öt_åì
–
node
 * 
roŸ
 ) {

304 
node
 * 
n
 = 
NULL
;

305 
i
 = 0;

306 
ønk
 = 0;

307 
√w_ønk
 = 0;

309 i‡(
roŸ
 =
NULL
) {

310 
	`¥ötf
("EmptyÅree.\n");

313 
queue
 = 
NULL
;

314 
	`íqueue
(
roŸ
);

315  
queue
 !
NULL
 ) {

316 
n
 = 
	`dequeue
();

317 i‡(
n
->
∑ª¡
 !
NULL
 &&Ç =n->∑ª¡->
poöãrs
[0]) {

318 
√w_ønk
 = 
	`∑th_to_roŸ
–
roŸ
, 
n
 );

319 i‡(
√w_ønk
 !
ønk
) {

320 
ønk
 = 
√w_ønk
;

321 
	`¥ötf
("\n");

324 i‡(
vîbo£_ouçut
)

325 
	`¥ötf
("(%lx)", ()
n
);

326 
i
 = 0; i < 
n
->
num_keys
; i++) {

327 i‡(
vîbo£_ouçut
)

328 
	`¥ötf
("%lx ", ()
n
->
poöãrs
[
i
]);

329 
	`¥ötf
("%d ", 
n
->
keys
[
i
]);

331 i‡(!
n
->
is_Àaf
)

332 
i
 = 0; i <
n
->
num_keys
; i++)

333 
	`íqueue
(
n
->
poöãrs
[
i
]);

334 i‡(
vîbo£_ouçut
) {

335 i‡(
n
->
is_Àaf
)

336 
	`¥ötf
("%lx ", ()
n
->
poöãrs
[
‹dî
 - 1]);

338 
	`¥ötf
("%lx ", ()
n
->
poöãrs
[n->
num_keys
]);

340 
	`¥ötf
("| ");

342 
	`¥ötf
("\n");

343 
	}
}

349 
	$föd_™d_¥öt
(
node
 * 
roŸ
, 
key
, 
boﬁ
 
vîbo£
) {

350 
ªc‹d
 * 
r
 = 
	`föd_åì
(
roŸ
, 
key
, 
vîbo£
);

351 i‡(
r
 =
NULL
)

352 
	`¥ötf
("Rec‹dÇŸ found undî key %d.\n", 
key
);

354 
	`¥ötf
("Recordát %lx -- key %d, value %d.\n",

355 ()
r
, 
key
,Ñ->
vÆue
);

356 
	}
}

362 
	$föd_™d_¥öt_ønge
–
node
 * 
roŸ
, 
key_°¨t
, 
key_íd
,

363 
boﬁ
 
vîbo£
 ) {

364 
i
;

365 
¨øy_size
 = 
key_íd
 - 
key_°¨t
 + 1;

366 
ªtu∫ed_keys
[
¨øy_size
];

367 * 
ªtu∫ed_poöãrs
[
¨øy_size
];

368 
num_found
 = 
	`föd_ønge
–
roŸ
, 
key_°¨t
, 
key_íd
, 
vîbo£
,

369 
ªtu∫ed_keys
, 
ªtu∫ed_poöãrs
 );

370 i‡(!
num_found
)

371 
	`¥ötf
("None found.\n");

373 
i
 = 0; i < 
num_found
; i++)

374 
	`¥ötf
("Key: %d Location: %lx Value: %d\n",

375 
ªtu∫ed_keys
[
i
],

376 ()
ªtu∫ed_poöãrs
[
i
],

377 ((
ªc‹d
 *)

378 
ªtu∫ed_poöãrs
[
i
])->
vÆue
);

380 
	}
}

388 
	$föd_ønge
–
node
 * 
roŸ
, 
key_°¨t
, 
key_íd
, 
boﬁ
 
vîbo£
,

389 
ªtu∫ed_keys
[], * 
ªtu∫ed_poöãrs
[]) {

390 
i
, 
num_found
;

391 
num_found
 = 0;

392 
node
 * 
n
 = 
	`föd_Àaf
–
roŸ
, 
key_°¨t
, 
vîbo£
 );

393 i‡(
n
 =
NULL
)  0;

394 
i
 = 0; i < 
n
->
num_keys
 &&Ç->
keys
[i] < 
key_°¨t
; i++) ;

395 i‡(
i
 =
n
->
num_keys
)  0;

396 
n
 !
NULL
) {

397  ; 
i
 < 
n
->
num_keys
 &&Ç->
keys
[i] <
key_íd
; i++) {

398 
ªtu∫ed_keys
[
num_found
] = 
n
->
keys
[
i
];

399 
ªtu∫ed_poöãrs
[
num_found
] = 
n
->
poöãrs
[
i
];

400 
num_found
++;

402 
n
 =Ç->
poöãrs
[
‹dî
 - 1];

403 
i
 = 0;

405  
num_found
;

406 
	}
}

414 
node
 * 
	$föd_Àaf
–
node
 * 
roŸ
, 
key
, 
boﬁ
 
vîbo£
 ) {

415 
i
 = 0;

416 
node
 * 
c
 = 
roŸ
;

417 i‡(
c
 =
NULL
) {

418 i‡(
vîbo£
)

419 
	`¥ötf
("EmptyÅree.\n");

420  
c
;

422 !
c
->
is_Àaf
) {

423 i‡(
vîbo£
) {

424 
	`¥ötf
("[");

425 
i
 = 0; i < 
c
->
num_keys
 - 1; i++)

426 
	`¥ötf
("%d ", 
c
->
keys
[
i
]);

427 
	`¥ötf
("%d] ", 
c
->
keys
[
i
]);

429 
i
 = 0;

430 
i
 < 
c
->
num_keys
) {

431 i‡(
key
 >
c
->
keys
[
i
]) i++;

434 i‡(
vîbo£
)

435 
	`¥ötf
("%d ->\n", 
i
);

436 
c
 = (
node
 *)c->
poöãrs
[
i
];

438 i‡(
vîbo£
) {

439 
	`¥ötf
("Leaf [");

440 
i
 = 0; i < 
c
->
num_keys
 - 1; i++)

441 
	`¥ötf
("%d ", 
c
->
keys
[
i
]);

442 
	`¥ötf
("%d] ->\n", 
c
->
keys
[
i
]);

444  
c
;

445 
	}
}

451 
ªc‹d
 * 
	$föd_åì
–
node
 * 
roŸ
, 
key
, 
boﬁ
 
vîbo£
 ) {

452 
i
 = 0;

453 
node
 * 
c
 = 
	`föd_Àaf
–
roŸ
, 
key
, 
vîbo£
 );

454 i‡(
c
 =
NULL
)  NULL;

455 
i
 = 0; i < 
c
->
num_keys
; i++)

456 i‡(
c
->
keys
[
i
] =
key
) ;

457 i‡(
i
 =
c
->
num_keys
)

458  
NULL
;

460  (
ªc‹d
 *)
c
->
poöãrs
[
i
];

461 
	}
}

466 
	$cut
–
Àngth
 ) {

467 i‡(
Àngth
 % 2 == 0)

468  
Àngth
/2;

470  
Àngth
/2 + 1;

471 
	}
}

479 
ªc‹d
 * 
	$make_ªc‹d
(
vÆue
) {

480 
ªc‹d
 * 
√w_ªc‹d
 = (ªc‹d *)
	`mÆloc
((record));

481 i‡(
√w_ªc‹d
 =
NULL
) {

482 
	`≥º‹
("Record creation.");

483 
	`exô
(
EXIT_FAILURE
);

486 
√w_ªc‹d
->
vÆue
 = value;

488  
√w_ªc‹d
;

489 
	}
}

495 
node
 * 
	$make_node
( ) {

496 
node
 * 
√w_node
;

497 
√w_node
 = 
	`mÆloc
((
node
));

498 i‡(
√w_node
 =
NULL
) {

499 
	`≥º‹
("Node creation.");

500 
	`exô
(
EXIT_FAILURE
);

502 
√w_node
->
keys
 = 
	`mÆloc
–(
‹dî
 - 1) * () );

503 i‡(
√w_node
->
keys
 =
NULL
) {

504 
	`≥º‹
("NewÇode keysárray.");

505 
	`exô
(
EXIT_FAILURE
);

507 
√w_node
->
poöãrs
 = 
	`mÆloc
–
‹dî
 * (*) );

508 i‡(
√w_node
->
poöãrs
 =
NULL
) {

509 
	`≥º‹
("NewÇodeÖointersárray.");

510 
	`exô
(
EXIT_FAILURE
);

512 
√w_node
->
is_Àaf
 = 
Ál£
;

513 
√w_node
->
num_keys
 = 0;

514 
√w_node
->
∑ª¡
 = 
NULL
;

515 
√w_node
->
√xt
 = 
NULL
;

516  
√w_node
;

517 
	}
}

522 
node
 * 
	$make_Àaf
( ) {

523 
node
 * 
Àaf
 = 
	`make_node
();

524 
Àaf
->
is_Àaf
 = 
åue
;

525  
Àaf
;

526 
	}
}

533 
	$gë_À·_ödex
(
node
 * 
∑ª¡
,Çodê* 
À·
) {

535 
À·_ödex
 = 0;

536 
À·_ödex
 <
∑ª¡
->
num_keys
 &&

537 
∑ª¡
->
poöãrs
[
À·_ödex
] !
À·
)

538 
À·_ödex
++;

539  
À·_ödex
;

540 
	}
}

546 
node
 * 
	$ö£π_öto_Àaf
–
node
 * 
Àaf
, 
key
, 
ªc‹d
 * 
poöãr
 ) {

548 
i
, 
ö£πi⁄_poöt
;

550 
ö£πi⁄_poöt
 = 0;

551 
ö£πi⁄_poöt
 < 
Àaf
->
num_keys
 &&Üóf->
keys
[ö£πi⁄_poöt] < 
key
)

552 
ö£πi⁄_poöt
++;

554 
i
 = 
Àaf
->
num_keys
; i > 
ö£πi⁄_poöt
; i--) {

555 
Àaf
->
keys
[
i
] =Üeaf->keys[i - 1];

556 
Àaf
->
poöãrs
[
i
] =Üeaf->pointers[i - 1];

558 
Àaf
->
keys
[
ö£πi⁄_poöt
] = 
key
;

559 
Àaf
->
poöãrs
[
ö£πi⁄_poöt
] = 
poöãr
;

560 
Àaf
->
num_keys
++;

561  
Àaf
;

562 
	}
}

570 
node
 * 
	$ö£π_öto_Àaf_a·î_•lôtög
(
node
 * 
roŸ
,Çodê* 
Àaf
, 
key
, 
ªc‹d
 * 
poöãr
) {

572 
node
 * 
√w_Àaf
;

573 * 
ãmp_keys
;

574 ** 
ãmp_poöãrs
;

575 
ö£πi⁄_ödex
, 
•lô
, 
√w_key
, 
i
, 
j
;

577 
√w_Àaf
 = 
	`make_Àaf
();

579 
ãmp_keys
 = 
	`mÆloc
–
‹dî
 * () );

580 i‡(
ãmp_keys
 =
NULL
) {

581 
	`≥º‹
("Temporary keysárray.");

582 
	`exô
(
EXIT_FAILURE
);

585 
ãmp_poöãrs
 = 
	`mÆloc
–
‹dî
 * (*) );

586 i‡(
ãmp_poöãrs
 =
NULL
) {

587 
	`≥º‹
("TemporaryÖointersárray.");

588 
	`exô
(
EXIT_FAILURE
);

591 
ö£πi⁄_ödex
 = 0;

592 
ö£πi⁄_ödex
 < 
‹dî
 - 1 && 
Àaf
->
keys
[ö£πi⁄_ödex] < 
key
)

593 
ö£πi⁄_ödex
++;

595 
i
 = 0, 
j
 = 0; i < 
Àaf
->
num_keys
; i++, j++) {

596 i‡(
j
 =
ö£πi⁄_ödex
) j++;

597 
ãmp_keys
[
j
] = 
Àaf
->
keys
[
i
];

598 
ãmp_poöãrs
[
j
] = 
Àaf
->
poöãrs
[
i
];

601 
ãmp_keys
[
ö£πi⁄_ödex
] = 
key
;

602 
ãmp_poöãrs
[
ö£πi⁄_ödex
] = 
poöãr
;

604 
Àaf
->
num_keys
 = 0;

606 
•lô
 = 
	`cut
(
‹dî
 - 1);

608 
i
 = 0; i < 
•lô
; i++) {

609 
Àaf
->
poöãrs
[
i
] = 
ãmp_poöãrs
[i];

610 
Àaf
->
keys
[
i
] = 
ãmp_keys
[i];

611 
Àaf
->
num_keys
++;

614 
i
 = 
•lô
, 
j
 = 0; i < 
‹dî
; i++, j++) {

615 
√w_Àaf
->
poöãrs
[
j
] = 
ãmp_poöãrs
[
i
];

616 
√w_Àaf
->
keys
[
j
] = 
ãmp_keys
[
i
];

617 
√w_Àaf
->
num_keys
++;

620 
	`‰ì
(
ãmp_poöãrs
);

621 
	`‰ì
(
ãmp_keys
);

623 
√w_Àaf
->
poöãrs
[
‹dî
 - 1] = 
Àaf
->pointers[order - 1];

624 
Àaf
->
poöãrs
[
‹dî
 - 1] = 
√w_Àaf
;

626 
i
 = 
Àaf
->
num_keys
; i < 
‹dî
 - 1; i++)

627 
Àaf
->
poöãrs
[
i
] = 
NULL
;

628 
i
 = 
√w_Àaf
->
num_keys
; i < 
‹dî
 - 1; i++)

629 
√w_Àaf
->
poöãrs
[
i
] = 
NULL
;

631 
√w_Àaf
->
∑ª¡
 = 
Àaf
->parent;

632 
√w_key
 = 
√w_Àaf
->
keys
[0];

634  
	`ö£π_öto_∑ª¡
(
roŸ
, 
Àaf
, 
√w_key
, 
√w_Àaf
);

635 
	}
}

642 
node
 * 
	$ö£π_öto_node
(
node
 * 
roŸ
,Çodê* 
n
,

643 
À·_ödex
, 
key
, 
node
 * 
right
) {

644 
i
;

646 
i
 = 
n
->
num_keys
; i > 
À·_ödex
; i--) {

647 
n
->
poöãrs
[
i
 + 1] =Ç->pointers[i];

648 
n
->
keys
[
i
] =Ç->keys[i - 1];

650 
n
->
poöãrs
[
À·_ödex
 + 1] = 
right
;

651 
n
->
keys
[
À·_ödex
] = 
key
;

652 
n
->
num_keys
++;

653  
roŸ
;

654 
	}
}

661 
node
 * 
	$ö£π_öto_node_a·î_•lôtög
(
node
 * 
roŸ
,Çodê* 
ﬁd_node
, 
À·_ödex
,

662 
key
, 
node
 * 
right
) {

664 
i
, 
j
, 
•lô
, 
k_¥ime
;

665 
node
 * 
√w_node
, * 
chûd
;

666 * 
ãmp_keys
;

667 
node
 ** 
ãmp_poöãrs
;

678 
ãmp_poöãrs
 = 
	`mÆloc
–(
‹dî
 + 1Ë* (
node
 *) );

679 i‡(
ãmp_poöãrs
 =
NULL
) {

680 
	`≥º‹
("TemporaryÖointersárray for splittingÇodes.");

681 
	`exô
(
EXIT_FAILURE
);

683 
ãmp_keys
 = 
	`mÆloc
–
‹dî
 * () );

684 i‡(
ãmp_keys
 =
NULL
) {

685 
	`≥º‹
("Temporary keysárray for splittingÇodes.");

686 
	`exô
(
EXIT_FAILURE
);

689 
i
 = 0, 
j
 = 0; i < 
ﬁd_node
->
num_keys
 + 1; i++, j++) {

690 i‡(
j
 =
À·_ödex
 + 1) j++;

691 
ãmp_poöãrs
[
j
] = 
ﬁd_node
->
poöãrs
[
i
];

694 
i
 = 0, 
j
 = 0; i < 
ﬁd_node
->
num_keys
; i++, j++) {

695 i‡(
j
 =
À·_ödex
) j++;

696 
ãmp_keys
[
j
] = 
ﬁd_node
->
keys
[
i
];

699 
ãmp_poöãrs
[
À·_ödex
 + 1] = 
right
;

700 
ãmp_keys
[
À·_ödex
] = 
key
;

706 
•lô
 = 
	`cut
(
‹dî
);

707 
√w_node
 = 
	`make_node
();

708 
ﬁd_node
->
num_keys
 = 0;

709 
i
 = 0; i < 
•lô
 - 1; i++) {

710 
ﬁd_node
->
poöãrs
[
i
] = 
ãmp_poöãrs
[i];

711 
ﬁd_node
->
keys
[
i
] = 
ãmp_keys
[i];

712 
ﬁd_node
->
num_keys
++;

714 
ﬁd_node
->
poöãrs
[
i
] = 
ãmp_poöãrs
[i];

715 
k_¥ime
 = 
ãmp_keys
[
•lô
 - 1];

716 ++
i
, 
j
 = 0; i < 
‹dî
; i++, j++) {

717 
√w_node
->
poöãrs
[
j
] = 
ãmp_poöãrs
[
i
];

718 
√w_node
->
keys
[
j
] = 
ãmp_keys
[
i
];

719 
√w_node
->
num_keys
++;

721 
√w_node
->
poöãrs
[
j
] = 
ãmp_poöãrs
[
i
];

722 
	`‰ì
(
ãmp_poöãrs
);

723 
	`‰ì
(
ãmp_keys
);

724 
√w_node
->
∑ª¡
 = 
ﬁd_node
->parent;

725 
i
 = 0; i <
√w_node
->
num_keys
; i++) {

726 
chûd
 = 
√w_node
->
poöãrs
[
i
];

727 
chûd
->
∑ª¡
 = 
√w_node
;

735  
	`ö£π_öto_∑ª¡
(
roŸ
, 
ﬁd_node
, 
k_¥ime
, 
√w_node
);

736 
	}
}

743 
node
 * 
	$ö£π_öto_∑ª¡
(
node
 * 
roŸ
,Çodê* 
À·
, 
key
,Çodê* 
right
) {

745 
À·_ödex
;

746 
node
 * 
∑ª¡
;

748 
∑ª¡
 = 
À·
->parent;

752 i‡(
∑ª¡
 =
NULL
)

753  
	`ö£π_öto_√w_roŸ
(
À·
, 
key
, 
right
);

763 
À·_ödex
 = 
	`gë_À·_ödex
(
∑ª¡
, 
À·
);

769 i‡(
∑ª¡
->
num_keys
 < 
‹dî
 - 1)

770  
	`ö£π_öto_node
(
roŸ
, 
∑ª¡
, 
À·_ödex
, 
key
, 
right
);

776  
	`ö£π_öto_node_a·î_•lôtög
(
roŸ
, 
∑ª¡
, 
À·_ödex
, 
key
, 
right
);

777 
	}
}

784 
node
 * 
	$ö£π_öto_√w_roŸ
(
node
 * 
À·
, 
key
,Çodê* 
right
) {

786 
node
 * 
roŸ
 = 
	`make_node
();

787 
roŸ
->
keys
[0] = 
key
;

788 
roŸ
->
poöãrs
[0] = 
À·
;

789 
roŸ
->
poöãrs
[1] = 
right
;

790 
roŸ
->
num_keys
++;

791 
roŸ
->
∑ª¡
 = 
NULL
;

792 
À·
->
∑ª¡
 = 
roŸ
;

793 
right
->
∑ª¡
 = 
roŸ
;

794  
roŸ
;

795 
	}
}

802 
node
 * 
	$°¨t_√w_åì
(
key
, 
ªc‹d
 * 
poöãr
) {

804 
node
 * 
roŸ
 = 
	`make_Àaf
();

805 
roŸ
->
keys
[0] = 
key
;

806 
roŸ
->
poöãrs
[0] = 
poöãr
;

807 
roŸ
->
poöãrs
[
‹dî
 - 1] = 
NULL
;

808 
roŸ
->
∑ª¡
 = 
NULL
;

809 
roŸ
->
num_keys
++;

810  
roŸ
;

811 
	}
}

821 
node
 * 
	$ö£π_åì
–
node
 * 
roŸ
, 
key
, 
vÆue
 ) {

823 
ªc‹d
 * 
poöãr
;

824 
node
 * 
Àaf
;

830 i‡(
	`föd_åì
(
roŸ
, 
key
, 
Ál£
Ë!
NULL
)

831  
roŸ
;

836 
poöãr
 = 
	`make_ªc‹d
(
vÆue
);

843 i‡(
roŸ
 =
NULL
)

844  
	`°¨t_√w_åì
(
key
, 
poöãr
);

851 
Àaf
 = 
	`föd_Àaf
(
roŸ
, 
key
, 
Ál£
);

856 i‡(
Àaf
->
num_keys
 < 
‹dî
 - 1) {

857 
Àaf
 = 
	`ö£π_öto_Àaf
÷óf, 
key
, 
poöãr
);

858  
roŸ
;

865  
	`ö£π_öto_Àaf_a·î_•lôtög
(
roŸ
, 
Àaf
, 
key
, 
poöãr
);

866 
	}
}

879 
	$gë_√ighb‹_ödex
–
node
 * 
n
 ) {

881 
i
;

889 
i
 = 0; i <
n
->
∑ª¡
->
num_keys
; i++)

890 i‡(
n
->
∑ª¡
->
poöãrs
[
i
] ==Ç)

891  
i
 - 1;

894 
	`¥ötf
("Search forÇonexistentÖointerÅoÇode inÖarent.\n");

895 
	`¥ötf
("Node: %#lx\n", ()
n
);

896 
	`exô
(
EXIT_FAILURE
);

897 
	}
}

900 
node
 * 
	$ªmove_íåy_‰om_node
(
node
 * 
n
, 
key
,Çodê* 
poöãr
) {

902 
i
, 
num_poöãrs
;

905 
i
 = 0;

906 
n
->
keys
[
i
] !
key
)

907 
i
++;

908 ++
i
; i < 
n
->
num_keys
; i++)

909 
n
->
keys
[
i
 - 1] =Ç->keys[i];

913 
num_poöãrs
 = 
n
->
is_Àaf
 ?Ç->
num_keys
 :Ç->num_keys + 1;

914 
i
 = 0;

915 
n
->
poöãrs
[
i
] !
poöãr
)

916 
i
++;

917 ++
i
; i < 
num_poöãrs
; i++)

918 
n
->
poöãrs
[
i
 - 1] =Ç->pointers[i];

922 
n
->
num_keys
--;

926 i‡(
n
->
is_Àaf
)

927 
i
 = 
n
->
num_keys
; i < 
‹dî
 - 1; i++)

928 
n
->
poöãrs
[
i
] = 
NULL
;

930 
i
 = 
n
->
num_keys
 + 1; i < 
‹dî
; i++)

931 
n
->
poöãrs
[
i
] = 
NULL
;

933  
n
;

934 
	}
}

937 
node
 * 
	$adju°_roŸ
(
node
 * 
roŸ
) {

939 
node
 * 
√w_roŸ
;

946 i‡(
roŸ
->
num_keys
 > 0)

947  
roŸ
;

956 i‡(!
roŸ
->
is_Àaf
) {

957 
√w_roŸ
 = 
roŸ
->
poöãrs
[0];

958 
√w_roŸ
->
∑ª¡
 = 
NULL
;

965 
√w_roŸ
 = 
NULL
;

967 
	`‰ì
(
roŸ
->
keys
);

968 
	`‰ì
(
roŸ
->
poöãrs
);

969 
	`‰ì
(
roŸ
);

971  
√w_roŸ
;

972 
	}
}

981 
node
 * 
	$cﬂÀs˚_nodes
(
node
 * 
roŸ
,Çodê* 
n
,Çodê* 
√ighb‹
, 
√ighb‹_ödex
, 
k_¥ime
) {

983 
i
, 
j
, 
√ighb‹_ö£πi⁄_ödex
, 
n_íd
;

984 
node
 * 
tmp
;

990 i‡(
√ighb‹_ödex
 == -1) {

991 
tmp
 = 
n
;

992 
n
 = 
√ighb‹
;

993 
√ighb‹
 = 
tmp
;

1002 
√ighb‹_ö£πi⁄_ödex
 = 
√ighb‹
->
num_keys
;

1009 i‡(!
n
->
is_Àaf
) {

1014 
√ighb‹
->
keys
[
√ighb‹_ö£πi⁄_ödex
] = 
k_¥ime
;

1015 
√ighb‹
->
num_keys
++;

1018 
n_íd
 = 
n
->
num_keys
;

1020 
i
 = 
√ighb‹_ö£πi⁄_ödex
 + 1, 
j
 = 0; j < 
n_íd
; i++, j++) {

1021 
√ighb‹
->
keys
[
i
] = 
n
->keys[
j
];

1022 
√ighb‹
->
poöãrs
[
i
] = 
n
->poöãrs[
j
];

1023 
√ighb‹
->
num_keys
++;

1024 
n
->
num_keys
--;

1031 
√ighb‹
->
poöãrs
[
i
] = 
n
->poöãrs[
j
];

1036 
i
 = 0; i < 
√ighb‹
->
num_keys
 + 1; i++) {

1037 
tmp
 = (
node
 *)
√ighb‹
->
poöãrs
[
i
];

1038 
tmp
->
∑ª¡
 = 
√ighb‹
;

1049 
i
 = 
√ighb‹_ö£πi⁄_ödex
, 
j
 = 0; j < 
n
->
num_keys
; i++, j++) {

1050 
√ighb‹
->
keys
[
i
] = 
n
->keys[
j
];

1051 
√ighb‹
->
poöãrs
[
i
] = 
n
->poöãrs[
j
];

1052 
√ighb‹
->
num_keys
++;

1054 
√ighb‹
->
poöãrs
[
‹dî
 - 1] = 
n
->pointers[order - 1];

1057 
roŸ
 = 
	`dñëe_íåy
‘oŸ, 
n
->
∑ª¡
, 
k_¥ime
,Ç);

1058 
	`‰ì
(
n
->
keys
);

1059 
	`‰ì
(
n
->
poöãrs
);

1060 
	`‰ì
(
n
);

1061  
roŸ
;

1062 
	}
}

1071 
node
 * 
	$ªdi°ribuã_nodes
(
node
 * 
roŸ
,Çodê* 
n
,Çodê* 
√ighb‹
, 
√ighb‹_ödex
,

1072 
k_¥ime_ödex
, 
k_¥ime
) {

1074 
i
;

1075 
node
 * 
tmp
;

1082 i‡(
√ighb‹_ödex
 != -1) {

1083 i‡(!
n
->
is_Àaf
)

1084 
n
->
poöãrs
[n->
num_keys
 + 1] =Ç->pointers[n->num_keys];

1085 
i
 = 
n
->
num_keys
; i > 0; i--) {

1086 
n
->
keys
[
i
] =Ç->keys[i - 1];

1087 
n
->
poöãrs
[
i
] =Ç->pointers[i - 1];

1089 i‡(!
n
->
is_Àaf
) {

1090 
n
->
poöãrs
[0] = 
√ighb‹
->poöãrs[√ighb‹->
num_keys
];

1091 
tmp
 = (
node
 *)
n
->
poöãrs
[0];

1092 
tmp
->
∑ª¡
 = 
n
;

1093 
√ighb‹
->
poöãrs
[√ighb‹->
num_keys
] = 
NULL
;

1094 
n
->
keys
[0] = 
k_¥ime
;

1095 
n
->
∑ª¡
->
keys
[
k_¥ime_ödex
] = 
√ighb‹
->keys[√ighb‹->
num_keys
 - 1];

1098 
n
->
poöãrs
[0] = 
√ighb‹
->poöãrs[√ighb‹->
num_keys
 - 1];

1099 
√ighb‹
->
poöãrs
[√ighb‹->
num_keys
 - 1] = 
NULL
;

1100 
n
->
keys
[0] = 
√ighb‹
->keys[√ighb‹->
num_keys
 - 1];

1101 
n
->
∑ª¡
->
keys
[
k_¥ime_ödex
] =Ç->keys[0];

1112 i‡(
n
->
is_Àaf
) {

1113 
n
->
keys
[n->
num_keys
] = 
√ighb‹
->keys[0];

1114 
n
->
poöãrs
[n->
num_keys
] = 
√ighb‹
->pointers[0];

1115 
n
->
∑ª¡
->
keys
[
k_¥ime_ödex
] = 
√ighb‹
->keys[1];

1118 
n
->
keys
[n->
num_keys
] = 
k_¥ime
;

1119 
n
->
poöãrs
[n->
num_keys
 + 1] = 
√ighb‹
->pointers[0];

1120 
tmp
 = (
node
 *)
n
->
poöãrs
[n->
num_keys
 + 1];

1121 
tmp
->
∑ª¡
 = 
n
;

1122 
n
->
∑ª¡
->
keys
[
k_¥ime_ödex
] = 
√ighb‹
->keys[0];

1124 
i
 = 0; i < 
√ighb‹
->
num_keys
 - 1; i++) {

1125 
√ighb‹
->
keys
[
i
] =Çeighbor->keys[i + 1];

1126 
√ighb‹
->
poöãrs
[
i
] =Çeighbor->pointers[i + 1];

1128 i‡(!
n
->
is_Àaf
)

1129 
√ighb‹
->
poöãrs
[
i
] =Çeighbor->pointers[i + 1];

1136 
n
->
num_keys
++;

1137 
√ighb‹
->
num_keys
--;

1139  
roŸ
;

1140 
	}
}

1148 
node
 * 
	$dñëe_íåy
–
node
 * 
roŸ
,Çodê* 
n
, 
key
, * 
poöãr
 ) {

1150 
mö_keys
;

1151 
node
 * 
√ighb‹
;

1152 
√ighb‹_ödex
;

1153 
k_¥ime_ödex
, 
k_¥ime
;

1154 
ˇ∑côy
;

1158 
n
 = 
	`ªmove_íåy_‰om_node
“, 
key
, 
poöãr
);

1163 i‡(
n
 =
roŸ
)

1164  
	`adju°_roŸ
(
roŸ
);

1175 
mö_keys
 = 
n
->
is_Àaf
 ? 
	`cut
(
‹dî
 - 1) : cut(order) - 1;

1181 i‡(
n
->
num_keys
 >
mö_keys
)

1182  
roŸ
;

1196 
√ighb‹_ödex
 = 
	`gë_√ighb‹_ödex
–
n
 );

1197 
k_¥ime_ödex
 = 
√ighb‹_ödex
 == -1 ? 0 :Çeighbor_index;

1198 
k_¥ime
 = 
n
->
∑ª¡
->
keys
[
k_¥ime_ödex
];

1199 
√ighb‹
 = 
√ighb‹_ödex
 =-1 ? 
n
->
∑ª¡
->
poöãrs
[1] :

1200 
n
->
∑ª¡
->
poöãrs
[
√ighb‹_ödex
];

1202 
ˇ∑côy
 = 
n
->
is_Àaf
 ? 
‹dî
 : order - 1;

1206 i‡(
√ighb‹
->
num_keys
 + 
n
->num_key†< 
ˇ∑côy
)

1207  
	`cﬂÀs˚_nodes
(
roŸ
, 
n
, 
√ighb‹
, 
√ighb‹_ödex
, 
k_¥ime
);

1212  
	`ªdi°ribuã_nodes
(
roŸ
, 
n
, 
√ighb‹
, 
√ighb‹_ödex
, 
k_¥ime_ödex
, 
k_¥ime
);

1213 
	}
}

1219 
node
 * 
	$dñëe_åì
(
node
 * 
roŸ
, 
key
) {

1221 
node
 * 
key_Àaf
;

1222 
ªc‹d
 * 
key_ªc‹d
;

1224 
key_ªc‹d
 = 
	`föd_åì
(
roŸ
, 
key
, 
Ál£
);

1225 
key_Àaf
 = 
	`föd_Àaf
(
roŸ
, 
key
, 
Ál£
);

1226 i‡(
key_ªc‹d
 !
NULL
 && 
key_Àaf
 != NULL) {

1227 
roŸ
 = 
	`dñëe_íåy
‘oŸ, 
key_Àaf
, 
key
, 
key_ªc‹d
);

1228 
	`‰ì
(
key_ªc‹d
);

1230  
roŸ
;

1231 
	}
}

1234 
	$de°roy_åì_nodes
(
node
 * 
roŸ
) {

1235 
i
;

1236 i‡(
roŸ
->
is_Àaf
)

1237 
i
 = 0; i < 
roŸ
->
num_keys
; i++)

1238 
	`‰ì
(
roŸ
->
poöãrs
[
i
]);

1240 
i
 = 0; i < 
roŸ
->
num_keys
 + 1; i++)

1241 
	`de°roy_åì_nodes
(
roŸ
->
poöãrs
[
i
]);

1242 
	`‰ì
(
roŸ
->
poöãrs
);

1243 
	`‰ì
(
roŸ
->
keys
);

1244 
	`‰ì
(
roŸ
);

1245 
	}
}

1248 
node
 * 
	$de°roy_åì
(
node
 * 
roŸ
) {

1249 
	`de°roy_åì_nodes
(
roŸ
);

1250  
NULL
;

1251 
	}
}

1254 
	$öô_∑ge_li°
(){

1255 
hód
 = (
∑ge_li°
 *)
	`mÆloc
((page_list));

1256 
∑ge_li°
 *
√w
 = (∑ge_li° *)
	`mÆloc
((page_list));

1259 
hód
->
off£t
 = 4096;

1260 
hód
->
is_‰ì
 = 
åue
;

1261 
hód
->
√xt
 = 
√w
;

1262 
√w
->
off£t
 = 0;

1263 
√w
->
is_‰ì
 = 
Ál£
;

1264 
√w
->
√xt
 = 
NULL
;

1265 
	}
}

1269 
öt64_t
 
	$sˇn_‰ì_∑ge
(){

1270 
öt64_t
 
œ°_off£t
;

1271 
öt64_t
 
√xt_Â_off£t
 = 0;

1272 
∑ge_li°
 *
poöãr
;

1273 
∑ge_li°
 *
√w
;

1275 
poöãr
 = 
hód
;Öoöãr->
off£t
 !0 &&Öoöãr->
√xt
 !
NULL
;Öointer =Öointer->next){

1276 if(
poöãr
->
is_‰ì
 =
åue
){

1277  
poöãr
->
off£t
;

1279 
œ°_off£t
 = 
poöãr
->
off£t
;

1283 
poöãr
->
off£t
 = 
œ°_off£t
 + 4096;

1284 
poöãr
->
is_‰ì
 = 
åue
;

1285 
√w
 = (
∑ge_li°
 *)
	`mÆloc
((page_list));

1286 
√w
->
off£t
 = 0;

1287 
√w
->
is_‰ì
 = 
Ál£
;

1288 
poöãr
->
√xt
 = 
√w
;

1289 
√w
->
√xt
 = 
NULL
;

1292 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
poöãr
->
off£t
, 
SEEK_SET
);

1293 
	`fwrôe
(&
√xt_Â_off£t
, 8, 1, 
Â
);

1295  
poöãr
->
off£t
;

1296 
	}
}

1300 
öt64_t
 
	$sˇn_u£_∑ge
(){

1301 
öt64_t
 
cou¡
 = 0;

1302 
∑ge_li°
 *
poöãr
;

1304 
poöãr
 = 
hód
;Öoöãr->
off£t
 !0 &&Öoöãr->
√xt
 !
NULL
;Öointer =Öointer->next){

1305 if(
poöãr
->
is_‰ì
 =
Ál£
){

1306 
cou¡
++;

1310  
cou¡
;

1311 
	}
}

1317 
	$ch™ge_‰ì_∑ge
(
öt64_t
 
off£t
){

1318 
∑ge_li°
 *
poöãr
;

1320 
poöãr
 = 
hód
;Öoöãr->
off£t
 !0 &&Öoöãr->
√xt
 !
NULL
;Öointer =Öointer->next){

1321 if(
poöãr
->
off£t
 == offset){

1322 
poöãr
->
is_‰ì
 = 
Ál£
;

1325 
	}
}

1330 
	$vacuum_usög_∑ge
(
öt64_t
 
off£t
){

1331 
∑ge_li°
 *
poöãr
;

1334 
poöãr
 = 
hód
;Öoöãr->
off£t
 !0 &&Öoöãr->
√xt
 !
NULL
;Öointer =Öointer->next){

1335 if(
poöãr
->
off£t
 == offset){

1336 
poöãr
->
is_‰ì
 = 
åue
;

1339 
	}
}

1346 
	$öô_hódî_∑ge
(){

1347 
öt64_t
 
Â_off£t
 = 4096;

1349 
öt64_t
 
Ω_off£t
 = 0;

1350 
öt64_t
 
≤um
 = 1;

1356 
	`f£eko
(
Â
, 
deÁu…_off£t
, 
SEEK_SET
);

1357 
	`fwrôe
(&
Â_off£t
, 8, 1, 
Â
);

1358 
	`fwrôe
(&
Ω_off£t
, 8, 1, 
Â
);

1359 
	`fwrôe
(&
≤um
, 8, 1, 
Â
);

1360 
	}
}

1361 
	$modify_hódî_∑ge
(
öt64_t
 
Ω_off£t
){

1362 
öt64_t
 
Â_off£t
 = 
	`sˇn_‰ì_∑ge
();

1363 
öt64_t
 
≤um
 = 
	`sˇn_u£_∑ge
() + 1;

1366 
	`f£eko
(
Â
, 
deÁu…_off£t
, 
SEEK_SET
);

1367 
	`fwrôe
(&
Â_off£t
, 8, 1, 
Â
);

1368 
	`fwrôe
(&
Ω_off£t
, 8, 1, 
Â
);

1369 
	`fwrôe
(&
≤um
, 8, 1, 
Â
);

1370 
	}
}

1378 
	$›í_db
(*
∑th«me
){

1379 
Â
 = 
	`f›í
(
∑th«me
, "wb+");

1380 if(
Â
 =
NULL
){

1381 
	`Ârötf
(
°dîr
, "Error : fileÖath\n");

1382 
	`exô
(
EXIT_FAILURE
);

1386 
	`f£eko
(
Â
, 0, 
SEEK_END
);

1387 
deÁu…_off£t
 = 
	`·ñlo
(
Â
);

1390 
	`öô_∑ge_li°
();

1393 
	`öô_hódî_∑ge
();

1396 
	`fÊush
(
Â
);

1399 
	}
}

1402 
öt64_t
 
	$öô_Àaf_∑ge
(
öt64_t
 
off£t
){

1403 
öt64_t
 
p_off£t
 = 0;

1404 
öt64_t
 
rs_off£t
 = 0;

1405 
is_Àaf
 = 1;

1406 
num_keys
 = 0;

1408 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
, 
SEEK_SET
);

1410 
	`fwrôe
(&
p_off£t
, 8, 1, 
Â
);

1412 
	`fwrôe
(&
is_Àaf
, 4, 1, 
Â
);

1414 
	`fwrôe
(&
num_keys
, 4, 1, 
Â
);

1417 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 120, 
SEEK_SET
);

1419 
	`fwrôe
(&
rs_off£t
, 8, 1, 
Â
);

1421  
off£t
;

1422 
	}
}

1423 
öt64_t
 
	$öô_öã∫Æ_∑ge
(
öt64_t
 
off£t
, i¡64_à
p_off£t
){

1425 
is_Àaf
 = 0, 
num_keys
 = 0;

1427 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
, 
SEEK_SET
);

1429 
	`fwrôe
(&
p_off£t
, 8, 1, 
Â
);

1431 
	`fwrôe
(&
is_Àaf
, 4, 1, 
Â
);

1433 
	`fwrôe
(&
num_keys
, 4, 1, 
Â
);

1435  
off£t
;

1436 
	}
}

1437 
	$gë_À·_off£t
(
öt64_t
 
p_off£t
, i¡64_à
l_off£t
){

1438 
öt64_t
 
À·_off£t
 = 0, 
èrgë_off£t
;

1439 
num_keys
;

1442 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
p_off£t
 + 12, 
SEEK_SET
);

1443 
	`‰ód
(&
num_keys
, 4, 1, 
Â
);

1445 
À·_off£t
 <
num_keys
){

1447 if(
À·_off£t
 == 0)

1448 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
p_off£t
 + 120, 
SEEK_SET
);

1450 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
p_off£t
 + 128 + (
À·_off£t
-1)*16 + 8, 
SEEK_SET
);

1451 
	`‰ód
(&
èrgë_off£t
, 8, 1, 
Â
);

1453 if(
l_off£t
 =
èrgë_off£t
){

1456 
À·_off£t
++;

1459  
À·_off£t
;

1460 
	}
}

1461 
öt64_t
 
	$ö£π_öto_Àaf_∑ge
(
öt64_t
 
Àaf_off£t
, i¡64_à
key
, *
vÆue
){

1462 
i
, 
ö£πi⁄_poöt
, 
num_keys
;

1463 
öt64_t
 
èrgë_key
, 
ãmp_key
;

1464 
ãmp_vÆue
[120];

1467 
ö£πi⁄_poöt
 = 0;

1470 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
Àaf_off£t
 + 12, 
SEEK_SET
);

1471 
	`‰ód
(&
num_keys
, 4, 1, 
Â
);

1473 
ö£πi⁄_poöt
 < 
num_keys
){

1475 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
Àaf_off£t
 + 128 + 
ö£πi⁄_poöt
*128, 
SEEK_SET
);

1476 
	`‰ód
(&
èrgë_key
, 8, 1, 
Â
);

1477 if(
key
 <
èrgë_key
){

1480 
ö£πi⁄_poöt
++;

1484 
i
 = 
num_keys
; i > 
ö£πi⁄_poöt
; i--){

1485 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
Àaf_off£t
 + 128 + (
i
-1)*128, 
SEEK_SET
);

1486 
	`‰ód
(&
ãmp_key
, 8, 1, 
Â
);

1487 
	`‰ód
(&
ãmp_vÆue
, 1, 120, 
Â
);

1489 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
Àaf_off£t
 + 128 + (
i
)*128, 
SEEK_SET
);

1490 
	`fwrôe
(&
ãmp_key
, 8, 1, 
Â
);

1491 
	`fwrôe
(&
ãmp_vÆue
, 1, 120, 
Â
);

1495 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
Àaf_off£t
 + 128 + 
ö£πi⁄_poöt
*128, 
SEEK_SET
);

1496 
	`fwrôe
(&
key
, 8, 1, 
Â
);

1497 
	`fwrôe
(
vÆue
, 1, 120, 
Â
);

1500 
num_keys
++;

1501 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
Àaf_off£t
 + 12, 
SEEK_SET
);

1502 
	`fwrôe
(&
num_keys
, 4, 1, 
Â
);

1504  
Àaf_off£t
;

1505 
	}
}

1506 
öt64_t
 
	$ö£π_öto_Àaf_∑ge_a·î_•lôtög
(
öt64_t
 
Ω_off£t
, i¡64_à
Àaf_off£t
, i¡64_à
key
, *
vÆue
){

1507 
öt64_t
 
√w_Àaf_off£t
, *
ãmp_keys
, 
èrgë_key
, 
√w_key
, 
ãmp_off£t
 = 0, 
p_off£t
;

1508 
ö£πi⁄_ödex
, 
•lô
, 
i
, 
j
, 
num_keys
, 
√w_num_keys
 = 0,
zîo
 = 0;

1509 **
ãmp_vÆues
;

1510 
zîo_v
[120];

1513 
i
 = 0; i < 120; i++){

1514 
zîo_v
[
i
] = 0;

1518 
√w_Àaf_off£t
 = 
	`öô_Àaf_∑ge
(
	`sˇn_‰ì_∑ge
());

1521 
	`ch™ge_‰ì_∑ge
(
√w_Àaf_off£t
);

1522 
	`modify_hódî_∑ge
(
Ω_off£t
);

1525 
ãmp_keys
 = (
öt64_t
 *)
	`mÆloc
(
Àaf_‹dî
 * (int64_t));

1526 
ãmp_vÆues
 =(**)
	`mÆloc
(
Àaf_‹dî
 * (*));

1528 
i
 = 0; i < 
Àaf_‹dî
; i++){

1529 
ãmp_vÆues
[
i
] = (*)
	`mÆloc
(() * 120);

1532 
ö£πi⁄_ödex
 = 0;

1535 
ö£πi⁄_ödex
 < 
Àaf_‹dî
 -1){

1537 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
Àaf_off£t
 + 128 + 128*
ö£πi⁄_ödex
, 
SEEK_SET
);

1538 
	`‰ód
(&
èrgë_key
, 8, 1, 
Â
);

1539 if(
èrgë_key
 >
key
){

1542 
ö£πi⁄_ödex
++;

1547 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
Àaf_off£t
 + 12, 
SEEK_SET
);

1548 
	`‰ód
(&
num_keys
, 4, 1, 
Â
);

1549 
i
 = 0, 
j
 = 0; i < 
num_keys
; i++, j++){

1550 if(
j
 =
ö£πi⁄_ödex
)

1551 
j
++;

1552 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
Àaf_off£t
 + 128 + 128*
i
, 
SEEK_SET
);

1553 
	`‰ód
((
ãmp_keys
+
j
), 8, 1, 
Â
);

1554 
	`‰ód
(*(
ãmp_vÆues
+
j
), 1, 120, 
Â
);

1557 
ãmp_keys
[
ö£πi⁄_ödex
] = 
key
;

1558 
	`memmove
(
ãmp_vÆues
[
ö£πi⁄_ödex
], 
vÆue
, 120);

1561 
num_keys
 = 0;

1562 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
Àaf_off£t
 + 12, 
SEEK_SET
);

1563 
	`fwrôe
(&
num_keys
, 4, 1, 
Â
);

1565 
•lô
 = 
	`cut
(
Àaf_‹dî
 - 1);

1568 
i
 = 0; i < 
•lô
; i++){

1569 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
Àaf_off£t
 + 128 + 128*
i
, 
SEEK_SET
);

1570 
	`fwrôe
((
ãmp_keys
+
i
), 8, 1, 
Â
);

1571 
	`fwrôe
(*(
ãmp_vÆues
+
i
), 1, 120, 
Â
);

1572 
num_keys
++;

1575 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
Àaf_off£t
 + 12, 
SEEK_SET
);

1576 
	`fwrôe
(&
num_keys
, 4, 1, 
Â
);

1578 
i
 = 
•lô
, 
j
 = 0; i < 
Àaf_‹dî
; i++, j++){

1579 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√w_Àaf_off£t
 + 128 + 128*
j
, 
SEEK_SET
);

1580 
	`fwrôe
((
ãmp_keys
+
i
), 8, 1, 
Â
);

1581 
	`fwrôe
(*(
ãmp_vÆues
+
i
), 1, 120, 
Â
);

1582 
√w_num_keys
++;

1585 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√w_Àaf_off£t
 + 12, 
SEEK_SET
);

1586 
	`fwrôe
(&
√w_num_keys
, 4, 1, 
Â
);

1589 
	`‰ì
(
ãmp_keys
);

1590 
i
 = 0; i < 
Àaf_‹dî
; i++){

1591 
	`‰ì
(
ãmp_vÆues
[
i
]);

1593 
	`‰ì
(
ãmp_vÆues
);

1597 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
Àaf_off£t
 + 120, 
SEEK_SET
);

1598 
	`‰ód
(&
ãmp_off£t
, 8, 1, 
Â
);

1600 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√w_Àaf_off£t
 + 120, 
SEEK_SET
);

1601 
	`fwrôe
(&
ãmp_off£t
, 8, 1, 
Â
);

1603 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
Àaf_off£t
 + 120, 
SEEK_SET
);

1604 
	`fwrôe
(&
√w_Àaf_off£t
, 8, 1, 
Â
);

1607 
i
 = 
num_keys
; i < 
Àaf_‹dî
 - 1; i++){

1608 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
Àaf_off£t
 + 128 + 128*
i
, 
SEEK_SET
);

1609 
	`fwrôe
(&
zîo
, 8, 1, 
Â
);

1610 
	`fwrôe
(
zîo_v
, 1, 120, 
Â
);

1612 
i
 = 
√w_num_keys
; i < 
Àaf_‹dî
 - 1; i++){

1613 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√w_Àaf_off£t
 + 128 + 128*
i
, 
SEEK_SET
);

1614 
	`fwrôe
(&
zîo
, 8, 1, 
Â
);

1615 
	`fwrôe
(
zîo_v
, 1, 120, 
Â
);

1620 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
Àaf_off£t
, 
SEEK_SET
);

1621 
	`‰ód
(&
p_off£t
, 8, 1, 
Â
);

1622 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√w_Àaf_off£t
, 
SEEK_SET
);

1623 
	`fwrôe
(&
p_off£t
, 8, 1, 
Â
);

1625 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√w_Àaf_off£t
 + 128, 
SEEK_SET
);

1626 
	`‰ód
(&
√w_key
, 8, 1, 
Â
);

1629  
	`ö£π_öto_∑ª¡_∑ge
(
Ω_off£t
, 
Àaf_off£t
, 
√w_key
, 
√w_Àaf_off£t
);

1630 
	}
}

1631 
öt64_t
 
	$ö£π_öto_öã∫Æ_∑ge
(
öt64_t
 
Ω_off£t
, i¡64_à
p_off£t
, i¡64_à
À·_off£t
, i¡64_à
key
, i¡64_à
r_off£t
){

1632 
öt64_t
 
ãmp_key
, 
ãmp_off£t
;

1633 
num_keys
, 
i
;

1636 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
p_off£t
 + 12, 
SEEK_SET
);

1637 
	`‰ód
(&
num_keys
, 4, 1, 
Â
);

1640 
i
 = 
num_keys
; i > 
À·_off£t
; i--){

1642 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
p_off£t
 + 128 + (
i
-1)*16, 
SEEK_SET
);

1643 
	`‰ód
(&
ãmp_key
, 8, 1, 
Â
);

1645 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
p_off£t
 + 128 + 
i
*16, 
SEEK_SET
);

1646 
	`fwrôe
(&
ãmp_key
, 8, 1, 
Â
);

1649 if(
i
 == 0){

1650 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
p_off£t
 + 120, 
SEEK_SET
);

1651 
	`‰ód
(&
ãmp_off£t
, 8, 1, 
Â
);

1652 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
p_off£t
 + 128 + 8, 
SEEK_SET
);

1653 
	`fwrôe
(&
ãmp_off£t
, 8, 1, 
Â
);

1656 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
p_off£t
 + 128 + (
i
-1)*16 + 8, 
SEEK_SET
 );

1657 
	`‰ód
(&
ãmp_off£t
, 8, 1, 
Â
);

1658 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
p_off£t
 + 128 + 
i
*16 + 8, 
SEEK_SET
);

1659 
	`fwrôe
(&
ãmp_off£t
, 8, 1, 
Â
);

1663 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
p_off£t
 + 128 + (
À·_off£t
)*16, 
SEEK_SET
);

1664 
	`fwrôe
(&
key
, 8, 1, 
Â
);

1665 
	`fwrôe
(&
r_off£t
, 8, 1, 
Â
);

1668 
num_keys
++;

1669 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
p_off£t
 + 12, 
SEEK_SET
);

1670 
	`fwrôe
(&
num_keys
, 4, 1, 
Â
);

1672  
Ω_off£t
;

1673 
	}
}

1674 
öt64_t
 
	$ö£π_öto_öã∫Æ_∑ge_a·î_•lôtög
(
öt64_t
 
Ω_off£t
, i¡64_à
ﬁd_off£t
, 
À·_off£t
, i¡64_à
key
, i¡64_à
r_off£t
){

1675 
i
, 
j
, 
•lô
, 
ﬁd_num_keys
, 
√w_num_keys
;

1676 
öt64_t
 
k_¥ime
, *
ãmp_keys
, *
ãmp_off£ts
, 
√w_öã∫Æ_off£t
, 
chûd_off£t
, 
p_off£t
;

1679 
ãmp_keys
 = (
öt64_t
 *)
	`mÆloc
(
öã∫Æ_‹dî
 * (int64_t));

1680 
ãmp_off£ts
 = (
öt64_t
 *)
	`mÆloc
((
öã∫Æ_‹dî
 + 1) * (int64_t));

1684 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
ﬁd_off£t
 + 12, 
SEEK_SET
);

1685 
	`‰ód
(&
ﬁd_num_keys
, 4, 1, 
Â
);

1688 
i
 = 0, 
j
 = 0; i < 
ﬁd_num_keys
 + 1; i++, j++){

1689 if(
j
 =
À·_off£t
 + 1)

1690 
j
++;

1691 if(
i
 == 0)

1692 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
ﬁd_off£t
 + 120, 
SEEK_SET
);

1694 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
ﬁd_off£t
 + 128 + 8 + 16*(
i
-1), 
SEEK_SET
);

1696 
	`‰ód
((
ãmp_off£ts
+
j
), 8, 1, 
Â
);

1699 
i
 = 0, 
j
 = 0; i < 
ﬁd_num_keys
; i++, j++){

1700 if(
j
 =
À·_off£t
)

1701 
j
++;

1702 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
ﬁd_off£t
 + 128 + 16*
i
, 
SEEK_SET
);

1703 
	`‰ód
((
ãmp_keys
+
j
), 8, 1, 
Â
);

1705 
ãmp_off£ts
[
À·_off£t
 + 1] = 
r_off£t
;

1706 
ãmp_keys
[
À·_off£t
] = 
key
;

1710 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
ﬁd_off£t
, 
SEEK_SET
);

1711 
	`‰ód
(&
p_off£t
, 8, 1, 
Â
);

1713 
•lô
 = 
	`cut
(
öã∫Æ_‹dî
);

1715 
√w_öã∫Æ_off£t
 = 
	`öô_öã∫Æ_∑ge
(
	`sˇn_‰ì_∑ge
(), 
p_off£t
);

1717 
	`ch™ge_‰ì_∑ge
(
√w_öã∫Æ_off£t
);

1719 
	`modify_hódî_∑ge
(
Ω_off£t
);

1722 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√w_öã∫Æ_off£t
 + 12, 
SEEK_SET
);

1723 
	`‰ód
(&
√w_num_keys
, 4, 1, 
Â
);

1725 
ﬁd_num_keys
 = 0;

1727 
i
 = 0; i < 
•lô
 - 1; i++){

1728 if(
i
 == 0){

1729 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
ﬁd_off£t
 + 120, 
SEEK_SET
);

1730 
	`fwrôe
((
ãmp_off£ts
 + 
i
), 8, 1, 
Â
);

1731 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
ﬁd_off£t
 + 128, 
SEEK_SET
);

1732 
	`fwrôe
((
ãmp_keys
 + 
i
), 8, 1, 
Â
);

1735 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
ﬁd_off£t
 + 128 + 16*(
i
-1Ë+ 8, 
SEEK_SET
);

1736 
	`fwrôe
((
ãmp_off£ts
 + 
i
), 8, 1, 
Â
);

1737 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
ﬁd_off£t
 + 128 + 16*(
i
), 
SEEK_SET
);

1738 
	`fwrôe
((
ãmp_keys
 + 
i
), 8, 1, 
Â
);

1740 
ﬁd_num_keys
++;

1742 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
ﬁd_off£t
 + 128 + 16*(
i
-1Ë+ 8, 
SEEK_SET
);

1743 
	`fwrôe
((
ãmp_off£ts
 + 
i
), 8, 1, 
Â
);

1744 
k_¥ime
 = 
ãmp_keys
[
•lô
 - 1];

1746 ++
i
, 
j
 = 0; i < 
öã∫Æ_‹dî
; i++, j++){

1747 if(
j
 == 0){

1748 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√w_öã∫Æ_off£t
 + 120, 
SEEK_SET
);

1749 
	`fwrôe
((
ãmp_off£ts
 + 
i
), 8, 1, 
Â
);

1750 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√w_öã∫Æ_off£t
 + 128, 
SEEK_SET
);

1751 
	`fwrôe
((
ãmp_keys
 + 
i
), 8, 1, 
Â
);

1754 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√w_öã∫Æ_off£t
 + 128 + 16*(
j
-1Ë+ 8, 
SEEK_SET
);

1755 
	`fwrôe
((
ãmp_off£ts
 + 
i
), 8, 1, 
Â
);

1756 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√w_öã∫Æ_off£t
 + 128 + 16*(
j
), 
SEEK_SET
);

1757 
	`fwrôe
((
ãmp_keys
 + 
i
), 8, 1, 
Â
);

1759 
√w_num_keys
++;

1761 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√w_öã∫Æ_off£t
 + 128 + 16*(
j
-1Ë+ 8, 
SEEK_SET
);

1762 
	`fwrôe
((
ãmp_off£ts
 + 
i
), 8, 1, 
Â
);

1765 
	`‰ì
(
ãmp_keys
);

1766 
	`‰ì
(
ãmp_off£ts
);

1771 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
ﬁd_off£t
 + 12, 
SEEK_SET
);

1772 
	`fwrôe
(&
ﬁd_num_keys
, 4, 1, 
Â
);

1773 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√w_öã∫Æ_off£t
 + 12, 
SEEK_SET
);

1774 
	`fwrôe
(&
√w_num_keys
, 4, 1, 
Â
);

1777 
i
 = 0; i <
√w_num_keys
; i++){

1779 if(
i
 == 0){

1780 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√w_öã∫Æ_off£t
 + 120, 
SEEK_SET
);

1783 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√w_öã∫Æ_off£t
 + 128 + 16*(
i
-1Ë+ 8, 
SEEK_SET
);

1785 
	`‰ód
(&
chûd_off£t
, 8, 1, 
Â
);

1786 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
chûd_off£t
, 
SEEK_SET
);

1787 
	`fwrôe
(&
√w_öã∫Æ_off£t
, 8, 1, 
Â
);

1791  
	`ö£π_öto_∑ª¡_∑ge
(
Ω_off£t
, 
ﬁd_off£t
, 
k_¥ime
, 
√w_öã∫Æ_off£t
);

1792 
	}
}

1793 
öt64_t
 
	$ö£π_öto_∑ª¡_∑ge
(
öt64_t
 
Ω_off£t
, i¡64_à
l_off£t
, i¡64_à
key
, i¡64_à
r_off£t
){

1794 
öt64_t
 
À·_off£t
, 
p_off£t
;

1795 
num_keys
;

1798 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
l_off£t
, 
SEEK_SET
);

1799 
	`‰ód
(&
p_off£t
, 8, 1, 
Â
);

1803 if(
p_off£t
 == 0){

1804  
	`ö£π_öto_√w_roŸ_∑ge
(
l_off£t
, 
key
, 
r_off£t
);

1809 
À·_off£t
 = 
	`gë_À·_off£t
(
p_off£t
, 
l_off£t
);

1813 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
p_off£t
 + 12, 
SEEK_SET
);

1814 
	`‰ód
(&
num_keys
, 4, 1, 
Â
);

1816 if(
num_keys
 < 
öã∫Æ_‹dî
 -1)

1817  
	`ö£π_öto_öã∫Æ_∑ge
(
Ω_off£t
, 
p_off£t
, 
À·_off£t
, 
key
, 
r_off£t
);

1821  
	`ö£π_öto_öã∫Æ_∑ge_a·î_•lôtög
(
Ω_off£t
, 
p_off£t
, 
À·_off£t
, 
key
, 
r_off£t
);

1822 
	}
}

1823 
öt64_t
 
	$ö£π_öto_√w_roŸ_∑ge
(
öt64_t
 
l_off£t
, i¡64_à
key
, i¡64_à
r_off£t
){

1824 
öt64_t
 
√w_Ω_off£t
 = 
	`sˇn_‰ì_∑ge
();

1825 
öt64_t
 
p_off£t
 = 0;

1826 
is_Àaf
 = 0, 
num_keys
 = 1;

1830 
	`ch™ge_‰ì_∑ge
(
√w_Ω_off£t
);

1831 
	`modify_hódî_∑ge
(
√w_Ω_off£t
);

1834 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√w_Ω_off£t
, 
SEEK_SET
);

1836 
	`fwrôe
(&
p_off£t
, 8, 1, 
Â
);

1837 
	`fwrôe
(&
is_Àaf
, 4, 1, 
Â
);

1838 
	`fwrôe
(&
num_keys
, 4, 1, 
Â
);

1841 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√w_Ω_off£t
 + 120, 
SEEK_SET
);

1843 
	`fwrôe
(&
l_off£t
, 8, 1, 
Â
);

1846 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√w_Ω_off£t
 + 128, 
SEEK_SET
);

1848 
	`fwrôe
(&
key
, 8, 1, 
Â
);

1850 
	`fwrôe
(&
r_off£t
, 8, 1, 
Â
);

1853 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
l_off£t
, 
SEEK_SET
);

1854 
	`fwrôe
(&
√w_Ω_off£t
, 8, 1, 
Â
);

1857 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
r_off£t
, 
SEEK_SET
);

1858 
	`fwrôe
(&
√w_Ω_off£t
, 8, 1, 
Â
);

1860  
√w_Ω_off£t
;

1861 
	}
}

1865 
öt64_t
 
	$°¨t_√w_åì_∑ge
(
öt64_t
 
key
, *
vÆue
){

1867 
öt64_t
 
Ω_off£t
 = 
	`sˇn_‰ì_∑ge
();

1868 
num_keys
;

1871 
	`öô_Àaf_∑ge
(
Ω_off£t
);

1873 
	`ch™ge_‰ì_∑ge
(
Ω_off£t
);

1875 
	`modify_hódî_∑ge
(
Ω_off£t
);

1878 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
Ω_off£t
 + 128, 
SEEK_SET
);

1879 
	`fwrôe
(&
key
, 8, 1, 
Â
);

1880 
	`fwrôe
(
vÆue
, 1, 120, 
Â
);

1883 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
Ω_off£t
 + 12, 
SEEK_SET
);

1884 
	`‰ód
(&
num_keys
, 4, 1, 
Â
);

1885 
num_keys
++;

1886 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
Ω_off£t
 + 12, 
SEEK_SET
);

1887 
	`fwrôe
(&
num_keys
, 4, 1, 
Â
);

1890  
Ω_off£t
;

1891 
	}
}

1897 
	$ö£π
(
öt64_t
 
key
, *
vÆue
){

1898 
öt64_t
 
Ω_off£t
,
Õ_off£t
;

1899 
num_keys
;

1902 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 8, 
SEEK_SET
);

1903 
	`‰ód
(&
Ω_off£t
, 8, 1, 
Â
);

1906 if(
	`föd
(
key
Ë!
NULL
)

1915 if(
Ω_off£t
 == 0){

1917 
Ω_off£t
 = 
	`°¨t_√w_åì_∑ge
(
key
, 
vÆue
);

1920 
	`fÊush
(
Â
);

1928 
Õ_off£t
 = 
	`föd_Àaf_∑ge
(
Ω_off£t
, 
key
);

1933 
	`f£eko
(
Â
, 
deÁu…_off£t
+
Õ_off£t
+12, 
SEEK_SET
);

1934 
	`‰ód
(&
num_keys
, 4, 1, 
Â
);

1936 if(
num_keys
 < 
Àaf_‹dî
 - 1){

1938 
	`ö£π_öto_Àaf_∑ge
(
Õ_off£t
, 
key
, 
vÆue
);

1940 
	`fÊush
(
Â
);

1947 
	`ö£π_öto_Àaf_∑ge_a·î_•lôtög
(
Ω_off£t
, 
Õ_off£t
, 
key
, 
vÆue
);

1949 
	`fÊush
(
Â
);

1951 
	}
}

1958 
	$Àaf_∑ge_judge
(
öt64_t
 
off£t
){

1959 
is_Àaf
;

1962 
	`f£eko
(
Â
, 
deÁu…_off£t
+
off£t
+8, 
SEEK_SET
);

1963 
	`‰ód
(&
is_Àaf
, 4, 1, 
Â
);

1965 if(
is_Àaf
)

1969 
	}
}

1974 
öt64_t
 
	$föd_Àaf_∑ge
(
öt64_t
 
Ω_off£t
, i¡64_à
key
){

1975 
öt64_t
 
off£t
 = 
Ω_off£t
, 
èrgë_key
, 
ãmp
;

1976 
num_keys
,
i
 = 0;

1979 if(
off£t
 == 0){

1980  
off£t
;

1982 !
	`Àaf_∑ge_judge
(
off£t
)){

1983 
i
 = 0;

1985 
	`f£eko
(
Â
, 
deÁu…_off£t
+
off£t
+12, 
SEEK_SET
);

1986 
	`‰ód
(&
num_keys
, 4, 1, 
Â
);

1988 
i
 < 
num_keys
){

1990 
	`f£eko
(
Â
, 
deÁu…_off£t
+
off£t
+128+(16*
i
), 
SEEK_SET
);

1991 
	`‰ód
(&
èrgë_key
, 8, 1, 
Â
);

1993 if(
key
 >
èrgë_key
)

1994 
i
++;

1999 if(
i
==0){

2000 
	`f£eko
(
Â
, 
deÁu…_off£t
+
off£t
+120, 
SEEK_SET
);

2001 
	`‰ód
(&
ãmp
, 8, 1, 
Â
);

2004 
	`f£eko
(
Â
, 
deÁu…_off£t
+
off£t
+128+(16*(
i
-1))+8, 
SEEK_SET
);

2005 
	`‰ód
(&
ãmp
, 8, 1, 
Â
);

2007 
off£t
 = 
ãmp
;

2010  
off£t
;

2011 
	}
}

2016 * 
	$föd
(
öt64_t
 
key
){

2017 
öt64_t
 
Ω_off£t
,
Õ_off£t
,
èrgë_key
;

2018 
i
 = 0, 
num_keys
;

2019 *
vÆue
;

2022 
vÆue
 = (*)
	`mÆloc
(120*());

2025 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 8, 
SEEK_SET
);

2026 
	`‰ód
(&
Ω_off£t
, 8, 1, 
Â
);

2029 
Õ_off£t
 = 
	`föd_Àaf_∑ge
(
Ω_off£t
, 
key
);

2032 if(
Õ_off£t
 == 0){

2033 
	`‰ì
(
vÆue
);

2034  
NULL
;

2038 
	`f£eko
(
Â
, 
deÁu…_off£t
+
Õ_off£t
+12, 
SEEK_SET
);

2039 
	`‰ód
(&
num_keys
, 4, 1, 
Â
);

2041 
i
 = 0; i < 
num_keys
; i++){

2043 
	`f£eko
(
Â
, 
deÁu…_off£t
+
Õ_off£t
+128+(
i
*128), 
SEEK_SET
);

2044 
	`‰ód
(&
èrgë_key
, 8, 1, 
Â
);

2046 if(
èrgë_key
 =
key
)

2049 if(
i
 =
num_keys
){

2050 
	`‰ì
(
vÆue
);

2051  
NULL
;

2055 
	`f£eko
(
Â
, 
deÁu…_off£t
+
Õ_off£t
+128+(
i
*128)+8, 
SEEK_SET
);

2056 
	`‰ód
(
vÆue
, 1, 120, 
Â
);

2058  
vÆue
;

2061 
	}
}

2065 
	$gë_√ighb‹_∑ge_ödex
(
öt64_t
 
off£t
){

2066 
i
,
num_keys
;

2067 
öt64_t
 
p_off£t
, 
èrgë_off£t
;

2070 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
, 
SEEK_SET
);

2071 
	`‰ód
(&
p_off£t
, 8, 1, 
Â
);

2074 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
p_off£t
 + 12, 
SEEK_SET
);

2075 
	`‰ód
(&
num_keys
, 4, 1, 
Â
);

2078 
i
 = 0; i <
num_keys
; i++){

2080 if(
i
 == 0){

2081 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
p_off£t
 + 120, 
SEEK_SET
);

2084 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
p_off£t
 + 128 + 16*(
i
-1Ë+ 8, 
SEEK_SET
);

2086 
	`‰ód
(&
èrgë_off£t
, 8, 1, 
Â
);

2088 if(
èrgë_off£t
 =
off£t
){

2089  
i
 -1;

2094 
	`exô
(
EXIT_FAILURE
);

2095 
	}
}

2096 
öt64_t
 
	$ªmove_íåy_‰om_∑ge
(
öt64_t
 
off£t
, i¡64_à
key
, *
vÆue
, i¡64_à
key_off£t
){

2097 
i
, 
num_off_vÆues
, 
is_Àaf
, 
num_keys
;

2098 
öt64_t
 
èrgë_key
, 
èrgë_off£t
, 
ãmp_off£t
, 
ãmp_key
;

2099 
èrgë_vÆue
[120], 
ãmp_vÆue
[120];

2100 
zîo
[120];

2101 
öt64_t
 
zîo_64
 = 0;

2104 
i
 = 0; i < 120; i++){

2105 
zîo
[
i
] = 0;

2109 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 8, 
SEEK_SET
);

2110 
	`‰ód
(&
is_Àaf
, 4, 1, 
Â
);

2113 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 12, 
SEEK_SET
);

2114 
	`‰ód
(&
num_keys
, 4, 1, 
Â
);

2117 
i
 = 0;

2119 if(
is_Àaf
){

2121 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128 + 128*
i
, 
SEEK_SET
);

2122 
	`‰ód
(&
èrgë_key
, 8, 1, 
Â
);

2123 
èrgë_key
 !
key
){

2124 
i
++;

2125 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128 + 128*
i
, 
SEEK_SET
);

2126 
	`‰ód
(&
èrgë_key
, 8, 1, 
Â
);

2128 ++
i
; i < 
num_keys
; i++){

2129 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128 + 128*
i
, 
SEEK_SET
);

2130 
	`‰ód
(&
ãmp_key
, 8, 1, 
Â
);

2132 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128 + 128*(
i
-1), 
SEEK_SET
);

2133 
	`fwrôe
(&
ãmp_key
, 8, 1, 
Â
);

2139 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128 + 16*
i
, 
SEEK_SET
);

2140 
	`‰ód
(&
èrgë_key
, 8, 1, 
Â
);

2141 
èrgë_key
 !
key
){

2142 
i
++;

2143 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128 + 16*
i
, 
SEEK_SET
);

2144 
	`‰ód
(&
èrgë_key
, 8, 1, 
Â
);

2146 ++
i
; i < 
num_keys
; i++){

2147 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128 + 16*
i
, 
SEEK_SET
);

2148 
	`‰ód
(&
ãmp_key
, 8, 1, 
Â
);

2150 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128 + 16*(
i
-1), 
SEEK_SET
);

2151 
	`fwrôe
(&
ãmp_key
, 8, 1, 
Â
);

2157 
num_off_vÆues
 = 
is_Àaf
 ? 
num_keys
 :Çum_keys + 1;

2158 
i
 = 0;

2160 if(
is_Àaf
){

2162 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128 + 128*
i
 + 8, 
SEEK_SET
);

2163 
	`‰ód
(&
èrgë_vÆue
, 1, 120, 
Â
);

2164 !
	`°rcmp
(
èrgë_vÆue
, 
vÆue
)){

2165 
i
++;

2166 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128 + 128*
i
 + 8, 
SEEK_SET
);

2167 
	`‰ód
(&
èrgë_vÆue
, 1, 120, 
Â
);

2169 ++
i
; i < 
num_off_vÆues
; i++){

2170 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128 + 128*
i
 + 8, 
SEEK_SET
);

2171 
	`‰ód
(&
ãmp_vÆue
, 1, 120, 
Â
);

2173 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128 + 128*(
i
-1Ë+ 8, 
SEEK_SET
);

2174 
	`fwrôe
(&
ãmp_vÆue
, 1, 120, 
Â
);

2181 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 120, 
SEEK_SET
);

2182 
	`‰ód
(&
èrgë_off£t
, 8, 1, 
Â
);

2183 
key_off£t
 !
èrgë_off£t
){

2184 
i
++;

2185 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128 + 16*(
i
-1Ë+ 8, 
SEEK_SET
);

2186 
	`‰ód
(&
èrgë_off£t
, 8, 1, 
Â
);

2188 ++
i
; i < 
num_off_vÆues
; i++){

2189 if(
i
 == 1){

2190 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128 + 16*(
i
-1Ë+ 8, 
SEEK_SET
);

2191 
	`‰ód
(&
ãmp_off£t
, 8, 1, 
Â
);

2193 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 120, 
SEEK_SET
);

2194 
	`fwrôe
(&
ãmp_off£t
, 8, 1, 
Â
);

2197 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128 + 16*(
i
-1Ë+ 8, 
SEEK_SET
);

2198 
	`‰ód
(&
ãmp_off£t
, 8, 1, 
Â
);

2200 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128 + 16*(
i
-2Ë+ 8, 
SEEK_SET
);

2201 
	`fwrôe
(&
ãmp_off£t
, 8, 1, 
Â
);

2207 
num_keys
--;

2209 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 12, 
SEEK_SET
);

2210 
	`fwrôe
(&
num_keys
, 4, 1, 
Â
);

2213 if(
is_Àaf
){

2214 
i
 = 
num_keys
; i < 
Àaf_‹dî
 - 1; i++){

2215 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128 + 128*
i
 + 8, 
SEEK_SET
);

2216 
	`fwrôe
(
zîo
, 1, 120, 
Â
);

2220 
i
 = 
num_keys
 + 1; i < 
öã∫Æ_‹dî
; i++){

2221 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128 + 16*(
i
-1Ë+ 8, 
SEEK_SET
);

2222 
	`fwrôe
(&
zîo_64
, 8, 1, 
Â
);

2226  
off£t
;

2227 
	}
}

2228 
öt64_t
 
	$adju°_roŸ_∑ge
(
öt64_t
 
Ω_off£t
){

2229 
öt64_t
 
√w_Ω_off£t
, 
p_off£t
 = 0;

2230 
num_keys
, 
is_Àaf
;

2234 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
Ω_off£t
 + 12, 
SEEK_SET
);

2235 
	`‰ód
(&
num_keys
, 4, 1, 
Â
);

2237 if(
num_keys
 > 0)

2238  
Ω_off£t
;

2242 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
Ω_off£t
 + 8, 
SEEK_SET
);

2243 
	`‰ód
(&
is_Àaf
, 4, 1, 
Â
);

2245 if(!
is_Àaf
){

2248 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
Ω_off£t
 + 120, 
SEEK_SET
);

2249 
	`‰ód
(&
√w_Ω_off£t
, 8, 1, 
Â
);

2252 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√w_Ω_off£t
, 
SEEK_SET
);

2253 
	`fwrôe
(&
p_off£t
, 8, 1, 
Â
);

2256 
	`modify_hódî_∑ge
(
√w_Ω_off£t
);

2261 
√w_Ω_off£t
 = 0;

2263 
	`modify_hódî_∑ge
(
√w_Ω_off£t
);

2266  
√w_Ω_off£t
;

2267 
	}
}

2268 
öt64_t
 
	$cﬂÀs˚_∑ges
(
öt64_t
 
Ω_off£t
, i¡64_à
off£t
, i¡64_à
√ighb‹_off£t
, 
√ighb‹_ödex
, i¡64_à
k_¥ime
){

2269 
i
, 
j
, 
√ighb‹_ö£πi⁄_ödex
, 
off£t_íd
, 
is_Àaf
, 
num_keys
 = 0, 
√ighb‹_num_keys
 = 0;

2270 
öt64_t
 
ãmp_key
, 
ãmp_off£t
, 
p_off£t
;

2271 
ãmp_vÆue
[120];

2272 
zîo
[4096];

2275 
i
 = 0; i < 4096; i++){

2276 
zîo
[
i
] = 0;

2280 if(
√ighb‹_ödex
 == -1){

2281 
ãmp_off£t
 = 
off£t
;

2282 
off£t
 = 
√ighb‹_off£t
;

2283 
√ighb‹_off£t
 = 
ãmp_off£t
;

2287 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 8, 
SEEK_SET
);

2288 
	`‰ód
(&
is_Àaf
, 4, 1, 
Â
);

2291 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√ighb‹_off£t
 + 12, 
SEEK_SET
);

2292 
	`‰ód
(&
√ighb‹_num_keys
, 4, 1, 
Â
);

2294 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 12, 
SEEK_SET
);

2295 
	`‰ód
(&
num_keys
, 4, 1, 
Â
);

2297 
√ighb‹_ö£πi⁄_ödex
 = 
√ighb‹_num_keys
;

2300 if(!
is_Àaf
){

2302 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√ighb‹_off£t
 + 128 + 16*(
√ighb‹_ö£πi⁄_ödex
), 
SEEK_SET
);

2303 
	`fwrôe
(&
k_¥ime
, 8, 1, 
Â
);

2305 
√ighb‹_num_keys
++;

2307 
off£t_íd
 = 
num_keys
;

2309 
i
 = 
√ighb‹_ö£πi⁄_ödex
 + 1, 
j
 = 0; j < 
off£t_íd
; i++, j++){

2312 if(
j
 == 0){

2313 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 120, 
SEEK_SET
);

2314 
	`‰ód
(&
ãmp_off£t
, 8, 1, 
Â
);

2317 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128 + 16*(
j
-1Ë+ 8, 
SEEK_SET
);

2318 
	`‰ód
(&
ãmp_off£t
, 8, 1, 
Â
);

2321 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128 + 16*
j
, 
SEEK_SET
);

2322 
	`‰ód
(&
ãmp_key
, 8, 1, 
Â
);

2326 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√ighb‹_off£t
 + 128 + 16*(
i
-1Ë+ 8, 
SEEK_SET
);

2327 
	`fwrôe
(&
ãmp_off£t
, 8, 1, 
Â
);

2329 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√ighb‹_off£t
 + 128 + 16*
i
, 
SEEK_SET
);

2330 
	`fwrôe
(&
ãmp_key
, 8, 1, 
Â
);

2332 
√ighb‹_num_keys
++;

2333 
num_keys
--;

2336 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128 + 16*(
j
-1Ë+ 8, 
SEEK_SET
);

2337 
	`‰ód
(&
ãmp_off£t
, 8, 1, 
Â
);

2339 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√ighb‹_off£t
 + 128 + 16*(
i
-1Ë+ 8, 
SEEK_SET
);

2340 
	`fwrôe
(&
ãmp_off£t
, 8, 1, 
Â
);

2344 
i
 = 0; i < 
√ighb‹_num_keys
 + 1; i++){

2345 if(
i
 == 0){

2346 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√ighb‹_off£t
 + 120, 
SEEK_SET
);

2347 
	`‰ód
(&
ãmp_off£t
, 8, 1, 
Â
);

2350 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√ighb‹_off£t
 + 128 + 16*(
i
-1Ë+ 8, 
SEEK_SET
);

2351 
	`‰ód
(&
ãmp_off£t
, 8, 1, 
Â
);

2355 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
ãmp_off£t
, 
SEEK_SET
);

2356 
	`fwrôe
(&
√ighb‹_off£t
, 8, 1, 
Â
);

2359 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 12, 
SEEK_SET
);

2360 
	`fwrôe
(&
num_keys
, 4, 1, 
Â
);

2362 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√ighb‹_off£t
 + 12, 
SEEK_SET
);

2363 
	`fwrôe
(&
√ighb‹_num_keys
, 4, 1, 
Â
);

2367 
i
 = 
√ighb‹_ö£πi⁄_ödex
, 
j
 = 0; j < 
num_keys
; i++, j++){

2369 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128 + 
j
*128, 
SEEK_SET
);

2370 
	`‰ód
(&
ãmp_key
, 8, 1, 
Â
);

2371 
	`‰ód
(
ãmp_vÆue
, 1, 120, 
Â
);

2374 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√ighb‹_off£t
 + 128 + 
i
*128, 
SEEK_SET
);

2375 
	`fwrôe
(&
ãmp_key
, 8, 1, 
Â
);

2376 
	`fwrôe
(
ãmp_vÆue
, 1, 120 , 
Â
);

2379 
√ighb‹_num_keys
++;

2382 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 120, 
SEEK_SET
);

2383 
	`‰ód
(&
ãmp_off£t
, 8, 1, 
Â
);

2384 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√ighb‹_off£t
 + 120, 
SEEK_SET
);

2385 
	`fwrôe
(&
ãmp_off£t
, 8, 1, 
Â
);

2388 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√ighb‹_off£t
 + 12, 
SEEK_SET
);

2389 
	`fwrôe
(&
√ighb‹_num_keys
, 4, 1, 
Â
);

2392 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
, 
SEEK_SET
);

2393 
	`‰ód
(&
p_off£t
, 8, 1, 
Â
);

2395 
	`dñëe_íåy_‰om_∑ge
(
Ω_off£t
, 
p_off£t
, 
k_¥ime
, 
NULL
, 
off£t
);

2398 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
, 
SEEK_SET
);

2399 
	`fwrôe
(
zîo
, 1, 4096, 
Â
);

2400 
	`vacuum_usög_∑ge
(
off£t
);

2402  
Ω_off£t
;

2403 
	}
}

2404 
öt64_t
 
	$ªdi°ribuã_∑ges
(
öt64_t
 
Ω_off£t
, i¡64_à
off£t
, i¡64_à
√ighb‹_off£t
, 
√ighb‹_ödex
, 
k_¥ime_ödex
, i¡64_à
k_¥ime
){

2405 
i
, 
is_Àaf
, 
num_keys
, 
√ighb‹_num_keys
;

2406 
öt64_t
 
ãmp_off£t
, 
ãmp_key
, 
p_off£t
, 
zîo_64
 = 0;

2407 
ãmp_vÆue
[120], 
zîo
[120];

2410 
i
 = 0; i < 120; i++){

2411 
zîo
[
i
] = 0;

2415 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 8, 
SEEK_SET
);

2416 
	`‰ód
(&
is_Àaf
, 4, 1, 
Â
);

2418 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 12, 
SEEK_SET
);

2419 
	`‰ód
(&
num_keys
, 4, 1, 
Â
);

2421 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√ighb‹_off£t
 + 12, 
SEEK_SET
);

2422 
	`‰ód
(&
√ighb‹_num_keys
, 4, 1, 
Â
);

2425 if(
√ighb‹_ödex
 != -1){

2427 if(!
is_Àaf
){

2428 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128 + 16*(
num_keys
-1Ë+ 8, 
SEEK_SET
);

2429 
	`‰ód
(&
ãmp_off£t
, 8, 1, 
Â
);

2431 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128 + 16*(
num_keys
Ë+ 8, 
SEEK_SET
);

2432 
	`fwrôe
(&
ãmp_off£t
, 8, 1, 
Â
);

2434 
i
 = 
num_keys
; i > 0; i--){

2437 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128 + 16*(
i
-1), 
SEEK_SET
);

2438 
	`‰ód
(&
ãmp_key
, 8, 1, 
Â
);

2439 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128 + 16*
i
, 
SEEK_SET
);

2440 
	`fwrôe
(&
ãmp_key
, 8, 1, 
Â
);

2443 if(
i
 - 1 == 0){

2444 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 120, 
SEEK_SET
);

2445 
	`‰ód
(&
ãmp_off£t
, 8, 1, 
Â
);

2448 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128 + 16*(
i
-2Ë+ 8, 
SEEK_SET
);

2449 
	`‰ód
(&
ãmp_off£t
, 8, 1, 
Â
);

2451 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128 + 16*(
i
-1Ë+ 8, 
SEEK_SET
);

2452 
	`fwrôe
(&
ãmp_off£t
, 8, 1, 
Â
);

2455 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√ighb‹_off£t
 + 128 + 16*(
√ighb‹_num_keys
 - 1Ë+ 8, 
SEEK_SET
);

2456 
	`‰ód
(&
ãmp_off£t
, 8, 1, 
Â
);

2459 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 120, 
SEEK_SET
);

2460 
	`fwrôe
(&
ãmp_off£t
, 8, 1, 
Â
);

2463 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
ãmp_off£t
, 
SEEK_SET
);

2464 
	`fwrôe
(&
off£t
, 8, 1, 
Â
);

2467 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√ighb‹_off£t
 + 128 + 16*(
√ighb‹_num_keys
 -1Ë+ 8, 
SEEK_SET
);

2468 
	`fwrôe
(&
zîo_64
, 8, 1, 
Â
);

2471 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128, 
SEEK_SET
);

2472 
	`fwrôe
(&
k_¥ime
, 8, 1, 
Â
);

2476 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
, 
SEEK_SET
);

2477 
	`‰ód
(&
p_off£t
, 8, 1, 
Â
);

2480 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√ighb‹_off£t
 + 128 + 16*(
√ighb‹_num_keys
-1), 
SEEK_SET
);

2481 
	`‰ód
(&
ãmp_key
, 8, 1, 
Â
);

2484 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
p_off£t
 + 128 + 16*(
k_¥ime_ödex
), 
SEEK_SET
);

2485 
	`fwrôe
(&
ãmp_key
, 8, 1, 
Â
);

2489 
i
 = 
num_keys
; i > 0; i--){

2491 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128 + 128*(
i
-1), 
SEEK_SET
);

2492 
	`‰ód
(&
ãmp_key
, 8, 1, 
Â
);

2493 
	`‰ód
(
ãmp_vÆue
, 1, 120, 
Â
);

2495 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128 + 128*
i
, 
SEEK_SET
);

2496 
	`fwrôe
(&
ãmp_key
, 8, 1, 
Â
);

2497 
	`fwrôe
(
ãmp_vÆue
, 1, 120, 
Â
);

2500 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√ighb‹_off£t
 + 128 + 128*(
√ighb‹_num_keys
 - 1Ë+ 8, 
SEEK_SET
);

2501 
	`‰ód
(
ãmp_vÆue
, 1, 120, 
Â
);

2503 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128 + 8, 
SEEK_SET
);

2504 
	`fwrôe
(
ãmp_vÆue
, 1, 120, 
Â
);

2506 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√ighb‹_off£t
 + 128 + 128*(
√ighb‹_num_keys
 - 1Ë+ 8, 
SEEK_SET
);

2507 
	`fwrôe
(
zîo
, 1, 120, 
Â
);

2510 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√ighb‹_off£t
 + 128 + 128*(
√ighb‹_num_keys
 - 1), 
SEEK_SET
);

2511 
	`‰ód
(&
ãmp_key
, 8, 1, 
Â
);

2513 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128, 
SEEK_SET
);

2514 
	`fwrôe
(&
ãmp_key
, 8, 1, 
Â
);

2518 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
, 
SEEK_SET
);

2519 
	`‰ód
(&
p_off£t
, 8, 1, 
Â
);

2521 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
p_off£t
 + 128 + 128*
k_¥ime_ödex
, 
SEEK_SET
);

2522 
	`fwrôe
(&
ãmp_key
, 8, 1, 
Â
);

2529 if(
is_Àaf
){

2531 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√ighb‹_off£t
 + 128, 
SEEK_SET
);

2532 
	`‰ód
(&
ãmp_key
, 8, 1, 
Â
);

2533 
	`‰ód
(&
ãmp_vÆue
, 1, 120, 
Â
);

2535 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128 + 128*
num_keys
, 
SEEK_SET
);

2536 
	`fwrôe
(&
ãmp_key
, 8, 1, 
Â
);

2537 
	`fwrôe
(&
ãmp_vÆue
, 1, 120, 
Â
);

2541 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
, 
SEEK_SET
);

2542 
	`‰ód
(&
p_off£t
, 8, 1, 
Â
);

2545 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√ighb‹_off£t
 + 128 + 128, 
SEEK_SET
);

2546 
	`‰ód
(&
ãmp_key
, 8, 1, 
Â
);

2548 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
p_off£t
 + 128 + 128*
k_¥ime_ödex
, 
SEEK_SET
);

2549 
	`fwrôe
(&
ãmp_key
, 8, 1, 
Â
);

2551 
i
 = 0; i < 
√ighb‹_num_keys
 - 1; i++){

2552 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√ighb‹_off£t
 + 128 + 128*(
i
+1), 
SEEK_SET
);

2553 
	`‰ód
(&
ãmp_key
, 8, 1, 
Â
);

2554 
	`‰ód
(
ãmp_vÆue
, 1, 120, 
Â
);

2556 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√ighb‹_off£t
 + 128 + 128*
i
, 
SEEK_SET
);

2557 
	`fwrôe
(&
ãmp_key
, 8, 1, 
Â
);

2558 
	`fwrôe
(
ãmp_vÆue
, 1, 120, 
Â
);

2564 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128 + 16*
num_keys
, 
SEEK_SET
);

2565 
	`fwrôe
(&
k_¥ime
, 8, 1, 
Â
);

2568 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√ighb‹_off£t
 + 120, 
SEEK_SET
);

2569 
	`‰ód
(&
ãmp_off£t
, 8, 1, 
Â
);

2571 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128 + 16*(
num_keys
Ë+ 8, 
SEEK_SET
);

2572 
	`fwrôe
(&
ãmp_off£t
, 8, 1, 
Â
);

2575 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
ãmp_off£t
, 
SEEK_SET
);

2576 
	`fwrôe
(&
off£t
, 8, 1, 
Â
);

2579 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
, 
SEEK_SET
);

2580 
	`‰ód
(&
p_off£t
, 8, 1, 
Â
);

2583 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√ighb‹_off£t
 + 128, 
SEEK_SET
);

2584 
	`fwrôe
(&
ãmp_key
, 8, 1, 
Â
);

2586 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
p_off£t
 + 128 + 16*(
k_¥ime_ödex
), 
SEEK_SET
);

2587 
	`fwrôe
(&
ãmp_key
, 8, 1, 
Â
);

2589 
i
 = 0; i < 
√ighb‹_num_keys
 - 1; i++){

2591 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√ighb‹_off£t
 + 128 + 16*(
i
+1), 
SEEK_SET
);

2592 
	`‰ód
(&
ãmp_key
, 8, 1, 
Â
);

2594 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√ighb‹_off£t
 + 128 + 16*
i
, 
SEEK_SET
);

2595 
	`fwrôe
(&
ãmp_key
, 8, 1, 
Â
);

2598 if(
i
 == 0){

2599 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√ighb‹_off£t
 + 128 + 8, 
SEEK_SET
);

2600 
	`‰ód
(&
ãmp_off£t
, 8, 1, 
Â
);

2602 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√ighb‹_off£t
 + 120, 
SEEK_SET
);

2603 
	`fwrôe
(&
ãmp_off£t
, 8, 1, 
Â
);

2606 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√ighb‹_off£t
 + 128 + 16*(
i
Ë+ 8, 
SEEK_SET
);

2607 
	`‰ód
(&
ãmp_off£t
, 8, 1, 
Â
);

2609 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√ighb‹_off£t
 + 128 + 16*(
i
-1Ë+ 8, 
SEEK_SET
);

2610 
	`fwrôe
(&
ãmp_off£t
, 8, 1, 
Â
);

2614 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√ighb‹_off£t
 + 128 + 16*(
i
Ë+ 8, 
SEEK_SET
);

2615 
	`‰ód
(&
ãmp_off£t
, 8, 1, 
Â
);

2617 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√ighb‹_off£t
 + 128 + 16*(
i
-1Ë+ 8, 
SEEK_SET
);

2618 
	`fwrôe
(&
ãmp_off£t
, 8, 1, 
Â
);

2621 
num_keys
++;

2622 
√ighb‹_num_keys
--;

2625 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 12, 
SEEK_SET
);

2626 
	`fwrôe
(&
num_keys
, 4, 1, 
Â
);

2628 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√ighb‹_off£t
 + 12, 
SEEK_SET
);

2629 
	`fwrôe
(&
√ighb‹_num_keys
, 4, 1, 
Â
);

2631  
Ω_off£t
;

2632 
	}
}

2633 
öt64_t
 
	$dñëe_íåy_‰om_∑ge
(
öt64_t
 
Ω_off£t
, i¡64_à
off£t
, i¡64_à
key
, *
vÆue
, i¡64_à
key_off£t
){

2634 
mö_keys
 = 0, 
is_Àaf
 = 0, 
num_keys
 = 0, 
√ighb‹_num_keys
 = 0, 
k_¥ime_ödex
 = 0, 
√ighb‹_ödex
 = 0, 
ˇ∑côy
 = 0;

2635 
öt64_t
 
k_¥ime
, 
√ighb‹_off£t
, 
p_off£t
;

2638 
off£t
 = 
	`ªmove_íåy_‰om_∑ge
(off£t, 
key
, 
vÆue
, 
key_off£t
);

2641 if(
off£t
 =
Ω_off£t
)

2642  
	`adju°_roŸ_∑ge
(
Ω_off£t
);

2648 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 8, 
SEEK_SET
);

2649 
	`‰ód
(&
is_Àaf
, 4, 1, 
Â
);

2650 
mö_keys
 = 
is_Àaf
 ? 
	`cut
(
Àaf_‹dî
 - 1Ë: cut(
öã∫Æ_‹dî
) - 1;

2654 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 12, 
SEEK_SET
);

2655 
	`‰ód
(&
num_keys
, 4, 1, 
Â
);

2657 if(
num_keys
 >
mö_keys
)

2658  
Ω_off£t
;

2663 
√ighb‹_ödex
 = 
	`gë_√ighb‹_∑ge_ödex
(
off£t
);

2664 
k_¥ime_ödex
 = 
√ighb‹_ödex
 == -1 ? 0 :Çeighbor_index;

2669 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
, 
SEEK_SET
);

2670 
	`‰ód
(&
p_off£t
, 8, 1, 
Â
);

2672 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
p_off£t
 + 128 + 16*
k_¥ime_ödex
, 
SEEK_SET
);

2673 
	`‰ód
(&
k_¥ime
, 8, 1, 
Â
);

2676 if(
√ighb‹_ödex
 == -1){

2677 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
p_off£t
 + 128 + 8, 
SEEK_SET
);

2678 
	`‰ód
(&
√ighb‹_off£t
, 8, 1, 
Â
);

2681 if(
√ighb‹_ödex
 == 0){

2682 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
p_off£t
 + 120, 
SEEK_SET
);

2683 
	`‰ód
(&
√ighb‹_off£t
, 8, 1, 
Â
);

2686 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
p_off£t
 + 128 + 16*(
√ighb‹_ödex
-1Ë+ 8, 
SEEK_SET
);

2687 
	`‰ód
(&
√ighb‹_off£t
, 8, 1, 
Â
);

2691 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√ighb‹_off£t
 + 12, 
SEEK_SET
);

2692 
	`‰ód
(&
√ighb‹_num_keys
, 4, 1, 
Â
);

2695 
ˇ∑côy
 = 
is_Àaf
 ? 
Àaf_‹dî
 : 
öã∫Æ_‹dî
 - 1;

2698 if(
√ighb‹_num_keys
 + 
num_keys
 < 
ˇ∑côy
){

2699  
	`cﬂÀs˚_∑ges
(
Ω_off£t
, 
off£t
, 
√ighb‹_off£t
, 
√ighb‹_ödex
, 
k_¥ime
);

2703  
	`ªdi°ribuã_∑ges
(
Ω_off£t
, 
off£t
, 
√ighb‹_off£t
, 
√ighb‹_ödex
, 
k_¥ime_ödex
, 
k_¥ime
);

2705 
	}
}

2710 
	$dñëe
(
öt64_t
 
key
){

2711 
key_vÆue
[120];

2712 
öt64_t
 
key_Àaf_off£t
, 
Ω_off£t
;

2715 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 8, 
SEEK_SET
);

2716 
	`‰ód
(&
Ω_off£t
, 8, 1, 
Â
);

2719 if(
	`föd
(
key
Ë=
NULL
){

2722 
	`memmove
(
key_vÆue
, 
	`föd
(
key
), 120);

2723 
key_Àaf_off£t
 = 
	`föd_Àaf_∑ge
(
Ω_off£t
, 
key
);

2726 if(
key_vÆue
 !
NULL
 && 
key_Àaf_off£t
 != 0){

2727 
	`dñëe_íåy_‰om_∑ge
(
Ω_off£t
, 
key_Àaf_off£t
, 
key
, 
key_vÆue
, 0);

2729 
	`fÊush
(
Â
);

2734 
	}
}

	@main.c

1 
	~"b±.h
"

5 
	$maö
–
¨gc
, ** 
¨gv
 ) {

7 * 
öput_fûe
;

8 
vÆue
[120];

9 
FILE
 * 
Â
;

10 
node
 * 
roŸ
;

11 
ønge2
;

12 
öt64_t
 
öput
;

13 
ö°ru˘i⁄
;

14 
li˚n£_∑π
;

16 
roŸ
 = 
NULL
;

17 
vîbo£_ouçut
 = 
Ál£
;

19 i‡(
¨gc
 > 1) {

20 
‹dî
 = 
	`©oi
(
¨gv
[1]);

21 i‡(
‹dî
 < 
MIN_ORDER
 || ordî > 
MAX_ORDER
) {

22 
	`Ârötf
(
°dîr
, "InvÆid ordî: %d .\n\n", 
‹dî
);

23 
	`ußge_3
();

24 
	`exô
(
EXIT_FAILURE
);

28 
	`£tvbuf
(
°dö
, 
NULL
, 
_IONBF
, 0);

29 
	`£tvbuf
(
°dout
, 
NULL
, 
_IONBF
, 0);

36 i‡(
¨gc
 > 2) {

37 
öput_fûe
 = 
¨gv
[2];

38 
	`›í_db
(
öput_fûe
);

55 
	`sˇnf
("%c", &
ö°ru˘i⁄
Ë!
EOF
) {

56 
ö°ru˘i⁄
) {

58 
	`sˇnf
("%" "l" "d", &
öput
);

59 
	`dñëe
(
öput
);

67 
	`sˇnf
("%" "l" "d", &
öput
);

68 
	`sˇnf
("%s", 
vÆue
);

69 
	`ö£π
(
öput
, 
vÆue
);

78 
	`sˇnf
("%" "l" "d", &
öput
);

79 if(
	`föd
(
öput
Ë=
NULL
){

80 
	`¥ötf
("Not Exists\n");

83 
	`¥ötf
("Key: %" "l" "d" ", VÆue: %s\n", 
öput
, 
	`föd
(input));

91 
	`sˇnf
("%" "l" "d", &
öput
);

92 
	`sˇnf
("%d", &
ønge2
);

93 i‡(
öput
 > 
ønge2
) {

94 
tmp
 = 
ønge2
;

95 
ønge2
 = 
öput
;

96 
öput
 = 
tmp
;

98 
	`föd_™d_¥öt_ønge
(
roŸ
, 
öput
, 
ønge2
, 
ö°ru˘i⁄
 == 'p');

101 
	`¥öt_Àaves
(
roŸ
);

104 
	`gëch¨
() != ()'\n');

105  
EXIT_SUCCESS
;

108 
	`¥öt_åì
(
roŸ
);

111 
vîbo£_ouçut
 = !verbose_output;

114 i‡(
roŸ
)

115 
roŸ
 = 
	`de°roy_åì
(root);

116 
	`¥öt_åì
(
roŸ
);

124 
	`gëch¨
() != ()'\n');

129  
EXIT_SUCCESS
;

130 
	}
}

	@
1
.
0
2
13
bpt.c
main.c
