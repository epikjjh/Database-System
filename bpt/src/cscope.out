cscope 15 $HOME/mysql/Lab/bpt/src -q 0000000236 0000058471
	@bpt.c

4 
	#Vîsi⁄
 "1.14"

	)

55 
	~"b±.h
"

69 
	g‹dî
 = 
DEFAULT_ORDER
;

70 
	gÀaf_‹dî
 = 32;

71 
	göã∫Æ_‹dî
 = 249;

78 
node
 * 
	gqueue
 = 
NULL
;

85 
boﬁ
 
	gvîbo£_ouçut
 = 
Ál£
;

90 
FILE
 *
	gÂ
;

91 
	gfd
;

97 
öt64_t
 
	gdeÁu…_off£t
;

103 
∑ge_li°
 *
	ghód
 = 
NULL
;

111 
	$li˚n£_nŸi˚
( ) {

112 
	`¥ötf
("bpt version %s -- Copyright (C) 2010 Amittai Aviram "

113 "hâp://www.amôèi.com\n", 
Vîsi⁄
);

114 
	`¥ötf
("ThisÖrogram comes with ABSOLUTELY NO WARRANTY; for details "

118 
	}
}

123 
	$¥öt_li˚n£
–
li˚n£_∑π
 ) {

124 
°¨t
, 
íd
, 
löe
;

125 
FILE
 * 
Â
;

126 
buf„r
[0x100];

128 
li˚n£_∑π
) {

129 
LICENSE_WARRANTEE
:

130 
°¨t
 = 
LICENSE_WARRANTEE_START
;

131 
íd
 = 
LICENSE_WARRANTEE_END
;

133 
LICENSE_CONDITIONS
:

134 
°¨t
 = 
LICENSE_CONDITIONS_START
;

135 
íd
 = 
LICENSE_CONDITIONS_END
;

141 
Â
 = 
	`f›í
(
LICENSE_FILE
, "r");

142 i‡(
Â
 =
NULL
) {

143 
	`≥º‹
("print_license: fopen");

144 
	`exô
(
EXIT_FAILURE
);

146 
löe
 = 0;Üöê< 
°¨t
;Üine++)

147 
	`fgës
(
buf„r
, (buf„r), 
Â
);

148  ; 
löe
 < 
íd
;Üine++) {

149 
	`fgës
(
buf„r
, (buf„r), 
Â
);

150 
	`¥ötf
("%s", 
buf„r
);

152 
	`f˛o£
(
Â
);

153 
	}
}

158 
	$ußge_1
( ) {

159 
	`¥ötf
("B+ Tªêo‡Ordî %d.\n", 
‹dî
);

160 
	`¥ötf
("Following Silberschatz, Korth, Sidarshan, Database Concepts, "

165 
	`¥ötf
("(%d <‹dî <%d).\n", 
MIN_ORDER
, 
MAX_ORDER
);

166 
	`¥ötf
("To start with input fromá file ofÇewline-delimited integers, \n"

169 
	}
}

174 
	$ußge_2
( ) {

175 
	`¥ötf
("Enterány ofÅhe following commandsáfterÅheÖrompt > :\n"

191 
	}
}

196 
	$ußge_3
( ) {

197 
	`¥ötf
("Usage: ./bpt [<order>]\n");

198 
	`¥ötf
("\twhîê%d <‹dî <%d .\n", 
MIN_ORDER
, 
MAX_ORDER
);

199 
	}
}

205 
	$íqueue
–
node
 * 
√w_node
 ) {

206 
node
 * 
c
;

207 i‡(
queue
 =
NULL
) {

208 
queue
 = 
√w_node
;

209 
queue
->
√xt
 = 
NULL
;

212 
c
 = 
queue
;

213 
c
->
√xt
 !
NULL
) {

214 
c
 = c->
√xt
;

216 
c
->
√xt
 = 
√w_node
;

217 
√w_node
->
√xt
 = 
NULL
;

219 
	}
}

225 
node
 * 
	$dequeue
( ) {

226 
node
 * 
n
 = 
queue
;

227 
queue
 = queue->
√xt
;

228 
n
->
√xt
 = 
NULL
;

229  
n
;

230 
	}
}

237 
	$¥öt_Àaves
–
node
 * 
roŸ
 ) {

238 
i
;

239 
node
 * 
c
 = 
roŸ
;

240 i‡(
roŸ
 =
NULL
) {

241 
	`¥ötf
("EmptyÅree.\n");

244 !
c
->
is_Àaf
)

245 
c
 = c->
poöãrs
[0];

246 
åue
) {

247 
i
 = 0; i < 
c
->
num_keys
; i++) {

248 i‡(
vîbo£_ouçut
)

249 
	`¥ötf
("%lx ", ()
c
->
poöãrs
[
i
]);

250 
	`¥ötf
("%d ", 
c
->
keys
[
i
]);

252 i‡(
vîbo£_ouçut
)

253 
	`¥ötf
("%lx ", ()
c
->
poöãrs
[
‹dî
 - 1]);

254 i‡(
c
->
poöãrs
[
‹dî
 - 1] !
NULL
) {

255 
	`¥ötf
(" | ");

256 
c
 = c->
poöãrs
[
‹dî
 - 1];

261 
	`¥ötf
("\n");

262 
	}
}

269 
	$height
–
node
 * 
roŸ
 ) {

270 
h
 = 0;

271 
node
 * 
c
 = 
roŸ
;

272 !
c
->
is_Àaf
) {

273 
c
 = c->
poöãrs
[0];

274 
h
++;

276  
h
;

277 
	}
}

283 
	$∑th_to_roŸ
–
node
 * 
roŸ
,Çodê* 
chûd
 ) {

284 
Àngth
 = 0;

285 
node
 * 
c
 = 
chûd
;

286 
c
 !
roŸ
) {

287 
c
 = c->
∑ª¡
;

288 
Àngth
++;

290  
Àngth
;

291 
	}
}

303 
	$¥öt_åì
–
node
 * 
roŸ
 ) {

305 
node
 * 
n
 = 
NULL
;

306 
i
 = 0;

307 
ønk
 = 0;

308 
√w_ønk
 = 0;

310 i‡(
roŸ
 =
NULL
) {

311 
	`¥ötf
("EmptyÅree.\n");

314 
queue
 = 
NULL
;

315 
	`íqueue
(
roŸ
);

316  
queue
 !
NULL
 ) {

317 
n
 = 
	`dequeue
();

318 i‡(
n
->
∑ª¡
 !
NULL
 &&Ç =n->∑ª¡->
poöãrs
[0]) {

319 
√w_ønk
 = 
	`∑th_to_roŸ
–
roŸ
, 
n
 );

320 i‡(
√w_ønk
 !
ønk
) {

321 
ønk
 = 
√w_ønk
;

322 
	`¥ötf
("\n");

325 i‡(
vîbo£_ouçut
)

326 
	`¥ötf
("(%lx)", ()
n
);

327 
i
 = 0; i < 
n
->
num_keys
; i++) {

328 i‡(
vîbo£_ouçut
)

329 
	`¥ötf
("%lx ", ()
n
->
poöãrs
[
i
]);

330 
	`¥ötf
("%d ", 
n
->
keys
[
i
]);

332 i‡(!
n
->
is_Àaf
)

333 
i
 = 0; i <
n
->
num_keys
; i++)

334 
	`íqueue
(
n
->
poöãrs
[
i
]);

335 i‡(
vîbo£_ouçut
) {

336 i‡(
n
->
is_Àaf
)

337 
	`¥ötf
("%lx ", ()
n
->
poöãrs
[
‹dî
 - 1]);

339 
	`¥ötf
("%lx ", ()
n
->
poöãrs
[n->
num_keys
]);

341 
	`¥ötf
("| ");

343 
	`¥ötf
("\n");

344 
	}
}

350 
	$föd_™d_¥öt
(
node
 * 
roŸ
, 
key
, 
boﬁ
 
vîbo£
) {

351 
ªc‹d
 * 
r
 = 
	`föd_åì
(
roŸ
, 
key
, 
vîbo£
);

352 i‡(
r
 =
NULL
)

353 
	`¥ötf
("Rec‹dÇŸ found undî key %d.\n", 
key
);

355 
	`¥ötf
("Recordát %lx -- key %d, value %d.\n",

356 ()
r
, 
key
,Ñ->
vÆue
);

357 
	}
}

363 
	$föd_™d_¥öt_ønge
–
node
 * 
roŸ
, 
key_°¨t
, 
key_íd
,

364 
boﬁ
 
vîbo£
 ) {

365 
i
;

366 
¨øy_size
 = 
key_íd
 - 
key_°¨t
 + 1;

367 
ªtu∫ed_keys
[
¨øy_size
];

368 * 
ªtu∫ed_poöãrs
[
¨øy_size
];

369 
num_found
 = 
	`föd_ønge
–
roŸ
, 
key_°¨t
, 
key_íd
, 
vîbo£
,

370 
ªtu∫ed_keys
, 
ªtu∫ed_poöãrs
 );

371 i‡(!
num_found
)

372 
	`¥ötf
("None found.\n");

374 
i
 = 0; i < 
num_found
; i++)

375 
	`¥ötf
("Key: %d Location: %lx Value: %d\n",

376 
ªtu∫ed_keys
[
i
],

377 ()
ªtu∫ed_poöãrs
[
i
],

378 ((
ªc‹d
 *)

379 
ªtu∫ed_poöãrs
[
i
])->
vÆue
);

381 
	}
}

389 
	$föd_ønge
–
node
 * 
roŸ
, 
key_°¨t
, 
key_íd
, 
boﬁ
 
vîbo£
,

390 
ªtu∫ed_keys
[], * 
ªtu∫ed_poöãrs
[]) {

391 
i
, 
num_found
;

392 
num_found
 = 0;

393 
node
 * 
n
 = 
	`föd_Àaf
–
roŸ
, 
key_°¨t
, 
vîbo£
 );

394 i‡(
n
 =
NULL
)  0;

395 
i
 = 0; i < 
n
->
num_keys
 &&Ç->
keys
[i] < 
key_°¨t
; i++) ;

396 i‡(
i
 =
n
->
num_keys
)  0;

397 
n
 !
NULL
) {

398  ; 
i
 < 
n
->
num_keys
 &&Ç->
keys
[i] <
key_íd
; i++) {

399 
ªtu∫ed_keys
[
num_found
] = 
n
->
keys
[
i
];

400 
ªtu∫ed_poöãrs
[
num_found
] = 
n
->
poöãrs
[
i
];

401 
num_found
++;

403 
n
 =Ç->
poöãrs
[
‹dî
 - 1];

404 
i
 = 0;

406  
num_found
;

407 
	}
}

415 
node
 * 
	$föd_Àaf
–
node
 * 
roŸ
, 
key
, 
boﬁ
 
vîbo£
 ) {

416 
i
 = 0;

417 
node
 * 
c
 = 
roŸ
;

418 i‡(
c
 =
NULL
) {

419 i‡(
vîbo£
)

420 
	`¥ötf
("EmptyÅree.\n");

421  
c
;

423 !
c
->
is_Àaf
) {

424 i‡(
vîbo£
) {

425 
	`¥ötf
("[");

426 
i
 = 0; i < 
c
->
num_keys
 - 1; i++)

427 
	`¥ötf
("%d ", 
c
->
keys
[
i
]);

428 
	`¥ötf
("%d] ", 
c
->
keys
[
i
]);

430 
i
 = 0;

431 
i
 < 
c
->
num_keys
) {

432 i‡(
key
 >
c
->
keys
[
i
]) i++;

435 i‡(
vîbo£
)

436 
	`¥ötf
("%d ->\n", 
i
);

437 
c
 = (
node
 *)c->
poöãrs
[
i
];

439 i‡(
vîbo£
) {

440 
	`¥ötf
("Leaf [");

441 
i
 = 0; i < 
c
->
num_keys
 - 1; i++)

442 
	`¥ötf
("%d ", 
c
->
keys
[
i
]);

443 
	`¥ötf
("%d] ->\n", 
c
->
keys
[
i
]);

445  
c
;

446 
	}
}

452 
ªc‹d
 * 
	$föd_åì
–
node
 * 
roŸ
, 
key
, 
boﬁ
 
vîbo£
 ) {

453 
i
 = 0;

454 
node
 * 
c
 = 
	`föd_Àaf
–
roŸ
, 
key
, 
vîbo£
 );

455 i‡(
c
 =
NULL
)  NULL;

456 
i
 = 0; i < 
c
->
num_keys
; i++)

457 i‡(
c
->
keys
[
i
] =
key
) ;

458 i‡(
i
 =
c
->
num_keys
)

459  
NULL
;

461  (
ªc‹d
 *)
c
->
poöãrs
[
i
];

462 
	}
}

467 
	$cut
–
Àngth
 ) {

468 i‡(
Àngth
 % 2 == 0)

469  
Àngth
/2;

471  
Àngth
/2 + 1;

472 
	}
}

480 
ªc‹d
 * 
	$make_ªc‹d
(
vÆue
) {

481 
ªc‹d
 * 
√w_ªc‹d
 = (ªc‹d *)
	`mÆloc
((record));

482 i‡(
√w_ªc‹d
 =
NULL
) {

483 
	`≥º‹
("Record creation.");

484 
	`exô
(
EXIT_FAILURE
);

487 
√w_ªc‹d
->
vÆue
 = value;

489  
√w_ªc‹d
;

490 
	}
}

496 
node
 * 
	$make_node
( ) {

497 
node
 * 
√w_node
;

498 
√w_node
 = 
	`mÆloc
((
node
));

499 i‡(
√w_node
 =
NULL
) {

500 
	`≥º‹
("Node creation.");

501 
	`exô
(
EXIT_FAILURE
);

503 
√w_node
->
keys
 = 
	`mÆloc
–(
‹dî
 - 1) * () );

504 i‡(
√w_node
->
keys
 =
NULL
) {

505 
	`≥º‹
("NewÇode keysárray.");

506 
	`exô
(
EXIT_FAILURE
);

508 
√w_node
->
poöãrs
 = 
	`mÆloc
–
‹dî
 * (*) );

509 i‡(
√w_node
->
poöãrs
 =
NULL
) {

510 
	`≥º‹
("NewÇodeÖointersárray.");

511 
	`exô
(
EXIT_FAILURE
);

513 
√w_node
->
is_Àaf
 = 
Ál£
;

514 
√w_node
->
num_keys
 = 0;

515 
√w_node
->
∑ª¡
 = 
NULL
;

516 
√w_node
->
√xt
 = 
NULL
;

517  
√w_node
;

518 
	}
}

523 
node
 * 
	$make_Àaf
( ) {

524 
node
 * 
Àaf
 = 
	`make_node
();

525 
Àaf
->
is_Àaf
 = 
åue
;

526  
Àaf
;

527 
	}
}

534 
	$gë_À·_ödex
(
node
 * 
∑ª¡
,Çodê* 
À·
) {

536 
À·_ödex
 = 0;

537 
À·_ödex
 <
∑ª¡
->
num_keys
 &&

538 
∑ª¡
->
poöãrs
[
À·_ödex
] !
À·
)

539 
À·_ödex
++;

540  
À·_ödex
;

541 
	}
}

547 
node
 * 
	$ö£π_öto_Àaf
–
node
 * 
Àaf
, 
key
, 
ªc‹d
 * 
poöãr
 ) {

549 
i
, 
ö£πi⁄_poöt
;

551 
ö£πi⁄_poöt
 = 0;

552 
ö£πi⁄_poöt
 < 
Àaf
->
num_keys
 &&Üóf->
keys
[ö£πi⁄_poöt] < 
key
)

553 
ö£πi⁄_poöt
++;

555 
i
 = 
Àaf
->
num_keys
; i > 
ö£πi⁄_poöt
; i--) {

556 
Àaf
->
keys
[
i
] =Üeaf->keys[i - 1];

557 
Àaf
->
poöãrs
[
i
] =Üeaf->pointers[i - 1];

559 
Àaf
->
keys
[
ö£πi⁄_poöt
] = 
key
;

560 
Àaf
->
poöãrs
[
ö£πi⁄_poöt
] = 
poöãr
;

561 
Àaf
->
num_keys
++;

562  
Àaf
;

563 
	}
}

571 
node
 * 
	$ö£π_öto_Àaf_a·î_•lôtög
(
node
 * 
roŸ
,Çodê* 
Àaf
, 
key
, 
ªc‹d
 * 
poöãr
) {

573 
node
 * 
√w_Àaf
;

574 * 
ãmp_keys
;

575 ** 
ãmp_poöãrs
;

576 
ö£πi⁄_ödex
, 
•lô
, 
√w_key
, 
i
, 
j
;

578 
√w_Àaf
 = 
	`make_Àaf
();

580 
ãmp_keys
 = 
	`mÆloc
–
‹dî
 * () );

581 i‡(
ãmp_keys
 =
NULL
) {

582 
	`≥º‹
("Temporary keysárray.");

583 
	`exô
(
EXIT_FAILURE
);

586 
ãmp_poöãrs
 = 
	`mÆloc
–
‹dî
 * (*) );

587 i‡(
ãmp_poöãrs
 =
NULL
) {

588 
	`≥º‹
("TemporaryÖointersárray.");

589 
	`exô
(
EXIT_FAILURE
);

592 
ö£πi⁄_ödex
 = 0;

593 
ö£πi⁄_ödex
 < 
‹dî
 - 1 && 
Àaf
->
keys
[ö£πi⁄_ödex] < 
key
)

594 
ö£πi⁄_ödex
++;

596 
i
 = 0, 
j
 = 0; i < 
Àaf
->
num_keys
; i++, j++) {

597 i‡(
j
 =
ö£πi⁄_ödex
) j++;

598 
ãmp_keys
[
j
] = 
Àaf
->
keys
[
i
];

599 
ãmp_poöãrs
[
j
] = 
Àaf
->
poöãrs
[
i
];

602 
ãmp_keys
[
ö£πi⁄_ödex
] = 
key
;

603 
ãmp_poöãrs
[
ö£πi⁄_ödex
] = 
poöãr
;

605 
Àaf
->
num_keys
 = 0;

607 
•lô
 = 
	`cut
(
‹dî
 - 1);

609 
i
 = 0; i < 
•lô
; i++) {

610 
Àaf
->
poöãrs
[
i
] = 
ãmp_poöãrs
[i];

611 
Àaf
->
keys
[
i
] = 
ãmp_keys
[i];

612 
Àaf
->
num_keys
++;

615 
i
 = 
•lô
, 
j
 = 0; i < 
‹dî
; i++, j++) {

616 
√w_Àaf
->
poöãrs
[
j
] = 
ãmp_poöãrs
[
i
];

617 
√w_Àaf
->
keys
[
j
] = 
ãmp_keys
[
i
];

618 
√w_Àaf
->
num_keys
++;

621 
	`‰ì
(
ãmp_poöãrs
);

622 
	`‰ì
(
ãmp_keys
);

624 
√w_Àaf
->
poöãrs
[
‹dî
 - 1] = 
Àaf
->pointers[order - 1];

625 
Àaf
->
poöãrs
[
‹dî
 - 1] = 
√w_Àaf
;

627 
i
 = 
Àaf
->
num_keys
; i < 
‹dî
 - 1; i++)

628 
Àaf
->
poöãrs
[
i
] = 
NULL
;

629 
i
 = 
√w_Àaf
->
num_keys
; i < 
‹dî
 - 1; i++)

630 
√w_Àaf
->
poöãrs
[
i
] = 
NULL
;

632 
√w_Àaf
->
∑ª¡
 = 
Àaf
->parent;

633 
√w_key
 = 
√w_Àaf
->
keys
[0];

635  
	`ö£π_öto_∑ª¡
(
roŸ
, 
Àaf
, 
√w_key
, 
√w_Àaf
);

636 
	}
}

643 
node
 * 
	$ö£π_öto_node
(
node
 * 
roŸ
,Çodê* 
n
,

644 
À·_ödex
, 
key
, 
node
 * 
right
) {

645 
i
;

647 
i
 = 
n
->
num_keys
; i > 
À·_ödex
; i--) {

648 
n
->
poöãrs
[
i
 + 1] =Ç->pointers[i];

649 
n
->
keys
[
i
] =Ç->keys[i - 1];

651 
n
->
poöãrs
[
À·_ödex
 + 1] = 
right
;

652 
n
->
keys
[
À·_ödex
] = 
key
;

653 
n
->
num_keys
++;

654  
roŸ
;

655 
	}
}

662 
node
 * 
	$ö£π_öto_node_a·î_•lôtög
(
node
 * 
roŸ
,Çodê* 
ﬁd_node
, 
À·_ödex
,

663 
key
, 
node
 * 
right
) {

665 
i
, 
j
, 
•lô
, 
k_¥ime
;

666 
node
 * 
√w_node
, * 
chûd
;

667 * 
ãmp_keys
;

668 
node
 ** 
ãmp_poöãrs
;

679 
ãmp_poöãrs
 = 
	`mÆloc
–(
‹dî
 + 1Ë* (
node
 *) );

680 i‡(
ãmp_poöãrs
 =
NULL
) {

681 
	`≥º‹
("TemporaryÖointersárray for splittingÇodes.");

682 
	`exô
(
EXIT_FAILURE
);

684 
ãmp_keys
 = 
	`mÆloc
–
‹dî
 * () );

685 i‡(
ãmp_keys
 =
NULL
) {

686 
	`≥º‹
("Temporary keysárray for splittingÇodes.");

687 
	`exô
(
EXIT_FAILURE
);

690 
i
 = 0, 
j
 = 0; i < 
ﬁd_node
->
num_keys
 + 1; i++, j++) {

691 i‡(
j
 =
À·_ödex
 + 1) j++;

692 
ãmp_poöãrs
[
j
] = 
ﬁd_node
->
poöãrs
[
i
];

695 
i
 = 0, 
j
 = 0; i < 
ﬁd_node
->
num_keys
; i++, j++) {

696 i‡(
j
 =
À·_ödex
) j++;

697 
ãmp_keys
[
j
] = 
ﬁd_node
->
keys
[
i
];

700 
ãmp_poöãrs
[
À·_ödex
 + 1] = 
right
;

701 
ãmp_keys
[
À·_ödex
] = 
key
;

707 
•lô
 = 
	`cut
(
‹dî
);

708 
√w_node
 = 
	`make_node
();

709 
ﬁd_node
->
num_keys
 = 0;

710 
i
 = 0; i < 
•lô
 - 1; i++) {

711 
ﬁd_node
->
poöãrs
[
i
] = 
ãmp_poöãrs
[i];

712 
ﬁd_node
->
keys
[
i
] = 
ãmp_keys
[i];

713 
ﬁd_node
->
num_keys
++;

715 
ﬁd_node
->
poöãrs
[
i
] = 
ãmp_poöãrs
[i];

716 
k_¥ime
 = 
ãmp_keys
[
•lô
 - 1];

717 ++
i
, 
j
 = 0; i < 
‹dî
; i++, j++) {

718 
√w_node
->
poöãrs
[
j
] = 
ãmp_poöãrs
[
i
];

719 
√w_node
->
keys
[
j
] = 
ãmp_keys
[
i
];

720 
√w_node
->
num_keys
++;

722 
√w_node
->
poöãrs
[
j
] = 
ãmp_poöãrs
[
i
];

723 
	`‰ì
(
ãmp_poöãrs
);

724 
	`‰ì
(
ãmp_keys
);

725 
√w_node
->
∑ª¡
 = 
ﬁd_node
->parent;

726 
i
 = 0; i <
√w_node
->
num_keys
; i++) {

727 
chûd
 = 
√w_node
->
poöãrs
[
i
];

728 
chûd
->
∑ª¡
 = 
√w_node
;

736  
	`ö£π_öto_∑ª¡
(
roŸ
, 
ﬁd_node
, 
k_¥ime
, 
√w_node
);

737 
	}
}

744 
node
 * 
	$ö£π_öto_∑ª¡
(
node
 * 
roŸ
,Çodê* 
À·
, 
key
,Çodê* 
right
) {

746 
À·_ödex
;

747 
node
 * 
∑ª¡
;

749 
∑ª¡
 = 
À·
->parent;

753 i‡(
∑ª¡
 =
NULL
)

754  
	`ö£π_öto_√w_roŸ
(
À·
, 
key
, 
right
);

764 
À·_ödex
 = 
	`gë_À·_ödex
(
∑ª¡
, 
À·
);

770 i‡(
∑ª¡
->
num_keys
 < 
‹dî
 - 1)

771  
	`ö£π_öto_node
(
roŸ
, 
∑ª¡
, 
À·_ödex
, 
key
, 
right
);

777  
	`ö£π_öto_node_a·î_•lôtög
(
roŸ
, 
∑ª¡
, 
À·_ödex
, 
key
, 
right
);

778 
	}
}

785 
node
 * 
	$ö£π_öto_√w_roŸ
(
node
 * 
À·
, 
key
,Çodê* 
right
) {

787 
node
 * 
roŸ
 = 
	`make_node
();

788 
roŸ
->
keys
[0] = 
key
;

789 
roŸ
->
poöãrs
[0] = 
À·
;

790 
roŸ
->
poöãrs
[1] = 
right
;

791 
roŸ
->
num_keys
++;

792 
roŸ
->
∑ª¡
 = 
NULL
;

793 
À·
->
∑ª¡
 = 
roŸ
;

794 
right
->
∑ª¡
 = 
roŸ
;

795  
roŸ
;

796 
	}
}

803 
node
 * 
	$°¨t_√w_åì
(
key
, 
ªc‹d
 * 
poöãr
) {

805 
node
 * 
roŸ
 = 
	`make_Àaf
();

806 
roŸ
->
keys
[0] = 
key
;

807 
roŸ
->
poöãrs
[0] = 
poöãr
;

808 
roŸ
->
poöãrs
[
‹dî
 - 1] = 
NULL
;

809 
roŸ
->
∑ª¡
 = 
NULL
;

810 
roŸ
->
num_keys
++;

811  
roŸ
;

812 
	}
}

822 
node
 * 
	$ö£π_åì
–
node
 * 
roŸ
, 
key
, 
vÆue
 ) {

824 
ªc‹d
 * 
poöãr
;

825 
node
 * 
Àaf
;

831 i‡(
	`föd_åì
(
roŸ
, 
key
, 
Ál£
Ë!
NULL
)

832  
roŸ
;

837 
poöãr
 = 
	`make_ªc‹d
(
vÆue
);

844 i‡(
roŸ
 =
NULL
)

845  
	`°¨t_√w_åì
(
key
, 
poöãr
);

852 
Àaf
 = 
	`föd_Àaf
(
roŸ
, 
key
, 
Ál£
);

857 i‡(
Àaf
->
num_keys
 < 
‹dî
 - 1) {

858 
Àaf
 = 
	`ö£π_öto_Àaf
÷óf, 
key
, 
poöãr
);

859  
roŸ
;

866  
	`ö£π_öto_Àaf_a·î_•lôtög
(
roŸ
, 
Àaf
, 
key
, 
poöãr
);

867 
	}
}

880 
	$gë_√ighb‹_ödex
–
node
 * 
n
 ) {

882 
i
;

890 
i
 = 0; i <
n
->
∑ª¡
->
num_keys
; i++)

891 i‡(
n
->
∑ª¡
->
poöãrs
[
i
] ==Ç)

892  
i
 - 1;

895 
	`¥ötf
("Search forÇonexistentÖointerÅoÇode inÖarent.\n");

896 
	`¥ötf
("Node: %#lx\n", ()
n
);

897 
	`exô
(
EXIT_FAILURE
);

898 
	}
}

901 
node
 * 
	$ªmove_íåy_‰om_node
(
node
 * 
n
, 
key
,Çodê* 
poöãr
) {

903 
i
, 
num_poöãrs
;

906 
i
 = 0;

907 
n
->
keys
[
i
] !
key
)

908 
i
++;

909 ++
i
; i < 
n
->
num_keys
; i++)

910 
n
->
keys
[
i
 - 1] =Ç->keys[i];

914 
num_poöãrs
 = 
n
->
is_Àaf
 ?Ç->
num_keys
 :Ç->num_keys + 1;

915 
i
 = 0;

916 
n
->
poöãrs
[
i
] !
poöãr
)

917 
i
++;

918 ++
i
; i < 
num_poöãrs
; i++)

919 
n
->
poöãrs
[
i
 - 1] =Ç->pointers[i];

923 
n
->
num_keys
--;

927 i‡(
n
->
is_Àaf
)

928 
i
 = 
n
->
num_keys
; i < 
‹dî
 - 1; i++)

929 
n
->
poöãrs
[
i
] = 
NULL
;

931 
i
 = 
n
->
num_keys
 + 1; i < 
‹dî
; i++)

932 
n
->
poöãrs
[
i
] = 
NULL
;

934  
n
;

935 
	}
}

938 
node
 * 
	$adju°_roŸ
(
node
 * 
roŸ
) {

940 
node
 * 
√w_roŸ
;

947 i‡(
roŸ
->
num_keys
 > 0)

948  
roŸ
;

957 i‡(!
roŸ
->
is_Àaf
) {

958 
√w_roŸ
 = 
roŸ
->
poöãrs
[0];

959 
√w_roŸ
->
∑ª¡
 = 
NULL
;

966 
√w_roŸ
 = 
NULL
;

968 
	`‰ì
(
roŸ
->
keys
);

969 
	`‰ì
(
roŸ
->
poöãrs
);

970 
	`‰ì
(
roŸ
);

972  
√w_roŸ
;

973 
	}
}

982 
node
 * 
	$cﬂÀs˚_nodes
(
node
 * 
roŸ
,Çodê* 
n
,Çodê* 
√ighb‹
, 
√ighb‹_ödex
, 
k_¥ime
) {

984 
i
, 
j
, 
√ighb‹_ö£πi⁄_ödex
, 
n_íd
;

985 
node
 * 
tmp
;

991 i‡(
√ighb‹_ödex
 == -1) {

992 
tmp
 = 
n
;

993 
n
 = 
√ighb‹
;

994 
√ighb‹
 = 
tmp
;

1003 
√ighb‹_ö£πi⁄_ödex
 = 
√ighb‹
->
num_keys
;

1010 i‡(!
n
->
is_Àaf
) {

1015 
√ighb‹
->
keys
[
√ighb‹_ö£πi⁄_ödex
] = 
k_¥ime
;

1016 
√ighb‹
->
num_keys
++;

1019 
n_íd
 = 
n
->
num_keys
;

1021 
i
 = 
√ighb‹_ö£πi⁄_ödex
 + 1, 
j
 = 0; j < 
n_íd
; i++, j++) {

1022 
√ighb‹
->
keys
[
i
] = 
n
->keys[
j
];

1023 
√ighb‹
->
poöãrs
[
i
] = 
n
->poöãrs[
j
];

1024 
√ighb‹
->
num_keys
++;

1025 
n
->
num_keys
--;

1032 
√ighb‹
->
poöãrs
[
i
] = 
n
->poöãrs[
j
];

1037 
i
 = 0; i < 
√ighb‹
->
num_keys
 + 1; i++) {

1038 
tmp
 = (
node
 *)
√ighb‹
->
poöãrs
[
i
];

1039 
tmp
->
∑ª¡
 = 
√ighb‹
;

1050 
i
 = 
√ighb‹_ö£πi⁄_ödex
, 
j
 = 0; j < 
n
->
num_keys
; i++, j++) {

1051 
√ighb‹
->
keys
[
i
] = 
n
->keys[
j
];

1052 
√ighb‹
->
poöãrs
[
i
] = 
n
->poöãrs[
j
];

1053 
√ighb‹
->
num_keys
++;

1055 
√ighb‹
->
poöãrs
[
‹dî
 - 1] = 
n
->pointers[order - 1];

1058 
roŸ
 = 
	`dñëe_íåy
‘oŸ, 
n
->
∑ª¡
, 
k_¥ime
,Ç);

1059 
	`‰ì
(
n
->
keys
);

1060 
	`‰ì
(
n
->
poöãrs
);

1061 
	`‰ì
(
n
);

1062  
roŸ
;

1063 
	}
}

1072 
node
 * 
	$ªdi°ribuã_nodes
(
node
 * 
roŸ
,Çodê* 
n
,Çodê* 
√ighb‹
, 
√ighb‹_ödex
,

1073 
k_¥ime_ödex
, 
k_¥ime
) {

1075 
i
;

1076 
node
 * 
tmp
;

1083 i‡(
√ighb‹_ödex
 != -1) {

1084 i‡(!
n
->
is_Àaf
)

1085 
n
->
poöãrs
[n->
num_keys
 + 1] =Ç->pointers[n->num_keys];

1086 
i
 = 
n
->
num_keys
; i > 0; i--) {

1087 
n
->
keys
[
i
] =Ç->keys[i - 1];

1088 
n
->
poöãrs
[
i
] =Ç->pointers[i - 1];

1090 i‡(!
n
->
is_Àaf
) {

1091 
n
->
poöãrs
[0] = 
√ighb‹
->poöãrs[√ighb‹->
num_keys
];

1092 
tmp
 = (
node
 *)
n
->
poöãrs
[0];

1093 
tmp
->
∑ª¡
 = 
n
;

1094 
√ighb‹
->
poöãrs
[√ighb‹->
num_keys
] = 
NULL
;

1095 
n
->
keys
[0] = 
k_¥ime
;

1096 
n
->
∑ª¡
->
keys
[
k_¥ime_ödex
] = 
√ighb‹
->keys[√ighb‹->
num_keys
 - 1];

1099 
n
->
poöãrs
[0] = 
√ighb‹
->poöãrs[√ighb‹->
num_keys
 - 1];

1100 
√ighb‹
->
poöãrs
[√ighb‹->
num_keys
 - 1] = 
NULL
;

1101 
n
->
keys
[0] = 
√ighb‹
->keys[√ighb‹->
num_keys
 - 1];

1102 
n
->
∑ª¡
->
keys
[
k_¥ime_ödex
] =Ç->keys[0];

1113 i‡(
n
->
is_Àaf
) {

1114 
n
->
keys
[n->
num_keys
] = 
√ighb‹
->keys[0];

1115 
n
->
poöãrs
[n->
num_keys
] = 
√ighb‹
->pointers[0];

1116 
n
->
∑ª¡
->
keys
[
k_¥ime_ödex
] = 
√ighb‹
->keys[1];

1119 
n
->
keys
[n->
num_keys
] = 
k_¥ime
;

1120 
n
->
poöãrs
[n->
num_keys
 + 1] = 
√ighb‹
->pointers[0];

1121 
tmp
 = (
node
 *)
n
->
poöãrs
[n->
num_keys
 + 1];

1122 
tmp
->
∑ª¡
 = 
n
;

1123 
n
->
∑ª¡
->
keys
[
k_¥ime_ödex
] = 
√ighb‹
->keys[0];

1125 
i
 = 0; i < 
√ighb‹
->
num_keys
 - 1; i++) {

1126 
√ighb‹
->
keys
[
i
] =Çeighbor->keys[i + 1];

1127 
√ighb‹
->
poöãrs
[
i
] =Çeighbor->pointers[i + 1];

1129 i‡(!
n
->
is_Àaf
)

1130 
√ighb‹
->
poöãrs
[
i
] =Çeighbor->pointers[i + 1];

1137 
n
->
num_keys
++;

1138 
√ighb‹
->
num_keys
--;

1140  
roŸ
;

1141 
	}
}

1149 
node
 * 
	$dñëe_íåy
–
node
 * 
roŸ
,Çodê* 
n
, 
key
, * 
poöãr
 ) {

1151 
mö_keys
;

1152 
node
 * 
√ighb‹
;

1153 
√ighb‹_ödex
;

1154 
k_¥ime_ödex
, 
k_¥ime
;

1155 
ˇ∑côy
;

1159 
n
 = 
	`ªmove_íåy_‰om_node
“, 
key
, 
poöãr
);

1164 i‡(
n
 =
roŸ
)

1165  
	`adju°_roŸ
(
roŸ
);

1176 
mö_keys
 = 
n
->
is_Àaf
 ? 
	`cut
(
‹dî
 - 1) : cut(order) - 1;

1182 i‡(
n
->
num_keys
 >
mö_keys
)

1183  
roŸ
;

1197 
√ighb‹_ödex
 = 
	`gë_√ighb‹_ödex
–
n
 );

1198 
k_¥ime_ödex
 = 
√ighb‹_ödex
 == -1 ? 0 :Çeighbor_index;

1199 
k_¥ime
 = 
n
->
∑ª¡
->
keys
[
k_¥ime_ödex
];

1200 
√ighb‹
 = 
√ighb‹_ödex
 =-1 ? 
n
->
∑ª¡
->
poöãrs
[1] :

1201 
n
->
∑ª¡
->
poöãrs
[
√ighb‹_ödex
];

1203 
ˇ∑côy
 = 
n
->
is_Àaf
 ? 
‹dî
 : order - 1;

1207 i‡(
√ighb‹
->
num_keys
 + 
n
->num_key†< 
ˇ∑côy
)

1208  
	`cﬂÀs˚_nodes
(
roŸ
, 
n
, 
√ighb‹
, 
√ighb‹_ödex
, 
k_¥ime
);

1213  
	`ªdi°ribuã_nodes
(
roŸ
, 
n
, 
√ighb‹
, 
√ighb‹_ödex
, 
k_¥ime_ödex
, 
k_¥ime
);

1214 
	}
}

1220 
node
 * 
	$dñëe_åì
(
node
 * 
roŸ
, 
key
) {

1222 
node
 * 
key_Àaf
;

1223 
ªc‹d
 * 
key_ªc‹d
;

1225 
key_ªc‹d
 = 
	`föd_åì
(
roŸ
, 
key
, 
Ál£
);

1226 
key_Àaf
 = 
	`föd_Àaf
(
roŸ
, 
key
, 
Ál£
);

1227 i‡(
key_ªc‹d
 !
NULL
 && 
key_Àaf
 != NULL) {

1228 
roŸ
 = 
	`dñëe_íåy
‘oŸ, 
key_Àaf
, 
key
, 
key_ªc‹d
);

1229 
	`‰ì
(
key_ªc‹d
);

1231  
roŸ
;

1232 
	}
}

1235 
	$de°roy_åì_nodes
(
node
 * 
roŸ
) {

1236 
i
;

1237 i‡(
roŸ
->
is_Àaf
)

1238 
i
 = 0; i < 
roŸ
->
num_keys
; i++)

1239 
	`‰ì
(
roŸ
->
poöãrs
[
i
]);

1241 
i
 = 0; i < 
roŸ
->
num_keys
 + 1; i++)

1242 
	`de°roy_åì_nodes
(
roŸ
->
poöãrs
[
i
]);

1243 
	`‰ì
(
roŸ
->
poöãrs
);

1244 
	`‰ì
(
roŸ
->
keys
);

1245 
	`‰ì
(
roŸ
);

1246 
	}
}

1249 
node
 * 
	$de°roy_åì
(
node
 * 
roŸ
) {

1250 
	`de°roy_åì_nodes
(
roŸ
);

1251  
NULL
;

1252 
	}
}

1255 
	$öô_∑ge_li°
(){

1256 
hód
 = (
∑ge_li°
 *)
	`mÆloc
((page_list));

1257 
∑ge_li°
 *
√w
 = (∑ge_li° *)
	`mÆloc
((page_list));

1260 
hód
->
off£t
 = 4096;

1261 
hód
->
is_‰ì
 = 
åue
;

1262 
hód
->
√xt
 = 
√w
;

1263 
√w
->
off£t
 = 0;

1264 
√w
->
is_‰ì
 = 
Ál£
;

1265 
√w
->
√xt
 = 
NULL
;

1266 
	}
}

1270 
öt64_t
 
	$sˇn_‰ì_∑ge
(){

1271 
öt64_t
 
œ°_off£t
;

1272 
öt64_t
 
√xt_Â_off£t
 = 0;

1273 
∑ge_li°
 *
poöãr
;

1274 
∑ge_li°
 *
√w
;

1276 
poöãr
 = 
hód
;Öoöãr->
off£t
 !0 &&Öoöãr->
√xt
 !
NULL
;Öointer =Öointer->next){

1277 if(
poöãr
->
is_‰ì
 =
åue
){

1278  
poöãr
->
off£t
;

1280 
œ°_off£t
 = 
poöãr
->
off£t
;

1284 
poöãr
->
off£t
 = 
œ°_off£t
 + 4096;

1285 
poöãr
->
is_‰ì
 = 
åue
;

1286 
√w
 = (
∑ge_li°
 *)
	`mÆloc
((page_list));

1287 
√w
->
off£t
 = 0;

1288 
√w
->
is_‰ì
 = 
Ál£
;

1289 
poöãr
->
√xt
 = 
√w
;

1290 
√w
->
√xt
 = 
NULL
;

1293 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
poöãr
->
off£t
, 
SEEK_SET
);

1294 
	`fwrôe
(&
√xt_Â_off£t
, 8, 1, 
Â
);

1296  
poöãr
->
off£t
;

1297 
	}
}

1301 
öt64_t
 
	$sˇn_u£_∑ge
(){

1302 
öt64_t
 
cou¡
 = 0;

1303 
∑ge_li°
 *
poöãr
;

1305 
poöãr
 = 
hód
;Öoöãr->
off£t
 !0 &&Öoöãr->
√xt
 !
NULL
;Öointer =Öointer->next){

1306 if(
poöãr
->
is_‰ì
 =
Ál£
){

1307 
cou¡
++;

1311  
cou¡
;

1312 
	}
}

1318 
	$ch™ge_‰ì_∑ge
(
öt64_t
 
off£t
){

1319 
∑ge_li°
 *
poöãr
;

1321 
poöãr
 = 
hód
;Öoöãr->
off£t
 !0 &&Öoöãr->
√xt
 !
NULL
;Öointer =Öointer->next){

1322 if(
poöãr
->
off£t
 == offset){

1323 
poöãr
->
is_‰ì
 = 
Ál£
;

1326 
	}
}

1331 
	$vacuum_usög_∑ge
(
öt64_t
 
off£t
){

1332 
∑ge_li°
 *
poöãr
;

1335 
poöãr
 = 
hód
;Öoöãr->
off£t
 !0 &&Öoöãr->
√xt
 !
NULL
;Öointer =Öointer->next){

1336 if(
poöãr
->
off£t
 == offset){

1337 
poöãr
->
is_‰ì
 = 
åue
;

1340 
	}
}

1347 
	$öô_hódî_∑ge
(){

1348 
öt64_t
 
Â_off£t
 = 4096;

1350 
öt64_t
 
Ω_off£t
 = 0;

1351 
öt64_t
 
≤um
 = 1;

1357 
	`f£eko
(
Â
, 
deÁu…_off£t
, 
SEEK_SET
);

1358 
	`fwrôe
(&
Â_off£t
, 8, 1, 
Â
);

1359 
	`fwrôe
(&
Ω_off£t
, 8, 1, 
Â
);

1360 
	`fwrôe
(&
≤um
, 8, 1, 
Â
);

1361 
	}
}

1362 
	$modify_hódî_∑ge
(
öt64_t
 
Ω_off£t
){

1363 
öt64_t
 
Â_off£t
 = 
	`sˇn_‰ì_∑ge
();

1364 
öt64_t
 
≤um
 = 
	`sˇn_u£_∑ge
() + 1;

1367 
	`f£eko
(
Â
, 
deÁu…_off£t
, 
SEEK_SET
);

1368 
	`fwrôe
(&
Â_off£t
, 8, 1, 
Â
);

1369 
	`fwrôe
(&
Ω_off£t
, 8, 1, 
Â
);

1370 
	`fwrôe
(&
≤um
, 8, 1, 
Â
);

1371 
	}
}

1379 
	$›í_db
(*
∑th«me
){

1380 
Â
 = 
	`f›í
(
∑th«me
, "wb+");

1381 if(
Â
 =
NULL
){

1382 
	`Ârötf
(
°dîr
, "Error : fileÖath\n");

1383 
	`exô
(
EXIT_FAILURE
);

1387 
	`f£eko
(
Â
, 0, 
SEEK_END
);

1388 
deÁu…_off£t
 = 
	`·ñlo
(
Â
);

1391 
	`öô_∑ge_li°
();

1394 
	`öô_hódî_∑ge
();

1397 
	`fÊush
(
Â
);

1400 
	}
}

1403 
öt64_t
 
	$öô_Àaf_∑ge
(
öt64_t
 
off£t
){

1404 
öt64_t
 
p_off£t
 = 0;

1405 
öt64_t
 
rs_off£t
 = 0;

1406 
is_Àaf
 = 1;

1407 
num_keys
 = 0;

1409 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
, 
SEEK_SET
);

1411 
	`fwrôe
(&
p_off£t
, 8, 1, 
Â
);

1413 
	`fwrôe
(&
is_Àaf
, 4, 1, 
Â
);

1415 
	`fwrôe
(&
num_keys
, 4, 1, 
Â
);

1418 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 120, 
SEEK_SET
);

1420 
	`fwrôe
(&
rs_off£t
, 8, 1, 
Â
);

1422  
off£t
;

1423 
	}
}

1424 
öt64_t
 
	$öô_öã∫Æ_∑ge
(
öt64_t
 
off£t
, i¡64_à
p_off£t
){

1426 
is_Àaf
 = 0, 
num_keys
 = 0;

1428 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
, 
SEEK_SET
);

1430 
	`fwrôe
(&
p_off£t
, 8, 1, 
Â
);

1432 
	`fwrôe
(&
is_Àaf
, 4, 1, 
Â
);

1434 
	`fwrôe
(&
num_keys
, 4, 1, 
Â
);

1436  
off£t
;

1437 
	}
}

1438 
	$gë_À·_off£t
(
öt64_t
 
p_off£t
, i¡64_à
l_off£t
){

1439 
öt64_t
 
À·_off£t
 = 0, 
èrgë_off£t
;

1440 
num_keys
;

1443 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
p_off£t
 + 12, 
SEEK_SET
);

1444 
	`‰ód
(&
num_keys
, 4, 1, 
Â
);

1446 
À·_off£t
 <
num_keys
){

1448 if(
À·_off£t
 == 0)

1449 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
p_off£t
 + 120, 
SEEK_SET
);

1451 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
p_off£t
 + 128 + (
À·_off£t
-1)*16 + 8, 
SEEK_SET
);

1452 
	`‰ód
(&
èrgë_off£t
, 8, 1, 
Â
);

1454 if(
l_off£t
 =
èrgë_off£t
){

1457 
À·_off£t
++;

1460  
À·_off£t
;

1461 
	}
}

1462 
öt64_t
 
	$ö£π_öto_Àaf_∑ge
(
öt64_t
 
Àaf_off£t
, i¡64_à
key
, *
vÆue
){

1463 
i
, 
ö£πi⁄_poöt
, 
num_keys
;

1464 
öt64_t
 
èrgë_key
, 
ãmp_key
;

1465 
ãmp_vÆue
[120];

1468 
ö£πi⁄_poöt
 = 0;

1471 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
Àaf_off£t
 + 12, 
SEEK_SET
);

1472 
	`‰ód
(&
num_keys
, 4, 1, 
Â
);

1474 
ö£πi⁄_poöt
 < 
num_keys
){

1476 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
Àaf_off£t
 + 128 + 
ö£πi⁄_poöt
*128, 
SEEK_SET
);

1477 
	`‰ód
(&
èrgë_key
, 8, 1, 
Â
);

1478 if(
key
 <
èrgë_key
){

1481 
ö£πi⁄_poöt
++;

1485 
i
 = 
num_keys
; i > 
ö£πi⁄_poöt
; i--){

1486 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
Àaf_off£t
 + 128 + (
i
-1)*128, 
SEEK_SET
);

1487 
	`‰ód
(&
ãmp_key
, 8, 1, 
Â
);

1488 
	`‰ód
(&
ãmp_vÆue
, 1, 120, 
Â
);

1490 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
Àaf_off£t
 + 128 + (
i
)*128, 
SEEK_SET
);

1491 
	`fwrôe
(&
ãmp_key
, 8, 1, 
Â
);

1492 
	`fwrôe
(&
ãmp_vÆue
, 1, 120, 
Â
);

1496 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
Àaf_off£t
 + 128 + 
ö£πi⁄_poöt
*128, 
SEEK_SET
);

1497 
	`fwrôe
(&
key
, 8, 1, 
Â
);

1498 
	`fwrôe
(
vÆue
, 1, 120, 
Â
);

1501 
num_keys
++;

1502 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
Àaf_off£t
 + 12, 
SEEK_SET
);

1503 
	`fwrôe
(&
num_keys
, 4, 1, 
Â
);

1505  
Àaf_off£t
;

1506 
	}
}

1507 
öt64_t
 
	$ö£π_öto_Àaf_∑ge_a·î_•lôtög
(
öt64_t
 
Ω_off£t
, i¡64_à
Àaf_off£t
, i¡64_à
key
, *
vÆue
){

1508 
öt64_t
 
√w_Àaf_off£t
, *
ãmp_keys
, 
èrgë_key
, 
√w_key
, 
√w_rs_off£t
 = 0, 
p_off£t
;

1509 
ö£πi⁄_ödex
, 
•lô
, 
i
, 
j
, 
num_keys
, 
√w_num_keys
 = 0,
zîo
 = 0;

1510 **
ãmp_vÆues
;

1511 
zîo_v
[120];

1514 
i
 = 0; i < 120; i++){

1515 
zîo_v
[
i
] = 0;

1519 
√w_Àaf_off£t
 = 
	`öô_Àaf_∑ge
(
	`sˇn_‰ì_∑ge
());

1522 
	`ch™ge_‰ì_∑ge
(
√w_Àaf_off£t
);

1523 
	`modify_hódî_∑ge
(
Ω_off£t
);

1526 
ãmp_keys
 = (
öt64_t
 *)
	`mÆloc
(
Àaf_‹dî
 * (int64_t));

1527 
ãmp_vÆues
 =(**)
	`mÆloc
(
Àaf_‹dî
 * (*));

1529 
i
 = 0; i < 
Àaf_‹dî
; i++){

1530 
ãmp_vÆues
[
i
] = (*)
	`mÆloc
(() * 120);

1533 
ö£πi⁄_ödex
 = 0;

1536 
ö£πi⁄_ödex
 < 
Àaf_‹dî
 -1){

1538 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
Àaf_off£t
 + 128 + 128*
ö£πi⁄_ödex
, 
SEEK_SET
);

1539 
	`‰ód
(&
èrgë_key
, 8, 1, 
Â
);

1540 if(
èrgë_key
 >
key
){

1543 
ö£πi⁄_ödex
++;

1548 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
Àaf_off£t
 + 12, 
SEEK_SET
);

1549 
	`‰ód
(&
num_keys
, 4, 1, 
Â
);

1550 
i
 = 0, 
j
 = 0; i < 
num_keys
; i++, j++){

1551 if(
j
 =
ö£πi⁄_ödex
)

1552 
j
++;

1553 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
Àaf_off£t
 + 128 + 128*
i
, 
SEEK_SET
);

1554 
	`‰ód
((
ãmp_keys
+
j
), 8, 1, 
Â
);

1555 
	`‰ód
(*(
ãmp_vÆues
+
j
), 1, 120, 
Â
);

1558 
ãmp_keys
[
ö£πi⁄_ödex
] = 
key
;

1559 
	`memmove
(
ãmp_vÆues
[
ö£πi⁄_ödex
], 
vÆue
, 120);

1562 
num_keys
 = 0;

1563 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
Àaf_off£t
 + 12, 
SEEK_SET
);

1564 
	`fwrôe
(&
num_keys
, 4, 1, 
Â
);

1566 
•lô
 = 
	`cut
(
Àaf_‹dî
 - 1);

1569 
i
 = 0; i < 
•lô
; i++){

1570 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
Àaf_off£t
 + 128 + 128*
i
, 
SEEK_SET
);

1571 
	`fwrôe
((
ãmp_keys
+
i
), 8, 1, 
Â
);

1572 
	`fwrôe
(*(
ãmp_vÆues
+
i
), 1, 120, 
Â
);

1573 
num_keys
++;

1576 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
Àaf_off£t
 + 12, 
SEEK_SET
);

1577 
	`fwrôe
(&
num_keys
, 4, 1, 
Â
);

1579 
i
 = 
•lô
, 
j
 = 0; i < 
Àaf_‹dî
; i++, j++){

1580 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√w_Àaf_off£t
 + 128 + 128*
j
, 
SEEK_SET
);

1581 
	`fwrôe
((
ãmp_keys
+
i
), 8, 1, 
Â
);

1582 
	`fwrôe
(*(
ãmp_vÆues
+
i
), 1, 120, 
Â
);

1583 
√w_num_keys
++;

1586 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√w_Àaf_off£t
 + 12, 
SEEK_SET
);

1587 
	`fwrôe
(&
√w_num_keys
, 4, 1, 
Â
);

1590 
	`‰ì
(
ãmp_keys
);

1591 
i
 = 0; i < 
Àaf_‹dî
; i++){

1592 
	`‰ì
(
ãmp_vÆues
[
i
]);

1594 
	`‰ì
(
ãmp_vÆues
);

1598 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
Àaf_off£t
 + 120, 
SEEK_SET
);

1599 
	`fwrôe
(&
√w_Àaf_off£t
, 8, 1, 
Â
);

1601 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√w_Àaf_off£t
 + 120, 
SEEK_SET
);

1602 
	`fwrôe
(&
√w_rs_off£t
, 8, 1, 
Â
);

1605 
i
 = 
num_keys
; i < 
Àaf_‹dî
 - 1; i++){

1606 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
Àaf_off£t
 + 128 + 128*
i
, 
SEEK_SET
);

1607 
	`fwrôe
(&
zîo
, 8, 1, 
Â
);

1608 
	`fwrôe
(
zîo_v
, 1, 120, 
Â
);

1610 
i
 = 
√w_num_keys
; i < 
Àaf_‹dî
 - 1; i++){

1611 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√w_Àaf_off£t
 + 128 + 128*
i
, 
SEEK_SET
);

1612 
	`fwrôe
(&
zîo
, 8, 1, 
Â
);

1613 
	`fwrôe
(
zîo_v
, 1, 120, 
Â
);

1618 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
Àaf_off£t
, 
SEEK_SET
);

1619 
	`‰ód
(&
p_off£t
, 8, 1, 
Â
);

1620 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√w_Àaf_off£t
, 
SEEK_SET
);

1621 
	`fwrôe
(&
p_off£t
, 8, 1, 
Â
);

1623 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√w_Àaf_off£t
 + 128, 
SEEK_SET
);

1624 
	`‰ód
(&
√w_key
, 8, 1, 
Â
);

1627  
	`ö£π_öto_∑ª¡_∑ge
(
Ω_off£t
, 
Àaf_off£t
, 
√w_key
, 
√w_Àaf_off£t
);

1628 
	}
}

1629 
öt64_t
 
	$ö£π_öto_öã∫Æ_∑ge
(
öt64_t
 
Ω_off£t
, i¡64_à
p_off£t
, i¡64_à
À·_off£t
, i¡64_à
key
, i¡64_à
r_off£t
){

1630 
öt64_t
 
ãmp_key
, 
ãmp_off£t
;

1631 
num_keys
, 
i
;

1634 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
p_off£t
 + 12, 
SEEK_SET
);

1635 
	`‰ód
(&
num_keys
, 4, 1, 
Â
);

1639 if(
À·_off£t
 != 0){

1640 
i
 = 
num_keys
; i > (
À·_off£t
-1); i--){

1641 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
p_off£t
 + 128 + 
i
*16, 
SEEK_SET
);

1642 
	`‰ód
(&
ãmp_key
, 8, 1, 
Â
);

1643 
	`‰ód
(&
ãmp_off£t
, 8, 1, 
Â
);

1645 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
p_off£t
 + 128 + (
i
+1)*16, 
SEEK_SET
);

1646 
	`fwrôe
(&
ãmp_key
, 8, 1, 
Â
);

1647 
	`fwrôe
(&
ãmp_off£t
, 8, 1, 
Â
);

1652 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
p_off£t
 + 128 + (
À·_off£t
)*16, 
SEEK_SET
);

1653 
	`fwrôe
(&
key
, 8, 1, 
Â
);

1654 
	`fwrôe
(&
r_off£t
, 8, 1, 
Â
);

1657 
num_keys
++;

1658 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
p_off£t
 + 12, 
SEEK_SET
);

1659 
	`fwrôe
(&
num_keys
, 4, 1, 
Â
);

1661  
Ω_off£t
;

1662 
	}
}

1663 
öt64_t
 
	$ö£π_öto_öã∫Æ_∑ge_a·î_•lôtög
(
öt64_t
 
Ω_off£t
, i¡64_à
ﬁd_off£t
, 
À·_off£t
, i¡64_à
key
, i¡64_à
r_off£t
){

1664 
i
, 
j
, 
•lô
, 
ﬁd_num_keys
, 
√w_num_keys
;

1665 
öt64_t
 
k_¥ime
, *
ãmp_keys
, *
ãmp_off£ts
, 
√w_öã∫Æ_off£t
, 
chûd_off£t
, 
p_off£t
;

1668 
ãmp_keys
 = (
öt64_t
 *)
	`mÆloc
(
öã∫Æ_‹dî
 * (int64_t));

1669 
ãmp_off£ts
 = (
öt64_t
 *)
	`mÆloc
((
öã∫Æ_‹dî
 + 1) * (int64_t));

1673 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
ﬁd_off£t
 + 12, 
SEEK_SET
);

1674 
	`‰ód
(&
ﬁd_num_keys
, 4, 1, 
Â
);

1677 
i
 = 0, 
j
 = 0; i < 
ﬁd_num_keys
 + 1; i++, j++){

1678 if(
j
 =
À·_off£t
 + 1)

1679 
j
++;

1680 if(
i
 == 0)

1681 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
ﬁd_off£t
 + 120, 
SEEK_SET
);

1683 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
ﬁd_off£t
 + 128 + 8 + 16*(
i
-1), 
SEEK_SET
);

1685 
	`‰ód
((
ãmp_off£ts
+
j
), 8, 1, 
Â
);

1688 
i
 = 0, 
j
 = 0; i < 
ﬁd_num_keys
; i++, j++){

1689 if(
j
 =
À·_off£t
)

1690 
j
++;

1691 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
ﬁd_off£t
 + 128 + 16*
i
, 
SEEK_SET
);

1692 
	`‰ód
((
ãmp_keys
+
j
), 8, 1, 
Â
);

1694 
ãmp_off£ts
[
À·_off£t
 + 1] = 
r_off£t
;

1695 
ãmp_keys
[
À·_off£t
] = 
key
;

1699 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
ﬁd_off£t
, 
SEEK_SET
);

1700 
	`‰ód
(&
p_off£t
, 8, 1, 
Â
);

1702 
•lô
 = 
	`cut
(
öã∫Æ_‹dî
);

1704 
√w_öã∫Æ_off£t
 = 
	`öô_öã∫Æ_∑ge
(
	`sˇn_‰ì_∑ge
(), 
p_off£t
);

1706 
	`ch™ge_‰ì_∑ge
(
√w_öã∫Æ_off£t
);

1708 
	`modify_hódî_∑ge
(
Ω_off£t
);

1711 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√w_öã∫Æ_off£t
 + 12, 
SEEK_SET
);

1712 
	`‰ód
(&
√w_num_keys
, 4, 1, 
Â
);

1714 
i
 = 0; i < 
•lô
 - 1; i++){

1715 if(
i
 == 0){

1716 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
ﬁd_off£t
 + 120, 
SEEK_SET
);

1717 
	`fwrôe
((
ãmp_off£ts
 + 
i
), 8, 1, 
Â
);

1718 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
ﬁd_off£t
 + 128, 
SEEK_SET
);

1719 
	`fwrôe
((
ãmp_keys
 + 
i
), 8, 1, 
Â
);

1722 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
ﬁd_off£t
 + 128 + 16*(
i
-1Ë+ 8, 
SEEK_SET
);

1723 
	`fwrôe
((
ãmp_off£ts
 + 
i
), 8, 1, 
Â
);

1724 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
ﬁd_off£t
 + 128 + 16*(
i
-1), 
SEEK_SET
);

1725 
	`fwrôe
((
ãmp_keys
 + 
i
), 8, 1, 
Â
);

1727 
ﬁd_num_keys
++;

1729 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
ﬁd_off£t
 + 128 + 16*(
i
-1Ë+ 8, 
SEEK_SET
);

1730 
	`fwrôe
((
ãmp_off£ts
 + 
i
), 8, 1, 
Â
);

1731 
k_¥ime
 = 
ãmp_keys
[
•lô
 - 1];

1733 ++
i
, 
j
 = 0; i < 
öã∫Æ_‹dî
; i++, j++){

1734 if(
j
 == 0){

1735 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√w_öã∫Æ_off£t
 + 120, 
SEEK_SET
);

1736 
	`fwrôe
((
ãmp_off£ts
 + 
i
), 8, 1, 
Â
);

1737 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√w_öã∫Æ_off£t
 + 128, 
SEEK_SET
);

1738 
	`fwrôe
((
ãmp_keys
 + 
i
), 8, 1, 
Â
);

1741 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√w_öã∫Æ_off£t
 + 128 + 16*(
j
-1Ë+ 8, 
SEEK_SET
);

1742 
	`fwrôe
((
ãmp_off£ts
 + 
i
), 8, 1, 
Â
);

1743 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√w_öã∫Æ_off£t
 + 128 + 16*(
j
-1), 
SEEK_SET
);

1744 
	`fwrôe
((
ãmp_keys
 + 
i
), 8, 1, 
Â
);

1746 
√w_num_keys
;

1748 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√w_öã∫Æ_off£t
 + 128 + 16*(
j
-1Ë+ 8, 
SEEK_SET
);

1749 
	`fwrôe
((
ãmp_off£ts
 + 
i
), 8, 1, 
Â
);

1752 
	`‰ì
(
ãmp_keys
);

1753 
	`‰ì
(
ãmp_off£ts
);

1758 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
ﬁd_off£t
 + 12, 
SEEK_SET
);

1759 
	`fwrôe
(&
ﬁd_num_keys
, 4, 1, 
Â
);

1760 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√w_öã∫Æ_off£t
 + 12, 
SEEK_SET
);

1761 
	`fwrôe
(&
√w_num_keys
, 4, 1, 
Â
);

1764 
i
 = 0; i <
√w_num_keys
; i++){

1766 if(
i
 == 0){

1767 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√w_öã∫Æ_off£t
 + 120, 
SEEK_SET
);

1770 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√w_öã∫Æ_off£t
 + 128 + 16*(
i
-1Ë+ 8, 
SEEK_SET
);

1772 
	`‰ód
(&
chûd_off£t
, 8, 1, 
Â
);

1773 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
chûd_off£t
, 
SEEK_SET
);

1774 
	`fwrôe
(&
√w_öã∫Æ_off£t
, 8, 1, 
Â
);

1778  
	`ö£π_öto_∑ª¡_∑ge
(
Ω_off£t
, 
ﬁd_off£t
, 
k_¥ime
, 
√w_öã∫Æ_off£t
);

1779 
	}
}

1780 
öt64_t
 
	$ö£π_öto_∑ª¡_∑ge
(
öt64_t
 
Ω_off£t
, i¡64_à
l_off£t
, i¡64_à
key
, i¡64_à
r_off£t
){

1781 
öt64_t
 
À·_off£t
, 
p_off£t
;

1782 
num_keys
;

1785 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
l_off£t
, 
SEEK_SET
);

1786 
	`‰ód
(&
p_off£t
, 8, 1, 
Â
);

1790 if(
p_off£t
 == 0){

1791  
	`ö£π_öto_√w_roŸ_∑ge
(
l_off£t
, 
key
, 
r_off£t
);

1796 
À·_off£t
 = 
	`gë_À·_off£t
(
p_off£t
, 
l_off£t
);

1800 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
p_off£t
 + 12, 
SEEK_SET
);

1801 
	`‰ód
(&
num_keys
, 4, 1, 
Â
);

1803 if(
num_keys
 < 
öã∫Æ_‹dî
 -1)

1804  
	`ö£π_öto_öã∫Æ_∑ge
(
Ω_off£t
, 
p_off£t
, 
À·_off£t
, 
key
, 
r_off£t
);

1808  
	`ö£π_öto_öã∫Æ_∑ge_a·î_•lôtög
(
Ω_off£t
, 
p_off£t
, 
À·_off£t
, 
key
, 
r_off£t
);

1809 
	}
}

1810 
öt64_t
 
	$ö£π_öto_√w_roŸ_∑ge
(
öt64_t
 
l_off£t
, i¡64_à
key
, i¡64_à
r_off£t
){

1811 
öt64_t
 
√w_Ω_off£t
 = 
	`sˇn_‰ì_∑ge
();

1812 
öt64_t
 
p_off£t
 = 0;

1813 
is_Àaf
 = 0, 
num_keys
 = 1;

1817 
	`ch™ge_‰ì_∑ge
(
√w_Ω_off£t
);

1818 
	`modify_hódî_∑ge
(
√w_Ω_off£t
);

1821 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√w_Ω_off£t
, 
SEEK_SET
);

1823 
	`fwrôe
(&
p_off£t
, 8, 1, 
Â
);

1824 
	`fwrôe
(&
is_Àaf
, 4, 1, 
Â
);

1825 
	`fwrôe
(&
num_keys
, 4, 1, 
Â
);

1828 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√w_Ω_off£t
 + 120, 
SEEK_SET
);

1830 
	`fwrôe
(&
l_off£t
, 8, 1, 
Â
);

1833 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√w_Ω_off£t
 + 128, 
SEEK_SET
);

1835 
	`fwrôe
(&
key
, 8, 1, 
Â
);

1837 
	`fwrôe
(&
r_off£t
, 8, 1, 
Â
);

1840 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
l_off£t
, 
SEEK_SET
);

1841 
	`fwrôe
(&
√w_Ω_off£t
, 8, 1, 
Â
);

1844 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
r_off£t
, 
SEEK_SET
);

1845 
	`fwrôe
(&
√w_Ω_off£t
, 8, 1, 
Â
);

1847  
√w_Ω_off£t
;

1848 
	}
}

1852 
öt64_t
 
	$°¨t_√w_åì_∑ge
(
öt64_t
 
key
, *
vÆue
){

1854 
öt64_t
 
Ω_off£t
 = 
	`sˇn_‰ì_∑ge
();

1855 
num_keys
;

1858 
	`öô_Àaf_∑ge
(
Ω_off£t
);

1860 
	`ch™ge_‰ì_∑ge
(
Ω_off£t
);

1862 
	`modify_hódî_∑ge
(
Ω_off£t
);

1865 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
Ω_off£t
 + 128, 
SEEK_SET
);

1866 
	`fwrôe
(&
key
, 8, 1, 
Â
);

1867 
	`fwrôe
(
vÆue
, 1, 120, 
Â
);

1870 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
Ω_off£t
 + 12, 
SEEK_SET
);

1871 
	`‰ód
(&
num_keys
, 4, 1, 
Â
);

1872 
num_keys
++;

1873 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
Ω_off£t
 + 12, 
SEEK_SET
);

1874 
	`fwrôe
(&
num_keys
, 4, 1, 
Â
);

1877  
Ω_off£t
;

1878 
	}
}

1884 
	$ö£π
(
öt64_t
 
key
, *
vÆue
){

1885 
öt64_t
 
Ω_off£t
,
Õ_off£t
;

1886 
num_keys
;

1889 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 8, 
SEEK_SET
);

1890 
	`‰ód
(&
Ω_off£t
, 8, 1, 
Â
);

1893 if(
	`föd
(
key
Ë!
NULL
)

1902 if(
Ω_off£t
 == 0){

1904 
Ω_off£t
 = 
	`°¨t_√w_åì_∑ge
(
key
, 
vÆue
);

1907 
	`fÊush
(
Â
);

1915 
Õ_off£t
 = 
	`föd_Àaf_∑ge
(
Ω_off£t
, 
key
);

1920 
	`f£eko
(
Â
, 
deÁu…_off£t
+
Õ_off£t
+12, 
SEEK_SET
);

1921 
	`‰ód
(&
num_keys
, 4, 1, 
Â
);

1923 if(
num_keys
 < 
Àaf_‹dî
 - 1){

1925 
	`ö£π_öto_Àaf_∑ge
(
Õ_off£t
, 
key
, 
vÆue
);

1927 
	`fÊush
(
Â
);

1934 
	`ö£π_öto_Àaf_∑ge_a·î_•lôtög
(
Ω_off£t
, 
Õ_off£t
, 
key
, 
vÆue
);

1936 
	`fÊush
(
Â
);

1938 
	}
}

1945 
	$Àaf_∑ge_judge
(
öt64_t
 
off£t
){

1946 
is_Àaf
;

1949 
	`f£eko
(
Â
, 
deÁu…_off£t
+
off£t
+8, 
SEEK_SET
);

1950 
	`‰ód
(&
is_Àaf
, 4, 1, 
Â
);

1952 if(
is_Àaf
)

1956 
	}
}

1961 
öt64_t
 
	$föd_Àaf_∑ge
(
öt64_t
 
Ω_off£t
, i¡64_à
key
){

1962 
öt64_t
 
off£t
 = 
Ω_off£t
, 
èrgë_key
, 
ãmp
;

1963 
num_keys
,
i
 = 0;

1966 if(
off£t
 == 0){

1967  
off£t
;

1969 !
	`Àaf_∑ge_judge
(
off£t
)){

1970 
i
 = 0;

1972 
	`f£eko
(
Â
, 
deÁu…_off£t
+
off£t
+12, 
SEEK_SET
);

1973 
	`‰ód
(&
num_keys
, 4, 1, 
Â
);

1975 
i
 < 
num_keys
){

1977 
	`f£eko
(
Â
, 
deÁu…_off£t
+
off£t
+128+(16*
i
), 
SEEK_SET
);

1978 
	`‰ód
(&
èrgë_key
, 8, 1, 
Â
);

1980 if(
key
 >
èrgë_key
)

1981 
i
++;

1986 if(
i
==0){

1987 
	`f£eko
(
Â
, 
deÁu…_off£t
+
off£t
+120, 
SEEK_SET
);

1988 
	`‰ód
(&
ãmp
, 8, 1, 
Â
);

1991 
	`f£eko
(
Â
, 
deÁu…_off£t
+
off£t
+128+(16*(
i
-1))+8, 
SEEK_SET
);

1992 
	`‰ód
(&
ãmp
, 8, 1, 
Â
);

1994 
off£t
 = 
ãmp
;

1997  
off£t
;

1998 
	}
}

2003 * 
	$föd
(
öt64_t
 
key
){

2004 
öt64_t
 
Ω_off£t
,
Õ_off£t
,
èrgë_key
;

2005 
i
 = 0, 
num_keys
;

2006 *
vÆue
;

2009 
vÆue
 = (*)
	`mÆloc
(120*());

2012 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 8, 
SEEK_SET
);

2013 
	`‰ód
(&
Ω_off£t
, 8, 1, 
Â
);

2016 
Õ_off£t
 = 
	`föd_Àaf_∑ge
(
Ω_off£t
, 
key
);

2019 if(
Õ_off£t
 == 0){

2020 
	`‰ì
(
vÆue
);

2021  
NULL
;

2025 
	`f£eko
(
Â
, 
deÁu…_off£t
+
Õ_off£t
+12, 
SEEK_SET
);

2026 
	`‰ód
(&
num_keys
, 4, 1, 
Â
);

2028 
i
 = 0; i < 
num_keys
; i++){

2030 
	`f£eko
(
Â
, 
deÁu…_off£t
+
Õ_off£t
+128+(
i
*128), 
SEEK_SET
);

2031 
	`‰ód
(&
èrgë_key
, 8, 1, 
Â
);

2033 if(
èrgë_key
 =
key
)

2036 if(
i
 =
num_keys
){

2037 
	`‰ì
(
vÆue
);

2038  
NULL
;

2042 
	`f£eko
(
Â
, 
deÁu…_off£t
+
Õ_off£t
+128+(
i
*128)+8, 
SEEK_SET
);

2043 
	`‰ód
(
vÆue
, 1, 120, 
Â
);

2045  
vÆue
;

2048 
	}
}

2052 
	$gë_√ighb‹_∑ge_ödex
(
öt64_t
 
off£t
){

2053 
i
,
num_keys
;

2054 
öt64_t
 
p_off£t
, 
èrgë_off£t
;

2057 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
, 
SEEK_SET
);

2058 
	`‰ód
(&
p_off£t
, 8, 1, 
Â
);

2061 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
p_off£t
 + 12, 
SEEK_SET
);

2062 
	`‰ód
(&
num_keys
, 4, 1, 
Â
);

2065 
i
 = 0; i <
num_keys
; i++){

2067 if(
i
 == 0){

2068 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
p_off£t
 + 120, 
SEEK_SET
);

2071 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
p_off£t
 + 128 + 16*(
i
-1Ë+ 8, 
SEEK_SET
);

2073 
	`‰ód
(&
èrgë_off£t
, 8, 1, 
Â
);

2075 if(
èrgë_off£t
 =
off£t
){

2076  
i
 -1;

2081 
	`exô
(
EXIT_FAILURE
);

2082 
	}
}

2083 
öt64_t
 
	$ªmove_íåy_‰om_∑ge
(
öt64_t
 
off£t
, i¡64_à
key
, *
vÆue
, i¡64_à
key_off£t
){

2084 
i
, 
num_off_vÆues
, 
is_Àaf
, 
num_keys
;

2085 
öt64_t
 
èrgë_key
, 
èrgë_off£t
, 
ãmp_off£t
, 
ãmp_key
;

2086 
èrgë_vÆue
[120], 
ãmp_vÆue
[120];

2087 
zîo
[120];

2088 
öt64_t
 
zîo_64
 = 0;

2091 
i
 = 0; i < 120; i++){

2092 
zîo
[
i
] = 0;

2096 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 8, 
SEEK_SET
);

2097 
	`‰ód
(&
is_Àaf
, 4, 1, 
Â
);

2100 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 12, 
SEEK_SET
);

2101 
	`‰ód
(&
num_keys
, 4, 1, 
Â
);

2104 
i
 = 0;

2106 if(
is_Àaf
){

2108 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128 + 128*
i
, 
SEEK_SET
);

2109 
	`‰ód
(&
èrgë_key
, 8, 1, 
Â
);

2110 
èrgë_key
 !
key
){

2111 
i
++;

2112 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128 + 128*
i
, 
SEEK_SET
);

2113 
	`‰ód
(&
èrgë_key
, 8, 1, 
Â
);

2115 ++
i
; i < 
num_keys
; i++){

2116 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128 + 128*
i
, 
SEEK_SET
);

2117 
	`‰ód
(&
ãmp_key
, 8, 1, 
Â
);

2119 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128 + 128*(
i
-1), 
SEEK_SET
);

2120 
	`fwrôe
(&
ãmp_key
, 8, 1, 
Â
);

2126 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128 + 16*
i
, 
SEEK_SET
);

2127 
	`‰ód
(&
èrgë_key
, 8, 1, 
Â
);

2128 
èrgë_key
 !
key
){

2129 
i
++;

2130 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128 + 16*
i
, 
SEEK_SET
);

2131 
	`‰ód
(&
èrgë_key
, 8, 1, 
Â
);

2133 ++
i
; i < 
num_keys
; i++){

2134 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128 + 16*
i
, 
SEEK_SET
);

2135 
	`‰ód
(&
ãmp_key
, 8, 1, 
Â
);

2137 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128 + 16*(
i
-1), 
SEEK_SET
);

2138 
	`fwrôe
(&
ãmp_key
, 8, 1, 
Â
);

2144 
num_off_vÆues
 = 
is_Àaf
 ? 
num_keys
 :Çum_keys + 1;

2145 
i
 = 0;

2147 if(
is_Àaf
){

2149 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128 + 128*
i
 + 8, 
SEEK_SET
);

2150 
	`‰ód
(&
èrgë_vÆue
, 1, 120, 
Â
);

2151 !
	`°rcmp
(
èrgë_vÆue
, 
vÆue
)){

2152 
i
++;

2153 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128 + 128*
i
 + 8, 
SEEK_SET
);

2154 
	`‰ód
(&
èrgë_vÆue
, 1, 120, 
Â
);

2156 ++
i
; i < 
num_off_vÆues
; i++){

2157 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128 + 128*
i
 + 8, 
SEEK_SET
);

2158 
	`‰ód
(&
ãmp_vÆue
, 1, 120, 
Â
);

2160 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128 + 128*(
i
-1Ë+ 8, 
SEEK_SET
);

2161 
	`fwrôe
(&
ãmp_vÆue
, 1, 120, 
Â
);

2168 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 120, 
SEEK_SET
);

2169 
	`‰ód
(&
èrgë_off£t
, 8, 1, 
Â
);

2170 
key_off£t
 !
èrgë_off£t
){

2171 
i
++;

2172 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128 + 16*(
i
-1Ë+ 8, 
SEEK_SET
);

2173 
	`‰ód
(&
èrgë_off£t
, 8, 1, 
Â
);

2175 ++
i
; i < 
num_off_vÆues
; i++){

2176 if(
i
 == 1){

2177 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128 + 16*(
i
-1Ë+ 8, 
SEEK_SET
);

2178 
	`‰ód
(&
ãmp_off£t
, 8, 1, 
Â
);

2180 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 120, 
SEEK_SET
);

2181 
	`fwrôe
(&
ãmp_off£t
, 8, 1, 
Â
);

2184 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128 + 16*(
i
-1Ë+ 8, 
SEEK_SET
);

2185 
	`‰ód
(&
ãmp_off£t
, 8, 1, 
Â
);

2187 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128 + 16*(
i
-2Ë+ 8, 
SEEK_SET
);

2188 
	`fwrôe
(&
ãmp_off£t
, 8, 1, 
Â
);

2194 
num_keys
--;

2196 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 12, 
SEEK_SET
);

2197 
	`fwrôe
(&
num_keys
, 4, 1, 
Â
);

2200 if(
is_Àaf
){

2201 
i
 = 
num_keys
; i < 
Àaf_‹dî
 - 1; i++){

2202 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128 + 128*
i
 + 8, 
SEEK_SET
);

2203 
	`fwrôe
(
zîo
, 1, 120, 
Â
);

2207 
i
 = 
num_keys
 + 1; i < 
öã∫Æ_‹dî
; i++){

2208 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128 + 16*(
i
-1Ë+ 8, 
SEEK_SET
);

2209 
	`fwrôe
(&
zîo_64
, 8, 1, 
Â
);

2213  
off£t
;

2214 
	}
}

2215 
öt64_t
 
	$adju°_roŸ_∑ge
(
öt64_t
 
Ω_off£t
){

2216 
öt64_t
 
√w_Ω_off£t
, 
p_off£t
 = 0;

2217 
num_keys
, 
is_Àaf
;

2221 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
Ω_off£t
 + 12, 
SEEK_SET
);

2222 
	`‰ód
(&
num_keys
, 4, 1, 
Â
);

2224 if(
num_keys
 > 0)

2225  
Ω_off£t
;

2229 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
Ω_off£t
 + 8, 
SEEK_SET
);

2230 
	`‰ód
(&
is_Àaf
, 4, 1, 
Â
);

2232 if(!
is_Àaf
){

2235 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
Ω_off£t
 + 120, 
SEEK_SET
);

2236 
	`‰ód
(&
√w_Ω_off£t
, 8, 1, 
Â
);

2239 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√w_Ω_off£t
, 
SEEK_SET
);

2240 
	`fwrôe
(&
p_off£t
, 8, 1, 
Â
);

2243 
	`modify_hódî_∑ge
(
√w_Ω_off£t
);

2248 
√w_Ω_off£t
 = 0;

2250 
	`modify_hódî_∑ge
(
√w_Ω_off£t
);

2253  
√w_Ω_off£t
;

2254 
	}
}

2255 
öt64_t
 
	$cﬂÀs˚_∑ges
(
öt64_t
 
Ω_off£t
, i¡64_à
off£t
, i¡64_à
√ighb‹_off£t
, 
√ighb‹_ödex
, i¡64_à
k_¥ime
){

2256 
i
, 
j
, 
√ighb‹_ö£πi⁄_ödex
, 
off£t_íd
, 
is_Àaf
, 
num_keys
 = 0, 
√ighb‹_num_keys
 = 0;

2257 
öt64_t
 
ãmp_key
, 
ãmp_off£t
, 
p_off£t
;

2258 
ãmp_vÆue
[120];

2259 
zîo
[4096];

2262 
i
 = 0; i < 4096; i++){

2263 
zîo
[
i
] = 0;

2267 if(
√ighb‹_ödex
 == -1){

2268 
ãmp_off£t
 = 
off£t
;

2269 
off£t
 = 
√ighb‹_off£t
;

2270 
√ighb‹_off£t
 = 
ãmp_off£t
;

2274 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 8, 
SEEK_SET
);

2275 
	`‰ód
(&
is_Àaf
, 4, 1, 
Â
);

2278 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√ighb‹_off£t
 + 12, 
SEEK_SET
);

2279 
	`‰ód
(&
√ighb‹_num_keys
, 4, 1, 
Â
);

2281 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 12, 
SEEK_SET
);

2282 
	`‰ód
(&
num_keys
, 4, 1, 
Â
);

2284 
√ighb‹_ö£πi⁄_ödex
 = 
√ighb‹_num_keys
;

2287 if(!
is_Àaf
){

2289 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√ighb‹_off£t
 + 128 + 16*(
√ighb‹_ö£πi⁄_ödex
), 
SEEK_SET
);

2290 
	`fwrôe
(&
k_¥ime
, 8, 1, 
Â
);

2292 
√ighb‹_num_keys
++;

2294 
off£t_íd
 = 
num_keys
;

2296 
i
 = 
√ighb‹_ö£πi⁄_ödex
 + 1, 
j
 = 0; j < 
off£t_íd
; i++, j++){

2299 if(
j
 == 0){

2300 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 120, 
SEEK_SET
);

2301 
	`‰ód
(&
ãmp_off£t
, 8, 1, 
Â
);

2304 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128 + 16*(
j
-1Ë+ 8, 
SEEK_SET
);

2305 
	`‰ód
(&
ãmp_off£t
, 8, 1, 
Â
);

2308 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128 + 16*
j
, 
SEEK_SET
);

2309 
	`‰ód
(&
ãmp_key
, 8, 1, 
Â
);

2313 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√ighb‹_off£t
 + 128 + 16*(
i
-1Ë+ 8, 
SEEK_SET
);

2314 
	`fwrôe
(&
ãmp_off£t
, 8, 1, 
Â
);

2316 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√ighb‹_off£t
 + 128 + 16*
i
, 
SEEK_SET
);

2317 
	`fwrôe
(&
ãmp_key
, 8, 1, 
Â
);

2319 
√ighb‹_num_keys
++;

2320 
num_keys
--;

2323 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128 + 16*(
j
-1Ë+ 8, 
SEEK_SET
);

2324 
	`‰ód
(&
ãmp_off£t
, 8, 1, 
Â
);

2326 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√ighb‹_off£t
 + 128 + 16*(
i
-1Ë+ 8, 
SEEK_SET
);

2327 
	`fwrôe
(&
ãmp_off£t
, 8, 1, 
Â
);

2331 
i
 = 0; i < 
√ighb‹_num_keys
 + 1; i++){

2332 if(
i
 == 0){

2333 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√ighb‹_off£t
 + 120, 
SEEK_SET
);

2334 
	`‰ód
(&
ãmp_off£t
, 8, 1, 
Â
);

2337 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√ighb‹_off£t
 + 128 + 16*(
i
-1Ë+ 8, 
SEEK_SET
);

2338 
	`‰ód
(&
ãmp_off£t
, 8, 1, 
Â
);

2342 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
ãmp_off£t
, 
SEEK_SET
);

2343 
	`fwrôe
(&
ãmp_off£t
, 8, 1, 
Â
);

2346 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√ighb‹_off£t
 + 12, 
SEEK_SET
);

2347 
	`fwrôe
(&
√ighb‹_num_keys
, 4, 1, 
Â
);

2351 
i
 = 
√ighb‹_ö£πi⁄_ödex
, 
j
 = 0; j < 
num_keys
; i++, j++){

2353 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128 + 
j
*128, 
SEEK_SET
);

2354 
	`‰ód
(&
ãmp_key
, 8, 1, 
Â
);

2355 
	`‰ód
(
ãmp_vÆue
, 1, 120, 
Â
);

2358 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√ighb‹_off£t
 + 128 + 
i
*128, 
SEEK_SET
);

2359 
	`fwrôe
(&
ãmp_key
, 8, 1, 
Â
);

2360 
	`fwrôe
(
ãmp_vÆue
, 1, 120 , 
Â
);

2363 
√ighb‹_num_keys
++;

2366 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 120, 
SEEK_SET
);

2367 
	`‰ód
(&
ãmp_off£t
, 8, 1, 
Â
);

2368 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√ighb‹_off£t
 + 120, 
SEEK_SET
);

2369 
	`fwrôe
(&
ãmp_off£t
, 8, 1, 
Â
);

2372 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√ighb‹_off£t
 + 12, 
SEEK_SET
);

2373 
	`fwrôe
(&
√ighb‹_num_keys
, 4, 1, 
Â
);

2376 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
, 
SEEK_SET
);

2377 
	`‰ód
(&
p_off£t
, 8, 1, 
Â
);

2379 
	`dñëe_íåy_‰om_∑ge
(
Ω_off£t
, 
p_off£t
, 
k_¥ime
, 
NULL
, 
off£t
);

2382 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
, 
SEEK_SET
);

2383 
	`fwrôe
(
zîo
, 1, 4096, 
Â
);

2384 
	`vacuum_usög_∑ge
(
off£t
);

2386  
Ω_off£t
;

2387 
	}
}

2388 
öt64_t
 
	$ªdi°ribuã_∑ges
(
öt64_t
 
Ω_off£t
, i¡64_à
off£t
, i¡64_à
√ighb‹_off£t
, 
√ighb‹_ödex
, 
k_¥ime_ödex
, i¡64_à
k_¥ime
){

2389 
i
, 
is_Àaf
, 
num_keys
, 
√ighb‹_num_keys
;

2390 
öt64_t
 
ãmp_off£t
, 
ãmp_key
, 
p_off£t
, 
zîo_64
 = 0;

2391 
ãmp_vÆue
[120], 
zîo
[120];

2394 
i
 = 0; i < 120; i++){

2395 
zîo
[
i
] = 0;

2399 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 8, 
SEEK_SET
);

2400 
	`‰ód
(&
is_Àaf
, 4, 1, 
Â
);

2402 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 12, 
SEEK_SET
);

2403 
	`‰ód
(&
num_keys
, 4, 1, 
Â
);

2405 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√ighb‹_off£t
 + 12, 
SEEK_SET
);

2406 
	`‰ód
(&
√ighb‹_num_keys
, 4, 1, 
Â
);

2409 if(
√ighb‹_ödex
 != -1){

2411 if(!
is_Àaf
){

2412 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128 + 16*(
num_keys
-1Ë+ 8, 
SEEK_SET
);

2413 
	`‰ód
(&
ãmp_off£t
, 8, 1, 
Â
);

2415 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128 + 16*(
num_keys
Ë+ 8, 
SEEK_SET
);

2416 
	`fwrôe
(&
ãmp_off£t
, 8, 1, 
Â
);

2418 
i
 = 
num_keys
; i > 0; i--){

2421 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128 + 16*(
i
-1), 
SEEK_SET
);

2422 
	`‰ód
(&
ãmp_key
, 8, 1, 
Â
);

2423 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128 + 16*
i
, 
SEEK_SET
);

2424 
	`fwrôe
(&
ãmp_key
, 8, 1, 
Â
);

2427 if(
i
 - 1 == 0){

2428 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 120, 
SEEK_SET
);

2429 
	`‰ód
(&
ãmp_off£t
, 8, 1, 
Â
);

2432 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128 + 16*(
i
-2Ë+ 8, 
SEEK_SET
);

2433 
	`‰ód
(&
ãmp_off£t
, 8, 1, 
Â
);

2435 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128 + 16*(
i
-1Ë+ 8, 
SEEK_SET
);

2436 
	`fwrôe
(&
ãmp_off£t
, 8, 1, 
Â
);

2439 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√ighb‹_off£t
 + 128 + 16*(
√ighb‹_num_keys
 - 1Ë+ 8, 
SEEK_SET
);

2440 
	`‰ód
(&
ãmp_off£t
, 8, 1, 
Â
);

2443 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 120, 
SEEK_SET
);

2444 
	`fwrôe
(&
ãmp_off£t
, 8, 1, 
Â
);

2447 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
ãmp_off£t
, 
SEEK_SET
);

2448 
	`fwrôe
(&
off£t
, 8, 1, 
Â
);

2451 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√ighb‹_off£t
 + 128 + 16*(
√ighb‹_num_keys
 -1Ë+ 8, 
SEEK_SET
);

2452 
	`fwrôe
(&
zîo_64
, 8, 1, 
Â
);

2455 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128, 
SEEK_SET
);

2456 
	`fwrôe
(&
k_¥ime
, 8, 1, 
Â
);

2460 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
, 
SEEK_SET
);

2461 
	`‰ód
(&
p_off£t
, 8, 1, 
Â
);

2464 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√ighb‹_off£t
 + 128 + 16*(
√ighb‹_num_keys
-1), 
SEEK_SET
);

2465 
	`‰ód
(&
ãmp_key
, 8, 1, 
Â
);

2468 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
p_off£t
 + 128 + 16*(
k_¥ime_ödex
), 
SEEK_SET
);

2469 
	`fwrôe
(&
ãmp_key
, 8, 1, 
Â
);

2473 
i
 = 
num_keys
; i > 0; i--){

2475 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128 + 128*(
i
-1), 
SEEK_SET
);

2476 
	`‰ód
(&
ãmp_key
, 8, 1, 
Â
);

2477 
	`‰ód
(
ãmp_vÆue
, 1, 120, 
Â
);

2479 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128 + 128*
i
, 
SEEK_SET
);

2480 
	`fwrôe
(&
ãmp_key
, 8, 1, 
Â
);

2481 
	`fwrôe
(
ãmp_vÆue
, 1, 120, 
Â
);

2484 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√ighb‹_off£t
 + 128 + 128*(
√ighb‹_num_keys
 - 1Ë+ 8, 
SEEK_SET
);

2485 
	`‰ód
(
ãmp_vÆue
, 1, 120, 
Â
);

2487 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128 + 8, 
SEEK_SET
);

2488 
	`fwrôe
(
ãmp_vÆue
, 1, 120, 
Â
);

2490 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√ighb‹_off£t
 + 128 + 128*(
√ighb‹_num_keys
 - 1Ë+ 8, 
SEEK_SET
);

2491 
	`fwrôe
(
zîo
, 1, 120, 
Â
);

2494 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√ighb‹_off£t
 + 128 + 128*(
√ighb‹_num_keys
 - 1), 
SEEK_SET
);

2495 
	`‰ód
(&
ãmp_key
, 8, 1, 
Â
);

2497 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128, 
SEEK_SET
);

2498 
	`fwrôe
(&
ãmp_key
, 8, 1, 
Â
);

2502 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
, 
SEEK_SET
);

2503 
	`‰ód
(&
p_off£t
, 8, 1, 
Â
);

2505 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
p_off£t
 + 128 + 128*
k_¥ime_ödex
, 
SEEK_SET
);

2506 
	`fwrôe
(&
ãmp_key
, 8, 1, 
Â
);

2513 if(
is_Àaf
){

2515 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√ighb‹_off£t
 + 128, 
SEEK_SET
);

2516 
	`‰ód
(&
ãmp_key
, 8, 1, 
Â
);

2517 
	`‰ód
(&
ãmp_vÆue
, 1, 120, 
Â
);

2519 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128 + 128*
num_keys
, 
SEEK_SET
);

2520 
	`fwrôe
(&
ãmp_key
, 8, 1, 
Â
);

2521 
	`fwrôe
(&
ãmp_vÆue
, 1, 120, 
Â
);

2525 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
, 
SEEK_SET
);

2526 
	`‰ód
(&
p_off£t
, 8, 1, 
Â
);

2529 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√ighb‹_off£t
 + 128 + 128, 
SEEK_SET
);

2530 
	`‰ód
(&
ãmp_key
, 8, 1, 
Â
);

2532 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
p_off£t
 + 128 + 128*
k_¥ime_ödex
, 
SEEK_SET
);

2533 
	`fwrôe
(&
ãmp_key
, 8, 1, 
Â
);

2535 
i
 = 0; i < 
√ighb‹_num_keys
 - 1; i++){

2536 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√ighb‹_off£t
 + 128 + 128*(
i
+1), 
SEEK_SET
);

2537 
	`‰ód
(&
ãmp_key
, 8, 1, 
Â
);

2538 
	`‰ód
(
ãmp_vÆue
, 1, 120, 
Â
);

2540 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√ighb‹_off£t
 + 128 + 128*
i
, 
SEEK_SET
);

2541 
	`fwrôe
(&
ãmp_key
, 8, 1, 
Â
);

2542 
	`fwrôe
(
ãmp_vÆue
, 1, 120, 
Â
);

2548 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128 + 16*
num_keys
, 
SEEK_SET
);

2549 
	`fwrôe
(&
k_¥ime
, 8, 1, 
Â
);

2552 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√ighb‹_off£t
 + 120, 
SEEK_SET
);

2553 
	`‰ód
(&
ãmp_off£t
, 8, 1, 
Â
);

2555 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 128 + 16*(
num_keys
Ë+ 8, 
SEEK_SET
);

2556 
	`fwrôe
(&
ãmp_off£t
, 8, 1, 
Â
);

2559 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
ãmp_off£t
, 
SEEK_SET
);

2560 
	`fwrôe
(&
off£t
, 8, 1, 
Â
);

2563 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
, 
SEEK_SET
);

2564 
	`‰ód
(&
p_off£t
, 8, 1, 
Â
);

2567 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√ighb‹_off£t
 + 128, 
SEEK_SET
);

2568 
	`fwrôe
(&
ãmp_key
, 8, 1, 
Â
);

2570 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
p_off£t
 + 128 + 16*(
k_¥ime_ödex
), 
SEEK_SET
);

2571 
	`fwrôe
(&
ãmp_key
, 8, 1, 
Â
);

2573 
i
 = 0; i < 
√ighb‹_num_keys
 - 1; i++){

2575 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√ighb‹_off£t
 + 128 + 16*(
i
+1), 
SEEK_SET
);

2576 
	`‰ód
(&
ãmp_key
, 8, 1, 
Â
);

2578 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√ighb‹_off£t
 + 128 + 16*
i
, 
SEEK_SET
);

2579 
	`fwrôe
(&
ãmp_key
, 8, 1, 
Â
);

2582 if(
i
 == 0){

2583 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√ighb‹_off£t
 + 128 + 8, 
SEEK_SET
);

2584 
	`‰ód
(&
ãmp_off£t
, 8, 1, 
Â
);

2586 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√ighb‹_off£t
 + 120, 
SEEK_SET
);

2587 
	`fwrôe
(&
ãmp_off£t
, 8, 1, 
Â
);

2590 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√ighb‹_off£t
 + 128 + 16*(
i
Ë+ 8, 
SEEK_SET
);

2591 
	`‰ód
(&
ãmp_off£t
, 8, 1, 
Â
);

2593 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√ighb‹_off£t
 + 128 + 16*(
i
-1Ë+ 8, 
SEEK_SET
);

2594 
	`fwrôe
(&
ãmp_off£t
, 8, 1, 
Â
);

2598 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√ighb‹_off£t
 + 128 + 16*(
i
Ë+ 8, 
SEEK_SET
);

2599 
	`‰ód
(&
ãmp_off£t
, 8, 1, 
Â
);

2601 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√ighb‹_off£t
 + 128 + 16*(
i
-1Ë+ 8, 
SEEK_SET
);

2602 
	`fwrôe
(&
ãmp_off£t
, 8, 1, 
Â
);

2605 
num_keys
++;

2606 
√ighb‹_num_keys
--;

2609 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 12, 
SEEK_SET
);

2610 
	`fwrôe
(&
num_keys
, 4, 1, 
Â
);

2612 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√ighb‹_off£t
 + 12, 
SEEK_SET
);

2613 
	`fwrôe
(&
√ighb‹_num_keys
, 4, 1, 
Â
);

2615  
Ω_off£t
;

2616 
	}
}

2617 
öt64_t
 
	$dñëe_íåy_‰om_∑ge
(
öt64_t
 
Ω_off£t
, i¡64_à
off£t
, i¡64_à
key
, *
vÆue
, i¡64_à
key_off£t
){

2618 
mö_keys
 = 0, 
is_Àaf
 = 0, 
num_keys
 = 0, 
√ighb‹_num_keys
 = 0, 
k_¥ime_ödex
 = 0, 
√ighb‹_ödex
 = 0, 
ˇ∑côy
 = 0;

2619 
öt64_t
 
k_¥ime
, 
√ighb‹_off£t
, 
p_off£t
;

2622 
off£t
 = 
	`ªmove_íåy_‰om_∑ge
(off£t, 
key
, 
vÆue
, 
key_off£t
);

2625 if(
off£t
 =
Ω_off£t
)

2626  
	`adju°_roŸ_∑ge
(
Ω_off£t
);

2632 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 8, 
SEEK_SET
);

2633 
	`‰ód
(&
is_Àaf
, 4, 1, 
Â
);

2634 
mö_keys
 = 
is_Àaf
 ? 
	`cut
(
Àaf_‹dî
 - 1Ë: cut(
öã∫Æ_‹dî
) - 1;

2638 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
 + 12, 
SEEK_SET
);

2639 
	`‰ód
(&
num_keys
, 4, 1, 
Â
);

2641 if(
num_keys
 >
mö_keys
)

2642  
Ω_off£t
;

2647 
√ighb‹_ödex
 = 
	`gë_√ighb‹_∑ge_ödex
(
off£t
);

2648 
k_¥ime_ödex
 = 
√ighb‹_ödex
 == -1 ? 0 :Çeighbor_index;

2653 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
off£t
, 
SEEK_SET
);

2654 
	`‰ód
(&
p_off£t
, 8, 1, 
Â
);

2656 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
p_off£t
 + 128 + 16*
k_¥ime_ödex
, 
SEEK_SET
);

2657 
	`‰ód
(&
k_¥ime
, 8, 1, 
Â
);

2660 if(
√ighb‹_ödex
 == -1){

2661 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
p_off£t
 + 128 + 8, 
SEEK_SET
);

2662 
	`‰ód
(&
√ighb‹_off£t
, 8, 1, 
Â
);

2665 if(
√ighb‹_ödex
 == 0){

2666 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
p_off£t
 + 120, 
SEEK_SET
);

2667 
	`‰ód
(&
√ighb‹_off£t
, 8, 1, 
Â
);

2670 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
p_off£t
 + 128 + 16*(
√ighb‹_ödex
-1Ë+ 8, 
SEEK_SET
);

2671 
	`‰ód
(&
√ighb‹_off£t
, 8, 1, 
Â
);

2675 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 
√ighb‹_off£t
 + 12, 
SEEK_SET
);

2676 
	`‰ód
(&
√ighb‹_num_keys
, 4, 1, 
Â
);

2679 
ˇ∑côy
 = 
is_Àaf
 ? 
Àaf_‹dî
 : 
öã∫Æ_‹dî
 - 1;

2682 if(
√ighb‹_num_keys
 + 
num_keys
 < 
ˇ∑côy
){

2683  
	`cﬂÀs˚_∑ges
(
Ω_off£t
, 
off£t
, 
√ighb‹_off£t
, 
√ighb‹_ödex
, 
k_¥ime
);

2687  
	`ªdi°ribuã_∑ges
(
Ω_off£t
, 
off£t
, 
√ighb‹_off£t
, 
√ighb‹_ödex
, 
k_¥ime_ödex
, 
k_¥ime
);

2689 
	}
}

2694 
	$dñëe
(
öt64_t
 
key
){

2695 
key_vÆue
[120];

2696 
öt64_t
 
key_Àaf_off£t
, 
Ω_off£t
;

2699 
	`f£eko
(
Â
, 
deÁu…_off£t
 + 8, 
SEEK_SET
);

2700 
	`‰ód
(&
Ω_off£t
, 8, 1, 
Â
);

2703 if(
	`föd
(
key
Ë=
NULL
){

2706 
	`memmove
(
key_vÆue
, 
	`föd
(
key
), 120);

2707 
key_Àaf_off£t
 = 
	`föd_Àaf_∑ge
(
Ω_off£t
, 
key
);

2710 if(
key_vÆue
 !
NULL
 && 
key_Àaf_off£t
 != 0){

2711 
	`dñëe_íåy_‰om_∑ge
(
Ω_off£t
, 
key_Àaf_off£t
, 
key
, 
key_vÆue
, 0);

2713 
	`fÊush
(
Â
);

2718 
	}
}

	@main.c

1 
	~"b±.h
"

5 
	$maö
–
¨gc
, ** 
¨gv
 ) {

7 * 
öput_fûe
;

8 
vÆue
[120];

9 
FILE
 * 
Â
;

10 
node
 * 
roŸ
;

11 
ønge2
;

12 
öt64_t
 
öput
;

13 
ö°ru˘i⁄
;

14 
li˚n£_∑π
;

16 
roŸ
 = 
NULL
;

17 
vîbo£_ouçut
 = 
Ál£
;

19 i‡(
¨gc
 > 1) {

20 
‹dî
 = 
	`©oi
(
¨gv
[1]);

21 i‡(
‹dî
 < 
MIN_ORDER
 || ordî > 
MAX_ORDER
) {

22 
	`Ârötf
(
°dîr
, "InvÆid ordî: %d .\n\n", 
‹dî
);

23 
	`ußge_3
();

24 
	`exô
(
EXIT_FAILURE
);

28 
	`£tvbuf
(
°dö
, 
NULL
, 
_IONBF
, 0);

29 
	`£tvbuf
(
°dout
, 
NULL
, 
_IONBF
, 0);

36 i‡(
¨gc
 > 2) {

37 
öput_fûe
 = 
¨gv
[2];

38 
	`›í_db
(
öput_fûe
);

55 
	`sˇnf
("%c", &
ö°ru˘i⁄
Ë!
EOF
) {

56 
ö°ru˘i⁄
) {

58 
	`sˇnf
("%" "l" "d", &
öput
);

59 
	`dñëe
(
öput
);

67 
	`sˇnf
("%" "l" "d", &
öput
);

68 
	`sˇnf
("%s", 
vÆue
);

69 
	`ö£π
(
öput
, 
vÆue
);

78 
	`sˇnf
("%" "l" "d", &
öput
);

79 if(
	`föd
(
öput
Ë=
NULL
){

80 
	`¥ötf
("Not Exists\n");

83 
	`¥ötf
("Key: %" "l" "d" ", VÆue: %s\n", 
öput
, 
	`föd
(input));

91 
	`sˇnf
("%" "l" "d", &
öput
);

92 
	`sˇnf
("%d", &
ønge2
);

93 i‡(
öput
 > 
ønge2
) {

94 
tmp
 = 
ønge2
;

95 
ønge2
 = 
öput
;

96 
öput
 = 
tmp
;

98 
	`föd_™d_¥öt_ønge
(
roŸ
, 
öput
, 
ønge2
, 
ö°ru˘i⁄
 == 'p');

101 
	`¥öt_Àaves
(
roŸ
);

104 
	`gëch¨
() != ()'\n');

105  
EXIT_SUCCESS
;

108 
	`¥öt_åì
(
roŸ
);

111 
vîbo£_ouçut
 = !verbose_output;

114 i‡(
roŸ
)

115 
roŸ
 = 
	`de°roy_åì
(root);

116 
	`¥öt_åì
(
roŸ
);

124 
	`gëch¨
() != ()'\n');

129  
EXIT_SUCCESS
;

130 
	}
}

	@
1
.
0
2
13
bpt.c
main.c
